



TLS                                                           M. Thomson
Internet-Draft                                                   Mozilla
Intended status: Standards Track                            May 08, 2018
Expires: November 9, 2018


                  Example Handshake Traces for TLS 1.3
                  draft-ietf-tls-tls13-vectors-latest

Abstract

   Examples of TLS 1.3 handshakes are shown.  Private keys and inputs
   are provided so that these handshakes might be reproduced.
   Intermediate values, including secrets, traffic keys and ivs are
   shown so that implementations might be checked incrementally against
   these values.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 9, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Thomson                 Expires November 9, 2018                [Page 1]

Internet-Draft               TLS 1.3 Traces                     May 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Private Keys  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Simple 1-RTT Handshake  . . . . . . . . . . . . . . . . . . .   3
   4.  Resumed 0-RTT Handshake . . . . . . . . . . . . . . . . . . .  15
   5.  HelloRetryRequest . . . . . . . . . . . . . . . . . . . . . .  26
   6.  Client Authentication . . . . . . . . . . . . . . . . . . . .  38
   7.  Compatibility Mode  . . . . . . . . . . . . . . . . . . . . .  49
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  59
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  60
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  60
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  60
     10.2.  Informative References . . . . . . . . . . . . . . . . .  60
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .  60
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  60

1.  Introduction

   TLS 1.3 [TLS13] defines a new key schedule and a number new
   cryptographic operations.  This document includes sample handshakes
   that show all intermediate values.  This allows an implementation to
   be verified incrementally, examining inputs and outputs of each
   cryptographic computation independently.

   A private key is included with the traces so that implementations can
   be checked by importing these values and verifying that the same
   outputs are produced.

2.  Private Keys

   Ephemeral private keys are shown as they are generated in the traces.

   The server in most examples uses an RSA certificate with a private
   key of:

   modulus (public):  b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c
      0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab
      bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
      a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f
      da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0
      3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e
      3f

   public exponent:  01 00 01

   private exponent:  04 de a7 05 d4 3a 6e a7 20 9d d8 07 21 11 a8 3c 81
      e3 22 a5 92 78 b3 34 80 64 1e af 7c 0a 69 85 b8 e3 1c 44 f6 de 62



Thomson                 Expires November 9, 2018                [Page 2]

Internet-Draft               TLS 1.3 Traces                     May 2018


      e1 b4 c2 30 9f 61 26 e7 7b 7c 41 e9 23 31 4b bf a3 88 13 05 dc 12
      17 f1 6c 81 9c e5 38 e9 22 f3 69 82 8d 0e 57 19 5d 8c 84 88 46 02
      07 b2 fa a7 26 bc f7 08 bb d7 db 7f 67 9f 89 34 92 fc 2a 62 2e 08
      97 0a ac 44 1c e4 e0 c3 08 8d f2 5a e6 79 23 3d f8 a3 bd a2 ff 99
      41

   prime1:  e4 35 fb 7c c8 37 37 75 6d ac ea 96 ab 7f 59 a2 cc 10 69 db
      7d eb 19 0e 17 e3 3a 53 2b 27 3f 30 a3 27 aa 0a aa bc 58 cd 67 46
      6a f9 84 5f ad c6 75 fe 09 4a f9 2c 4b d1 f2 c1 bc 33 dd 2e 05 15

   prime2:  ca bd 3b c0 e0 43 86 64 c8 d4 cc 9f 99 97 7a 94 d9 bb fe ad
      8e 43 87 0a ba e3 f7 eb 8b 4e 0e ee 8a f1 d9 b4 71 9b a6 19 6c f2
      cb ba ee eb f8 b3 49 0a fe 9e 9f fa 74 a8 8a a5 1f c6 45 62 93 03

   exponent1:  3f 57 34 5c 27 fe 1b 68 7e 6e 76 16 27 b7 8b 1b 82 64 33
      dd 76 0f a0 be a6 a6 ac f3 94 90 aa 1b 47 cd a4 86 9d 68 f5 84 dd
      5b 50 29 bd 32 09 3b 82 58 66 1f e7 15 02 5e 5d 70 a4 5a 08 d3 d3
      19

   exponent2:  18 3d a0 13 63 bd 2f 28 85 ca cb dc 99 64 bf 47 64 f1 51
      76 36 f8 64 01 28 6f 71 89 3c 52 cc fe 40 a6 c2 3d 0d 08 6b 47 c6
      fb 10 d8 fd 10 41 e0 4d ef 7e 9a 40 ce 95 7c 41 77 94 e1 04 12 d1
      39

   coefficient:  83 9c a9 a0 85 e4 28 6b 2c 90 e4 66 99 7a 2c 68 1f 21
      33 9a a3 47 78 14 e4 de c1 18 33 05 0e d5 0d d1 3c c0 38 04 8a 43
      c5 9b 2a cc 41 68 89 c0 37 66 5f e5 af a6 05 96 9f 8c 01 df a5 ca
      96 9d

3.  Simple 1-RTT Handshake

   In this example, the simplest possible handshake is completed.  The
   server is authenticated, but the client remains anonymous.  After
   connecting, a few application data octets are exchanged.  The server
   sends a session ticket that permits the use of 0-RTT in any resumed
   session.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  03 a8 76 7f a2 d7 da a8 03 f1 b2 6b 69
         20 61 c0 3b 3b 89 ca 6f e0 c2 71 c7 18 35 9a 83 f0 d9 23

      public key (32 octets):  26 2c 7a 25 83 23 d5 21 90 80 be ea 30 61
         af dd 2c be 92 e2 cf 6a f6 1b 43 81 59 ca ae 36 11 31

   {client}  send a ClientHello handshake message

   {client}  send handshake record:



Thomson                 Expires November 9, 2018                [Page 3]

Internet-Draft               TLS 1.3 Traces                     May 2018


      payload (190 octets):  01 00 00 ba 03 03 4b 7c 0d 27 5d 16 0f 99
         57 02 77 4b 1a e8 b8 a2 2c 9f ea e2 37 68 a8 8f a6 82 e2 20 f0
         af d9 63 00 00 06 13 01 13 03 13 02 01 00 00 8b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23 00
         00 00 33 00 26 00 24 00 1d 00 20 26 2c 7a 25 83 23 d5 21 90 80
         be ea 30 61 af dd 2c be 92 e2 cf 6a f6 1b 43 81 59 ca ae 36 11
         31 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01

      ciphertext (195 octets):  16 03 01 00 be 01 00 00 ba 03 03 4b 7c
         0d 27 5d 16 0f 99 57 02 77 4b 1a e8 b8 a2 2c 9f ea e2 37 68 a8
         8f a6 82 e2 20 f0 af d9 63 00 00 06 13 01 13 03 13 02 01 00 00
         8b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 23 00 00 00 33 00 26 00 24 00 1d 00 20 26 2c 7a 25
         83 23 d5 21 90 80 be ea 30 61 af dd 2c be 92 e2 cf 6a f6 1b 43
         81 59 ca ae 36 11 31 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  87 d0 a0 ee 77 8c 0c b4 30 29 2b db 62
         02 c5 85 0b 72 59 2a f9 d0 e1 20 b9 c0 59 f5 4a 19 e3 03

      public key (32 octets):  cc 7c 25 f2 bd e4 16 eb ed 01 f6 56 f2 21
         42 ff 87 b4 fe c5 7c 97 1a 65 0c 78 63 af 71 36 b4 38

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a





Thomson                 Expires November 9, 2018                [Page 4]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  47 b0 0e cc 83 3b 9d a8 98 7c 31 1c c0 69 01 b8
         56 7b f5 15 9d 62 f8 b5 eb 6b 34 df b6 3b c4 37

      secret (32 octets):  3b c0 e5 ad db bc 5a a9 65 8d f3 2b 8c 60 e7
         a0 01 22 5b 0b 7a b1 e9 92 93 eb 00 27 a5 7f af 12

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  3b c0 e5 ad db bc 5a a9 65 8d f3 2b 8c 60 e7 a0
         01 22 5b 0b 7a b1 e9 92 93 eb 00 27 a5 7f af 12

      hash (32 octets):  ad ad 37 f0 84 77 8e 0a 75 a4 a1 2b 98 44 c2 d9
         3f f4 f0 84 84 0d 8c 24 9f d8 58 0c 7e 64 69 4d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 ad ad 37 f0 84 77 8e 0a 75 a4 a1 2b 98 44 c2
         d9 3f f4 f0 84 84 0d 8c 24 9f d8 58 0c 7e 64 69 4d

      output (32 octets):  4b 58 d8 78 7e 7c aa f5 c0 3a 4a b1 75 0f b5
         68 6e fd 30 e9 d3 3f 0d 9f f3 e6 be 50 41 63 94 97

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  3b c0 e5 ad db bc 5a a9 65 8d f3 2b 8c 60 e7 a0
         01 22 5b 0b 7a b1 e9 92 93 eb 00 27 a5 7f af 12

      hash (32 octets):  ad ad 37 f0 84 77 8e 0a 75 a4 a1 2b 98 44 c2 d9
         3f f4 f0 84 84 0d 8c 24 9f d8 58 0c 7e 64 69 4d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 ad ad 37 f0 84 77 8e 0a 75 a4 a1 2b 98 44 c2
         d9 3f f4 f0 84 84 0d 8c 24 9f d8 58 0c 7e 64 69 4d




Thomson                 Expires November 9, 2018                [Page 5]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  af fa 63 85 41 5c e4 cf e1 12 3b ef 02 69 00
         08 a6 61 63 f3 7b fc 63 08 68 8f bf 6a fb af a7 6b

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  3b c0 e5 ad db bc 5a a9 65 8d f3 2b 8c 60 e7 a0
         01 22 5b 0b 7a b1 e9 92 93 eb 00 27 a5 7f af 12

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6d 0b 81 03 7c 15 0d 38 6a 28 cb 20 a2 63 3f
         e8 aa 1e 7a d2 cb 9a f2 cc 4b 35 a4 9b 03 85 30 ea

   {server}  extract secret "master":

      salt (32 octets):  6d 0b 81 03 7c 15 0d 38 6a 28 cb 20 a2 63 3f e8
         aa 1e 7a d2 cb 9a f2 cc 4b 35 a4 9b 03 85 30 ea

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  86 3d f3 9a 04 a5 68 0f 24 77 e9 07 61 96 9a
         a0 45 ed 61 04 01 c7 94 16 97 a9 f9 b0 ab fe 39 63

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 a1 6b 72 79 4c 09 bf a6 3d
         a6 9a 47 b5 85 a1 80 f4 8e 70 db b8 85 13 59 72 65 5f af 3d d4
         db be 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 cc 7c 25 f2 bd
         e4 16 eb ed 01 f6 56 f2 21 42 ff 87 b4 fe c5 7c 97 1a 65 0c 78
         63 af 71 36 b4 38 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 a1 6b 72
         79 4c 09 bf a6 3d a6 9a 47 b5 85 a1 80 f4 8e 70 db b8 85 13 59
         72 65 5f af 3d d4 db be 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 cc 7c 25 f2 bd e4 16 eb ed 01 f6 56 f2 21 42 ff 87 b4 fe c5
         7c 97 1a 65 0c 78 63 af 71 36 b4 38 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  af fa 63 85 41 5c e4 cf e1 12 3b ef 02 69 00 08
         a6 61 63 f3 7b fc 63 08 68 8f bf 6a fb af a7 6b




Thomson                 Expires November 9, 2018                [Page 6]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  f2 2e 3a 8f 94 39 16 91 c5 b6 e8 8b 6b d2
         f6 d6

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  12 15 68 73 7c ad f7 c5 bc 95 9d bf

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  af fa 63 85 41 5c e4 cf e1 12 3b ef 02 69 00 08
         a6 61 63 f3 7b fc 63 08 68 8f bf 6a fb af a7 6b

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  de ec 21 9b e7 19 19 05 60 7b 06 4e 27 56 a7
         ec 13 99 16 19 75 5c f6 42 10 9c 01 42 8d c0 49 97

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05



Thomson                 Expires November 9, 2018                [Page 7]

Internet-Draft               TLS 1.3 Traces                     May 2018


         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d
         e1 00 00 0f 00 00 84 08 04 00 80 87 49 76 8c 7c 6a 0d fe ce dc
         47 f0 57 d7 92 b0 a7 9c e6 cd 86 ae 25 17 ec e9 07 d4 69 77 23
         30 14 02 2b b7 c1 db 3e dc 29 f9 5d 99 82 ad cc ce 84 a0 8b e9
         13 47 8a bc 0d d7 17 30 02 8f 0f 98 e0 2a 8e 9c f3 a0 99 a7 0f
         94 fb 4e f3 53 b6 67 e3 46 55 6b 90 d2 28 a5 33 08 bc c4 69 85
         6a 97 e8 aa 08 93 17 fc f7 1b 28 86 68 6c 6d a7 1b ac ca 21 aa
         6c 15 60 4e 23 4f 6c 53 6b 87 ca 7f cb 14 00 00 20 04 2e a1 b0
         e8 cb 91 44 a8 59 2a 57 fe 45 bc 08 ad a1 6f d2 b5 a8 20 2f 27
         76 48 45 ca 72 7f 96

      ciphertext (673 octets):  17 03 03 02 9c 0a 34 36 1a a2 54 f6 f6
         5c 99 51 83 f1 48 4b 18 c0 83 92 ea ca 76 85 9f fa cc 56 b6 31
         9f 25 c3 fc b1 84 a2 ed 40 ad 43 71 7e 53 f2 df 43 a8 16 fa 44
         b5 4d 5b 92 f6 a4 f0 f1 31 50 dd 5f a1 f6 8d da 13 92 d4 55 af
         f6 22 05 46 4e 96 09 75 0d 0d a4 d3 4e 40 7e df d4 a8 dd b2 21
         c9 06 1e 53 4a 56 c7 0c 10 0a e6 e1 b0 70 a9 22 46 d9 7f e2 cb
         ed 5f d9 fa b0 d5 9a 15 e7 8f 60 25 78 0f fc 4f 3c b5 b2 19 fa
         0e 65 e0 11 36 24 75 43 33 eb b9 ee 21 6e 94 1a c7 73 f2 8d 48
         f9 4f c3 de 13 0c a9 88 05 2e 96 ca 5c db c0 2d 93 72 37 43 69
         b3 7c bb 5b 4e 9d 5f 49 97 ed 1e 4e ed 45 6b fc 79 9c 65 2a 44
         10 5a b1 24 d4 5b d9 5e 48 93 81 7d 3f e6 3a c5 a8 32 7c 26 29
         43 eb c7 2d d2 21 77 d9 79 9b 2b 8c bb 33 09 cb a5 f2 51 21 35
         c3 79 37 27 4c 63 a3 b5 18 3a 68 89 a4 b7 b2 46 81 f7 0f 89 8a
         ab 7d 00 1a 48 2f 84 62 29 64 7e de e8 f0 f1 8e 17 14 a7 86 da
         71 fc 02 3c c7 b4 0a 59 c0 44 04 3e e3 73 b0 0d 23 9a 9c fc 07
         36 9b f9 73 9d b6 7c 46 22 a5 f1 64 aa 80 37 34 34 35 24 07 af
         2e c3 56 d7 fc 34 80 04 63 7c 3c ed ac 90 2b fe 64 3f dc ef 46
         db 45 aa 6c ce 2b 55 63 c9 59 08 77 d8 66 35 94 c0 1d bf a0 77
         0a b8 ec 99 0f 94 a8 64 a5 8c 54 94 85 b0 85 c5 61 68 b3 c8 f3
         6e c5 23 f5 f9 e8 d8 02 ef a1 f1 18 03 10 0f 36 e5 ab d9 f6 70
         fc eb f0 1d 89 9b 6b a4 17 c2 2d 3d fd da 10 41 2f f7 b4 df b4
         e0 f8 ff 59 02 9b 4a 8f 9d 82 69 61 13 ec 00 26 1a 8f 15 9c 9a
         b0 1f c4 90 0f 3b 89 99 bd 0b 75 77 63 f9 c7 c9 c3 b4 d4 a6 77
         7a 9e 77 16 ac bc 84 af 70 ab e6 51 fd aa 58 66 39 bd 2d 98 3f
         a6 38 57 0e 67 ab 28 61 74 2b a2 e7 cb af f1 4d 48 52 d4 f9 0f
         bf 81 00 ad dd ce aa 92 cf e4 b8 a3 21 4d f3 f0 05 b2 78 db ed
         18 3b 81 90 7a 7e a9 8a 58 39 2e 9e 10 d5 66 8a b0 0f 13 cd 25
         52 4d 3b 70 19 e6 a0 b7 c4 9f 68 4c 6a e3 87 06 9d b1 65 d7 ca
         e2 b5 4b a1 1a 84 f0 a9 fe 84 44 ca 27 b1 62 b5 25 a9 65 47 59
         48 43 b4 ce a5 6d 8d c5 ef b0 0b 28 61 ad 1d d5 26 49 36 53 1c
         fd fc dc 1e 25 31 e8 3a 9d 5c 82 66 96 a7 9d f1 d7 5d 49 38 11



Thomson                 Expires November 9, 2018                [Page 8]

Internet-Draft               TLS 1.3 Traces                     May 2018


         f0 29 48 60 bd df e1 e5 53 9d 08 1d d9 eb 77 f6 15 7d 0f 9c 74
         60 a1 97 e3 ff b3 6b 78 8b

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  86 3d f3 9a 04 a5 68 0f 24 77 e9 07 61 96 9a a0
         45 ed 61 04 01 c7 94 16 97 a9 f9 b0 ab fe 39 63

      hash (32 octets):  e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7 26
         72 d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7
         26 72 d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      output (32 octets):  4d 3c 9b e2 09 05 42 7f a8 18 95 d2 a3 84 a5
         92 9e 17 d4 63 2b 64 9f 08 39 42 35 90 5d 89 38 15

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  86 3d f3 9a 04 a5 68 0f 24 77 e9 07 61 96 9a a0
         45 ed 61 04 01 c7 94 16 97 a9 f9 b0 ab fe 39 63

      hash (32 octets):  e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7 26
         72 d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7
         26 72 d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      output (32 octets):  7e d1 b3 79 58 49 ca b5 85 9f 31 1b c9 fa 3c
         ec 38 a1 e2 f5 fd fe c4 ae 93 36 bd 4b 4f bd c1 20

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  86 3d f3 9a 04 a5 68 0f 24 77 e9 07 61 96 9a a0
         45 ed 61 04 01 c7 94 16 97 a9 f9 b0 ab fe 39 63

      hash (32 octets):  e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7 26
         72 d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 e1 e7 e2 36 05 72 5c 24 a9 bf 82 46 77 79 a7 26 72
         d6 44 00 59 f6 76 a9 90 db 86 be c5 34 b7 48

      output (32 octets):  3e 13 20 71 57 f5 ac 7a 14 e9 a4 be bb 44 9e
         47 cf 32 35 2e 19 3b 7e 11 6f 23 18 4a 13 6c d3 31




Thomson                 Expires November 9, 2018                [Page 9]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  7e d1 b3 79 58 49 ca b5 85 9f 31 1b c9 fa 3c ec
         38 a1 e2 f5 fd fe c4 ae 93 36 bd 4b 4f bd c1 20

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  57 99 f8 01 a9 c3 df 78 66 77 b8 7d 55 13
         97 d8

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  53 ec 14 9f b0 8c 03 98 b5 71 8f 1f

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  4b 58 d8 78 7e 7c aa f5 c0 3a 4a b1 75 0f b5 68
         6e fd 30 e9 d3 3f 0d 9f f3 e6 be 50 41 63 94 97

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  da 65 ff 3d d2 d8 5f 1f f3 40 dc 34 62 14
         8f f9

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c7 ef 86 e6 ec 37 e1 06 3b 69 92 19

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55






Thomson                 Expires November 9, 2018               [Page 10]

Internet-Draft               TLS 1.3 Traces                     May 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  47 b0 0e cc 83 3b 9d a8 98 7c 31 1c c0 69 01 b8
         56 7b f5 15 9d 62 f8 b5 eb 6b 34 df b6 3b c4 37

      secret (32 octets):  3b c0 e5 ad db bc 5a a9 65 8d f3 2b 8c 60 e7
         a0 01 22 5b 0b 7a b1 e9 92 93 eb 00 27 a5 7f af 12

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  af fa 63 85 41 5c e4 cf e1 12 3b ef 02 69 00 08
         a6 61 63 f3 7b fc 63 08 68 8f bf 6a fb af a7 6b

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  f2 2e 3a 8f 94 39 16 91 c5 b6 e8 8b 6b d2
         f6 d6

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  12 15 68 73 7c ad f7 c5 bc 95 9d bf

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires November 9, 2018               [Page 11]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  4b 58 d8 78 7e 7c aa f5 c0 3a 4a b1 75 0f b5 68
         6e fd 30 e9 d3 3f 0d 9f f3 e6 be 50 41 63 94 97

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  03 61 b4 d6 8e fc 4e 68 e3 90 93 68 0f 0d 8c
         05 e4 97 65 dd df 94 ec c1 f2 bc 49 b4 85 d5 33 b6

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 f1 65 b2 de a0 de f7 50 d7 8a 92
         0d d2 30 47 2a 48 8d f1 78 98 d2 15 8b e2 65 44 83 95 7a 2a 3b

      ciphertext (58 octets):  17 03 03 00 35 ad e0 3a cd 73 1c 61 c5 91
         80 28 ef c9 c3 63 fc 1b 9e 9e fd 80 b6 b7 72 e9 b3 e6 50 77 27
         df f2 d8 ff ce a3 87 35 44 28 3c 73 85 d5 da b5 08 17 32 95 f4
         b8 83

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  4d 3c 9b e2 09 05 42 7f a8 18 95 d2 a3 84 a5 92
         9e 17 d4 63 2b 64 9f 08 39 42 35 90 5d 89 38 15

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  27 88 b6 b3 0c 86 1c af a7 54 9d 2f 31 12
         17 2b

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  08 47 46 d2 18 2f cc db 64 27 5b eb

   {client}  derive secret "tls13 res master":





Thomson                 Expires November 9, 2018               [Page 12]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  86 3d f3 9a 04 a5 68 0f 24 77 e9 07 61 96 9a a0
         45 ed 61 04 01 c7 94 16 97 a9 f9 b0 ab fe 39 63

      hash (32 octets):  eb db 43 fd 27 94 d9 38 b1 fa 40 3a 54 17 64 17
         21 3d 28 dd 7a 00 7d a9 b8 bc 6d cf f6 87 a5 3f

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 eb db 43 fd 27 94 d9 38 b1 fa 40 3a 54 17 64 17 21
         3d 28 dd 7a 00 7d a9 b8 bc 6d cf f6 87 a5 3f

      output (32 octets):  76 06 93 e0 29 1d cf bd 91 bb 1e f4 71 bd 0c
         15 5d b4 40 c9 f4 be 96 5b fe 8a 43 ee 70 5f e9 9c

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {server}  generate resumption secret "tls13 resumption":

      PRK (32 octets):  76 06 93 e0 29 1d cf bd 91 bb 1e f4 71 bd 0c 15
         5d b4 40 c9 f4 be 96 5b fe 8a 43 ee 70 5f e9 9c

      hash (2 octets):  00 00

      info (22 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 75 6d 70 74
         69 6f 6e 02 00 00

      output (32 octets):  29 69 7c 98 62 7e 0e 69 ee ba 30 2d 45 65 61
         c3 76 fd d5 14 61 2e 4a bc c4 6d 8a 22 1d 74 1e 75

   {server}  send a NewSessionTicket handshake message

   {server}  send handshake record:

      payload (205 octets):  04 00 00 c9 00 00 00 1e 40 eb 85 37 02 00
         00 00 b2 c5 ac 45 26 45 3f d0 dd 52 6a 8c 44 00 00 00 00 16 b3
         57 e4 d9 1e 23 40 fe f9 3d 30 2a 93 d9 34 00 70 4c 9b 7c 46 b7
         b8 28 6b 40 d7 9b fb 78 c9 e5 fd 74 6b 19 b6 82 53 dd 17 ec 2b
         b0 c5 62 7a 06 25 44 60 a0 83 a1 a8 6b 97 78 27 1b 6b 32 80 ac
         7f 9f 67 65 1a 42 91 f9 cc 46 7a 4d 04 b7 bc 2b 6d bc a0 5a 9d
         5c 51 f4 3a 78 54 f3 5a b6 66 98 b4 93 1f 7b 52 94 92 e3 23 ba
         88 1e 44 35 d8 9a a7 a3 90 36 0d 54 16 08 5c 87 1c ec f2 fc 32
         0b 08 c8 fd ec 51 9b 9d de dd f0 36 8e 32 db fb bf 6c 43 b3 5e
         42 c6 1b 13 c2 ce ec 42 5c 6f 23 39 f9 00 08 00 2a 00 04 00 00
         04 00



Thomson                 Expires November 9, 2018               [Page 13]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (227 octets):  17 03 03 00 de 89 5e af aa c4 cb f3 59
         4e 46 c1 8d f7 54 5b 6a f5 23 c7 10 51 31 c1 53 dc d5 44 66 63
         86 fe a9 63 47 ff ee 64 63 d2 96 31 c4 65 a8 4c 33 ab bc 31 47
         10 56 09 db 0c e3 19 f2 76 7d 7e b5 fd a1 27 19 b8 ca e1 aa 7d
         d7 d2 ac e0 0a aa e2 8a c7 60 37 7d 8b 2b d7 3b 6e 8a 91 d3 95
         25 f7 cb 43 33 6d 8e f9 86 f5 52 1f 5b 1f 12 9a e9 c3 65 be ec
         a8 fa 0a e5 51 97 5f 76 bb 73 f8 41 28 5d da 08 5c 88 4e 32 80
         b6 c6 a2 1c 78 3f 0d 57 9e 54 80 65 cd be 9d 72 0d 91 52 41 83
         a8 d8 0b 4f ff c3 83 b9 96 50 37 d4 8c 93 3d ab 2c d9 16 52 57
         ae c0 8f 40 54 b3 0d 86 ca 7b a1 e2 f8 a3 44 bb 78 dd 68 7e ca
         42 ec 8b 78 73 a8 78 53 2b 18 73 8b 0b f5 ad 8b a1 88 55 24 62
         ee 4a 25 f0

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 70 c2 2d 18 83 70 43 97 eb
         cd d8 cc 45 a3 5d 14 1a f7 2e cb 12 d5 16 2c aa af 67 92 08 e3
         92 f5 7b 18 63 71 55 d5 24 18 58 9a 2a 91 6b a4 24 3f 5a 00 c2
         2d 59 cf 20 78 1d 3c 53 74 e6 61 7b c3 43 2a 37

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 da 20 8e 8f 47 6f 22 46 12
         ff ac 05 b6 a0 32 24 50 46 3e d2 d3 25 1f cb 2c 9b c3 ef 8c de
         ea 89 2a 34 5c ac 65 75 88 cb a6 2d cd 8c 65 eb 8e a8 bd 33 58
         b7 f6 29 0c da 4e 14 bb dc e9 0f a2 bb bf b8 a5

   {client}  generate resumption secret "tls13 resumption" (same as
      server)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 ed 91 74 b2 ca cc 75 7d 5c
         af 68 cb 84 f8 6e 18 a6 c6 8b

   {server}  send alert record:

      payload (2 octets):  01 00



Thomson                 Expires November 9, 2018               [Page 14]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (24 octets):  17 03 03 00 13 ef 83 38 45 18 4a f5 19 9a
         97 da 02 f8 37 3f 17 f6 d6 28

4.  Resumed 0-RTT Handshake

   This handshake resumes from the handshake in Section 3.  Since the
   server provided a session ticket that permitted 0-RTT, and the client
   is configured for 0-RTT, the client is able to send 0-RTT data.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  9c 30 ee 54 93 96 dd 58 6b 04 c5 e7 71
         87 9c 49 bc 3f b0 df 34 ce 93 3e 29 1e c1 3b ef 52 22 87

      public key (32 octets):  92 6d 4b 0b dd e8 b8 fd 68 63 56 d9 cb 7d
         52 ae 84 cc 74 a6 f7 37 7b 9f a6 56 a4 d5 b1 64 4f 3c

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  29 69 7c 98 62 7e 0e 69 ee ba 30 2d 45 65 61 c3
         76 fd d5 14 61 2e 4a bc c4 6d 8a 22 1d 74 1e 75

      secret (32 octets):  23 8b 57 43 39 50 ba 69 35 05 ed 0e ef e0 30
         a7 95 c4 f7 17 b6 cb 76 c7 56 e5 61 25 33 f6 51 fe

   {client}  send a ClientHello handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  46 63 56 a0 18 0a 06 b0 73 1d 2a 8e ba c5 78 38
         13 67 13 9e ea cc d8 0e c0 28 7f 55 1f 9a 78 3c

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  f5 f0 76 bc d8 71 7c df 12 6f b4 a3 69 f6 08
         f9 6f 61 c0 b2 1e 2f dc b6 1f 0b c5 b3 15 d3 78 98

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 b4 70 5f 94 70 f1 97 6b
         dc b2 5e 74 c4 85 e2 8d 85 79 44 ef ba 99 41 f1 e7 9c 02 9b dd
         90 d9 e0 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12



Thomson                 Expires November 9, 2018               [Page 15]

Internet-Draft               TLS 1.3 Traces                     May 2018


         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 92 6d 4b 0b dd e8 b8 fd 68 63 56 d9 cb 7d
         52 ae 84 cc 74 a6 f7 37 7b 9f a6 56 a4 d5 b1 64 4f 3c 00 2a 00
         00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 29 00 dd 00 b8 00 b2 c5 ac 45 26 45 3f d0 dd 52 6a 8c 44 00
         00 00 00 16 b3 57 e4 d9 1e 23 40 fe f9 3d 30 2a 93 d9 34 00 70
         4c 9b 7c 46 b7 b8 28 6b 40 d7 9b fb 78 c9 e5 fd 74 6b 19 b6 82
         53 dd 17 ec 2b b0 c5 62 7a 06 25 44 60 a0 83 a1 a8 6b 97 78 27
         1b 6b 32 80 ac 7f 9f 67 65 1a 42 91 f9 cc 46 7a 4d 04 b7 bc 2b
         6d bc a0 5a 9d 5c 51 f4 3a 78 54 f3 5a b6 66 98 b4 93 1f 7b 52
         94 92 e3 23 ba 88 1e 44 35 d8 9a a7 a3 90 36 0d 54 16 08 5c 87
         1c ec f2 fc 32 0b 08 c8 fd ec 51 9b 9d de dd f0 36 8e 32 db fb
         bf 6c 43 b3 5e 42 c6 1b 13 c2 ce ec 42 5c 6f 23 39 f9 40 eb 85
         3c 00 21 20 93 e3 41 ed db e8 fe 93 92 73 15 84 5e ac de db 29
         5b 84 ce 19 aa 56 26 3b b7 fb 51 5f 11 db a9

      ciphertext (517 octets):  16 03 01 02 00 01 00 01 fc 03 03 b4 70
         5f 94 70 f1 97 6b dc b2 5e 74 c4 85 e2 8d 85 79 44 ef ba 99 41
         f1 e7 9c 02 9b dd 90 d9 e0 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 92 6d 4b 0b dd e8 b8 fd
         68 63 56 d9 cb 7d 52 ae 84 cc 74 a6 f7 37 7b 9f a6 56 a4 d5 b1
         64 4f 3c 00 2a 00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 29 00 dd 00 b8 00 b2 c5 ac 45 26 45 3f d0
         dd 52 6a 8c 44 00 00 00 00 16 b3 57 e4 d9 1e 23 40 fe f9 3d 30
         2a 93 d9 34 00 70 4c 9b 7c 46 b7 b8 28 6b 40 d7 9b fb 78 c9 e5
         fd 74 6b 19 b6 82 53 dd 17 ec 2b b0 c5 62 7a 06 25 44 60 a0 83
         a1 a8 6b 97 78 27 1b 6b 32 80 ac 7f 9f 67 65 1a 42 91 f9 cc 46
         7a 4d 04 b7 bc 2b 6d bc a0 5a 9d 5c 51 f4 3a 78 54 f3 5a b6 66
         98 b4 93 1f 7b 52 94 92 e3 23 ba 88 1e 44 35 d8 9a a7 a3 90 36
         0d 54 16 08 5c 87 1c ec f2 fc 32 0b 08 c8 fd ec 51 9b 9d de dd
         f0 36 8e 32 db fb bf 6c 43 b3 5e 42 c6 1b 13 c2 ce ec 42 5c 6f
         23 39 f9 40 eb 85 3c 00 21 20 93 e3 41 ed db e8 fe 93 92 73 15
         84 5e ac de db 29 5b 84 ce 19 aa 56 26 3b b7 fb 51 5f 11 db a9




Thomson                 Expires November 9, 2018               [Page 16]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive secret "tls13 c e traffic":

      PRK (32 octets):  23 8b 57 43 39 50 ba 69 35 05 ed 0e ef e0 30 a7
         95 c4 f7 17 b6 cb 76 c7 56 e5 61 25 33 f6 51 fe

      hash (32 octets):  2a b6 19 a1 20 57 99 c2 44 72 ec 68 ed 11 f0 1a
         f4 d4 4e 2a 80 ac d3 b3 af 9f 9b e1 89 7e 14 02

      info (53 octets):  00 20 11 74 6c 73 31 33 20 63 20 65 20 74 72 61
         66 66 69 63 20 2a b6 19 a1 20 57 99 c2 44 72 ec 68 ed 11 f0 1a
         f4 d4 4e 2a 80 ac d3 b3 af 9f 9b e1 89 7e 14 02

      output (32 octets):  bc b8 51 11 f5 c4 a5 53 2a 85 12 d4 bb 2f 6d
         f0 35 e1 2b d9 15 13 c9 99 6b 70 80 88 ad 33 44 61

   {client}  derive secret "tls13 e exp master":

      PRK (32 octets):  23 8b 57 43 39 50 ba 69 35 05 ed 0e ef e0 30 a7
         95 c4 f7 17 b6 cb 76 c7 56 e5 61 25 33 f6 51 fe

      hash (32 octets):  2a b6 19 a1 20 57 99 c2 44 72 ec 68 ed 11 f0 1a
         f4 d4 4e 2a 80 ac d3 b3 af 9f 9b e1 89 7e 14 02

      info (54 octets):  00 20 12 74 6c 73 31 33 20 65 20 65 78 70 20 6d
         61 73 74 65 72 20 2a b6 19 a1 20 57 99 c2 44 72 ec 68 ed 11 f0
         1a f4 d4 4e 2a 80 ac d3 b3 af 9f 9b e1 89 7e 14 02

      output (32 octets):  c1 c8 a8 ee c4 18 72 c9 ae ec 53 7f 6f be a6
         cc 3d 8a 1a 5c 5e 93 87 ae b7 5f 57 e9 c8 21 a1 de

   {client}  derive write traffic keys for early application data:

      PRK (32 octets):  bc b8 51 11 f5 c4 a5 53 2a 85 12 d4 bb 2f 6d f0
         35 e1 2b d9 15 13 c9 99 6b 70 80 88 ad 33 44 61

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  da 94 e9 51 bd 0e 1d d5 2e ed 0e 88 0a 0c
         8d 7a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  93 6e 84 80 5d 82 84 a3 66 f3 03 e8

   {client}  send application_data record:

      payload (6 octets):  41 42 43 44 45 46




Thomson                 Expires November 9, 2018               [Page 17]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (28 octets):  17 03 03 00 17 e7 14 2e f0 7a 27 ac 31 ae
         f1 61 87 fa d7 7b 1c 61 fe 83 2f 3c b3 85

   {server}  extract secret "early" (same as client)

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  27 19 d0 d2 aa d1 9e ea c9 0d 02 19 70
         41 83 51 d7 9e 6f 37 31 cf 06 24 84 c4 ad d1 ef 5d 83 75

      public key (32 octets):  cc ce 7a 95 46 c2 24 ca 94 b8 98 e6 93 ee
         86 33 74 9f ab 0a f2 94 8c e6 3b db f6 1a 40 5e 26 52

   {server}  derive secret "tls13 c e traffic" (same as client)

   {server}  derive secret "tls13 e exp master" (same as client)

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  23 8b 57 43 39 50 ba 69 35 05 ed 0e ef e0 30 a7
         95 c4 f7 17 b6 cb 76 c7 56 e5 61 25 33 f6 51 fe

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  a1 bf 40 8c 03 7d 13 b4 f1 8c b3 f7 e2 2a 58
         0c 27 d2 04 70 70 51 88 2a c1 80 41 21 25 43 c5 64

   {server}  extract secret "handshake":

      salt (32 octets):  a1 bf 40 8c 03 7d 13 b4 f1 8c b3 f7 e2 2a 58 0c
         27 d2 04 70 70 51 88 2a c1 80 41 21 25 43 c5 64

      ikm (32 octets):  12 7f 44 0f cb 9a 01 a7 01 18 81 f0 43 4f c2 23
         04 a8 1a f2 69 40 d7 53 81 33 ff c0 2d 8e ae 47

      secret (32 octets):  30 f9 4a 4b f8 0b 7e 29 df 7e 38 43 9f 86 4b
         03 67 01 31 44 64 13 b9 a6 f4 bc e4 44 f4 16 89 4d

   {server}  derive secret "tls13 c hs traffic":



Thomson                 Expires November 9, 2018               [Page 18]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  30 f9 4a 4b f8 0b 7e 29 df 7e 38 43 9f 86 4b 03
         67 01 31 44 64 13 b9 a6 f4 bc e4 44 f4 16 89 4d

      hash (32 octets):  1e 06 19 1f 26 45 1b 5d 6a 2d f0 65 7e 05 66 ca
         c6 b8 49 ad 5e a6 3b 3d ac af 46 48 57 14 61 d2

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 1e 06 19 1f 26 45 1b 5d 6a 2d f0 65 7e 05 66
         ca c6 b8 49 ad 5e a6 3b 3d ac af 46 48 57 14 61 d2

      output (32 octets):  2e 84 66 da a6 69 b3 bb a1 cb 3a fc 59 d0 65
         f9 2a 14 cc 4e 80 c7 4c b4 19 4a 6a 75 a4 3e fc 83

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  30 f9 4a 4b f8 0b 7e 29 df 7e 38 43 9f 86 4b 03
         67 01 31 44 64 13 b9 a6 f4 bc e4 44 f4 16 89 4d

      hash (32 octets):  1e 06 19 1f 26 45 1b 5d 6a 2d f0 65 7e 05 66 ca
         c6 b8 49 ad 5e a6 3b 3d ac af 46 48 57 14 61 d2

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 1e 06 19 1f 26 45 1b 5d 6a 2d f0 65 7e 05 66
         ca c6 b8 49 ad 5e a6 3b 3d ac af 46 48 57 14 61 d2

      output (32 octets):  6b ba 44 38 0d 34 42 d7 6f 47 d1 05 b4 e7 06
         61 e8 16 6c 8f 52 85 13 a2 ba 39 cb 8e 57 57 ae 92

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  30 f9 4a 4b f8 0b 7e 29 df 7e 38 43 9f 86 4b 03
         67 01 31 44 64 13 b9 a6 f4 bc e4 44 f4 16 89 4d

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  20 73 f5 78 4d 92 2b da a5 be 6e 04 30 7a 3a
         b6 30 83 01 94 a7 e9 94 24 ce a3 79 af d4 f9 6b 9e

   {server}  extract secret "master":

      salt (32 octets):  20 73 f5 78 4d 92 2b da a5 be 6e 04 30 7a 3a b6
         30 83 01 94 a7 e9 94 24 ce a3 79 af d4 f9 6b 9e




Thomson                 Expires November 9, 2018               [Page 19]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  36 58 f8 2b a5 d1 d3 ea 97 7b d2 85 86 e2 c8
         63 5d 97 40 07 c5 e0 c1 7a 71 be 31 27 d3 3f 31 2a

   {server}  send handshake record:

      payload (96 octets):  02 00 00 5c 03 03 b0 89 74 14 89 0c 0f 60 11
         fb 65 73 45 95 76 b8 3e b8 98 c0 9f 52 55 9f e8 dc 84 72 cb d6
         b1 0d 00 13 01 00 00 34 00 29 00 02 00 00 00 33 00 24 00 1d 00
         20 cc ce 7a 95 46 c2 24 ca 94 b8 98 e6 93 ee 86 33 74 9f ab 0a
         f2 94 8c e6 3b db f6 1a 40 5e 26 52 00 2b 00 02 7f 1c

      ciphertext (101 octets):  16 03 03 00 60 02 00 00 5c 03 03 b0 89
         74 14 89 0c 0f 60 11 fb 65 73 45 95 76 b8 3e b8 98 c0 9f 52 55
         9f e8 dc 84 72 cb d6 b1 0d 00 13 01 00 00 34 00 29 00 02 00 00
         00 33 00 24 00 1d 00 20 cc ce 7a 95 46 c2 24 ca 94 b8 98 e6 93
         ee 86 33 74 9f ab 0a f2 94 8c e6 3b db f6 1a 40 5e 26 52 00 2b
         00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  6b ba 44 38 0d 34 42 d7 6f 47 d1 05 b4 e7 06 61
         e8 16 6c 8f 52 85 13 a2 ba 39 cb 8e 57 57 ae 92

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b0 17 44 88 d4 2d bf 67 2d 48 7f 51 a0 59
         7d e4

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2a b4 fd bd f5 c0 aa 97 07 71 83 32

   {server}  send a EncryptedExtensions handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  6b ba 44 38 0d 34 42 d7 6f 47 d1 05 b4 e7 06 61
         e8 16 6c 8f 52 85 13 a2 ba 39 cb 8e 57 57 ae 92

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00





Thomson                 Expires November 9, 2018               [Page 20]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  4a b7 f2 f1 25 fa b1 23 c2 45 80 8d 64 3c 3e
         52 1a de 49 b5 85 44 75 da d8 d0 b2 dd ef 38 af 56

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (74 octets):  08 00 00 22 00 20 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 00 2a
         00 00 14 00 00 20 9e aa 96 6c be c8 7c 05 6b e5 6e 50 8a e2 90
         57 c6 fb 16 13 fe 4a 3c dd ef 14 df 28 1c cc 76 78

      ciphertext (96 octets):  17 03 03 00 5b c4 59 d1 02 b6 f7 e2 1c c7
         cd 1d b3 e2 1d 0d e2 46 cb dc 07 2b d9 8d 57 cc 6f 12 78 df ca
         e4 cd 4d 8b e9 5f 6b de fb 17 26 57 52 cc cc 89 db 8b c7 ca ec
         71 e3 50 54 39 6e f7 19 a6 0c 1c 5e 2b c9 98 69 0a 7f 14 06 1f
         3d 10 f8 15 a8 cc 1c 6a 0a b8 63 5b bb 7a c6 62 cd 32 2a

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  36 58 f8 2b a5 d1 d3 ea 97 7b d2 85 86 e2 c8 63
         5d 97 40 07 c5 e0 c1 7a 71 be 31 27 d3 3f 31 2a

      hash (32 octets):  e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b 3f
         74 fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b
         3f 74 fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      output (32 octets):  25 68 c0 e8 d1 de 03 53 33 74 4a 12 61 ad 42
         49 a4 ef cb 6a a5 63 08 24 b9 17 06 5e 64 8c 35 e0

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  36 58 f8 2b a5 d1 d3 ea 97 7b d2 85 86 e2 c8 63
         5d 97 40 07 c5 e0 c1 7a 71 be 31 27 d3 3f 31 2a

      hash (32 octets):  e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b 3f
         74 fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b
         3f 74 fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      output (32 octets):  85 a8 25 1f c6 e3 10 5a 61 65 24 e1 04 2e 71
         70 51 74 95 94 69 80 10 e7 cb 7b ea 9c 72 f7 45 77




Thomson                 Expires November 9, 2018               [Page 21]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  36 58 f8 2b a5 d1 d3 ea 97 7b d2 85 86 e2 c8 63
         5d 97 40 07 c5 e0 c1 7a 71 be 31 27 d3 3f 31 2a

      hash (32 octets):  e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b 3f
         74 fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 e5 9d b4 b4 3e 6b 07 2d 4d ce f3 6b d1 3c 2b 3f 74
         fe 1a 2b 9c df 03 b1 b2 b9 d6 55 89 0c e6 0d

      output (32 octets):  23 b3 5a a1 73 5e d7 6b ab 15 c4 63 74 73 f6
         1c 51 55 2a 43 2e 93 06 cb 13 82 68 07 b0 b1 da f2

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  85 a8 25 1f c6 e3 10 5a 61 65 24 e1 04 2e 71 70
         51 74 95 94 69 80 10 e7 cb 7b ea 9c 72 f7 45 77

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c2 e6 48 24 4e 9f d8 66 83 47 f8 d6 06 28
         1c ff

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  d7 6b 8a 96 f2 10 50 1e 16 2f c3 07

   {server}  derive read traffic keys for early application data (same
      as client write traffic keys)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  23 8b 57 43 39 50 ba 69 35 05 ed 0e ef e0 30 a7
         95 c4 f7 17 b6 cb 76 c7 56 e5 61 25 33 f6 51 fe

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  a1 bf 40 8c 03 7d 13 b4 f1 8c b3 f7 e2 2a 58
         0c 27 d2 04 70 70 51 88 2a c1 80 41 21 25 43 c5 64

   {client}  extract secret "handshake":



Thomson                 Expires November 9, 2018               [Page 22]

Internet-Draft               TLS 1.3 Traces                     May 2018


      salt (32 octets):  a1 bf 40 8c 03 7d 13 b4 f1 8c b3 f7 e2 2a 58 0c
         27 d2 04 70 70 51 88 2a c1 80 41 21 25 43 c5 64

      ikm (32 octets):  12 7f 44 0f cb 9a 01 a7 01 18 81 f0 43 4f c2 23
         04 a8 1a f2 69 40 d7 53 81 33 ff c0 2d 8e ae 47

      secret (32 octets):  30 f9 4a 4b f8 0b 7e 29 df 7e 38 43 9f 86 4b
         03 67 01 31 44 64 13 b9 a6 f4 bc e4 44 f4 16 89 4d

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  6b ba 44 38 0d 34 42 d7 6f 47 d1 05 b4 e7 06 61
         e8 16 6c 8f 52 85 13 a2 ba 39 cb 8e 57 57 ae 92

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b0 17 44 88 d4 2d bf 67 2d 48 7f 51 a0 59
         7d e4

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2a b4 fd bd f5 c0 aa 97 07 71 83 32

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send a EndOfEarlyData handshake message

   {client}  send handshake record:

      payload (4 octets):  05 00 00 00

      ciphertext (26 octets):  17 03 03 00 15 07 dc b8 8c 4a a6 b9 33 cf
         82 83 40 5c 14 74 76 bf 5b c3 e1 9c




Thomson                 Expires November 9, 2018               [Page 23]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive write traffic keys for handshake data:

      PRK (32 octets):  2e 84 66 da a6 69 b3 bb a1 cb 3a fc 59 d0 65 f9
         2a 14 cc 4e 80 c7 4c b4 19 4a 6a 75 a4 3e fc 83

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c6 21 01 61 bb 84 f7 eb 1f 64 93 54 0e 4c
         a9 9a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  bd a7 e2 aa 67 77 c1 a0 75 57 f4 5e

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  2e 84 66 da a6 69 b3 bb a1 cb 3a fc 59 d0 65 f9
         2a 14 cc 4e 80 c7 4c b4 19 4a 6a 75 a4 3e fc 83

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  1e a9 54 5f 3a 56 b7 ed d6 6b 1d f1 64 47 94
         28 50 f4 e3 46 9d 1f cb ce cd 28 ad 6b 87 a9 24 8f

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 d8 f4 4f 32 de f1 1b 7a a4 27 df
         d3 71 2a c8 60 9a 9f 06 83 45 a9 bf fc b4 95 66 03 d3 3d 0c 86

      ciphertext (58 octets):  17 03 03 00 35 37 e7 70 50 70 36 b7 10 d4
         8b 95 58 9d b1 27 66 c8 81 f7 50 1a fa 52 82 d1 bd ee 6f 30 05
         da 6b 04 c6 62 8e 56 78 04 92 17 66 83 9b 2f bd 93 78 d2 13 ab
         5a 47

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  25 68 c0 e8 d1 de 03 53 33 74 4a 12 61 ad 42 49
         a4 ef cb 6a a5 63 08 24 b9 17 06 5e 64 8c 35 e0

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00



Thomson                 Expires November 9, 2018               [Page 24]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  3b 2b 20 ec 65 47 f7 ca d0 34 c1 f0 1c 28
         0f a1

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  73 9e d1 44 50 3b 7b d6 b6 3a 23 c6

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  36 58 f8 2b a5 d1 d3 ea 97 7b d2 85 86 e2 c8 63
         5d 97 40 07 c5 e0 c1 7a 71 be 31 27 d3 3f 31 2a

      hash (32 octets):  a7 cf 22 5b 14 2d e8 75 ed 22 15 44 6c 0a b2 1f
         33 13 eb e1 52 ec e5 71 be 25 46 50 6e dc bf 34

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 a7 cf 22 5b 14 2d e8 75 ed 22 15 44 6c 0a b2 1f 33
         13 eb e1 52 ec e5 71 be 25 46 50 6e dc bf 34

      output (32 octets):  c2 af 4f 32 ba 73 74 53 08 de 68 ef fa 5b 70
         d7 85 1f 9a 4e b2 88 99 66 4b 20 39 a2 83 a9 18 c3

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  2e 84 66 da a6 69 b3 bb a1 cb 3a fc 59 d0 65 f9
         2a 14 cc 4e 80 c7 4c b4 19 4a 6a 75 a4 3e fc 83

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c6 21 01 61 bb 84 f7 eb 1f 64 93 54 0e 4c
         a9 9a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  bd a7 e2 aa 67 77 c1 a0 75 57 f4 5e

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31



Thomson                 Expires November 9, 2018               [Page 25]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (72 octets):  17 03 03 00 43 20 68 7d 59 df 1b bd da f0
         cf b0 3e 7c 53 eb 66 52 04 83 cb 06 3d 68 bd 62 46 18 33 15 46
         67 5d 5c 81 69 34 ca 55 d4 44 51 d1 cd e9 c1 3b 37 21 4e eb f1
         b3 de 4f df 8c 4f eb ad 42 31 d8 f9 20 e0 79 50

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 e5 d5 61 13 2e a3 29 e0 f2
         18 db bd f2 88 f6 f6 4e c9 cf 3c 25 b5 20 fe 2c 5c 80 24 2f 04
         1d 61 09 96 58 8d 9a 26 55 96 6e bc 00 be 02 c0 bf 98 3d cb 8b
         84 a0 10 4f 0b 97 30 1b e6 b0 84 28 a8 e7 42 ba

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 d9 74 3f 7f 6e e2 f5 6f 20
         e0 39 e4 8f f5 be 7a 4f 80 9d

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 34 69 8f 6b cc 36 be da d3
         9b db 5e 48 3b 11 fd 7b c4 ea

5.  HelloRetryRequest

   In this example, the client initiates a handshake with an X25519
   [RFC7748] share.  The server however prefers P-256 [FIPS186] and
   sends a HelloRetryRequest that requires the client to generate a key
   share on the P-256 curve.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  8e 62 95 67 c8 6f 4d fe e6 09 50 de e6
         64 5f eb b9 21 dc 86 3f fa fd 23 96 0d e6 bd 1c 29 1e 71

      public key (32 octets):  39 4b 10 6c e0 b6 66 44 f5 d9 20 b7 2f 60
         82 f2 cf 81 23 5f 4c d8 90 20 6a f1 6c 9a 01 98 1e 32

   {client}  send a ClientHello handshake message

   {client}  send handshake record:



Thomson                 Expires November 9, 2018               [Page 26]

Internet-Draft               TLS 1.3 Traces                     May 2018


      payload (174 octets):  01 00 00 aa 03 03 c4 13 7f 51 9d b7 93 82
         c9 59 16 41 a9 3d 03 73 70 d8 f1 e9 9e fd c0 3a e4 0a 80 78 47
         00 dd e0 00 00 06 13 01 13 03 13 02 01 00 00 7b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00 20 39 4b 10 6c e0
         b6 66 44 f5 d9 20 b7 2f 60 82 f2 cf 81 23 5f 4c d8 90 20 6a f1
         6c 9a 01 98 1e 32 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03
         05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04
         02 05 02 06 02 02 02 00 2d 00 02 01 01

      ciphertext (179 octets):  16 03 01 00 ae 01 00 00 aa 03 03 c4 13
         7f 51 9d b7 93 82 c9 59 16 41 a9 3d 03 73 70 d8 f1 e9 9e fd c0
         3a e4 0a 80 78 47 00 dd e0 00 00 06 13 01 13 03 13 02 01 00 00
         7b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00
         20 39 4b 10 6c e0 b6 66 44 f5 d9 20 b7 2f 60 82 f2 cf 81 23 5f
         4c d8 90 20 6a f1 6c 9a 01 98 1e 32 00 2b 00 03 02 7f 1c 00 0d
         00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05
         01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61 11
         be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2 c8
         a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17 00 2c 00 74 00 72
         97 d9 0f 38 4b 92 2c 10 a3 8d ee a5 00 00 00 00 e5 a1 80 35 d6
         86 10 eb d2 6e 0b 53 e5 da 30 dc 00 30 19 d4 a0 ad f7 8f 14 36
         80 2b cf a9 c9 03 7d f5 0e f1 ca 5c b2 cc b1 17 ec bc 3c 83 66
         42 92 59 d7 48 95 94 58 3e d1 e0 ea 9b 99 02 c6 88 c4 74 fe 36
         dc 63 80 67 b9 30 09 f6 bf 84 f3 34 de 95 9c 25 65 84 b0 ce a1
         c2 1e 75 cf 34 f5 6e b3 c9 00 2b 00 02 7f 1c

      ciphertext (181 octets):  16 03 03 00 b0 02 00 00 ac 03 03 cf 21
         ad 74 e5 9a 61 11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c
         5e 07 9e 09 e2 c8 a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17
         00 2c 00 74 00 72 97 d9 0f 38 4b 92 2c 10 a3 8d ee a5 00 00 00
         00 e5 a1 80 35 d6 86 10 eb d2 6e 0b 53 e5 da 30 dc 00 30 19 d4
         a0 ad f7 8f 14 36 80 2b cf a9 c9 03 7d f5 0e f1 ca 5c b2 cc b1
         17 ec bc 3c 83 66 42 92 59 d7 48 95 94 58 3e d1 e0 ea 9b 99 02
         c6 88 c4 74 fe 36 dc 63 80 67 b9 30 09 f6 bf 84 f3 34 de 95 9c
         25 65 84 b0 ce a1 c2 1e 75 cf 34 f5 6e b3 c9 00 2b 00 02 7f 1c

   {client}  create an ephemeral P-256 key pair:

      private key (32 octets):  a6 9f 49 ab 16 ae 1c 42 85 25 e8 89 a1
         a4 a9 ba 02 ed 3d b7 47 01 29 47 fb 7e f2 af a0 81 9e 4b



Thomson                 Expires November 9, 2018               [Page 27]

Internet-Draft               TLS 1.3 Traces                     May 2018


      public key (65 octets):  04 f7 f1 f3 e9 bf 43 67 21 d6 c4 6a 0d b8
         ee 6e 15 b3 85 f7 95 76 cc 8c e7 cd a1 b2 2f 2e ac d9 c4 88 c1
         33 d0 05 6f a3 88 8e 75 1a 26 b7 ed f4 e5 bd 88 a8 5f f3 71 ec
         f6 73 63 59 3a 70 6a a9 10

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 c4 13 7f 51 9d b7 93 82
         c9 59 16 41 a9 3d 03 73 70 d8 f1 e9 9e fd c0 3a e4 0a 80 78 47
         00 dd e0 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00 41 04 f7 f1 f3 e9
         bf 43 67 21 d6 c4 6a 0d b8 ee 6e 15 b3 85 f7 95 76 cc 8c e7 cd
         a1 b2 2f 2e ac d9 c4 88 c1 33 d0 05 6f a3 88 8e 75 1a 26 b7 ed
         f4 e5 bd 88 a8 5f f3 71 ec f6 73 63 59 3a 70 6a a9 10 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2c
         00 74 00 72 97 d9 0f 38 4b 92 2c 10 a3 8d ee a5 00 00 00 00 e5
         a1 80 35 d6 86 10 eb d2 6e 0b 53 e5 da 30 dc 00 30 19 d4 a0 ad
         f7 8f 14 36 80 2b cf a9 c9 03 7d f5 0e f1 ca 5c b2 cc b1 17 ec
         bc 3c 83 66 42 92 59 d7 48 95 94 58 3e d1 e0 ea 9b 99 02 c6 88
         c4 74 fe 36 dc 63 80 67 b9 30 09 f6 bf 84 f3 34 de 95 9c 25 65
         84 b0 ce a1 c2 1e 75 cf 34 f5 6e b3 c9 00 2d 00 02 01 01 00 15
         00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      ciphertext (517 octets):  16 03 03 02 00 01 00 01 fc 03 03 c4 13
         7f 51 9d b7 93 82 c9 59 16 41 a9 3d 03 73 70 d8 f1 e9 9e fd c0
         3a e4 0a 80 78 47 00 dd e0 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00
         41 04 f7 f1 f3 e9 bf 43 67 21 d6 c4 6a 0d b8 ee 6e 15 b3 85 f7
         95 76 cc 8c e7 cd a1 b2 2f 2e ac d9 c4 88 c1 33 d0 05 6f a3 88
         8e 75 1a 26 b7 ed f4 e5 bd 88 a8 5f f3 71 ec f6 73 63 59 3a 70
         6a a9 10 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2c 00 74 00 72 97 d9 0f 38 4b 92 2c 10 a3 8d ee
         a5 00 00 00 00 e5 a1 80 35 d6 86 10 eb d2 6e 0b 53 e5 da 30 dc
         00 30 19 d4 a0 ad f7 8f 14 36 80 2b cf a9 c9 03 7d f5 0e f1 ca



Thomson                 Expires November 9, 2018               [Page 28]

Internet-Draft               TLS 1.3 Traces                     May 2018


         5c b2 cc b1 17 ec bc 3c 83 66 42 92 59 d7 48 95 94 58 3e d1 e0
         ea 9b 99 02 c6 88 c4 74 fe 36 dc 63 80 67 b9 30 09 f6 bf 84 f3
         34 de 95 9c 25 65 84 b0 ce a1 c2 1e 75 cf 34 f5 6e b3 c9 00 2d
         00 02 01 01 00 15 00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral P-256 key pair:

      private key (32 octets):  ac 4f b8 68 c6 6f ce 26 3b 72 16 4f 15
         49 bc 6c e3 97 d9 17 2a 11 9d 58 f9 eb 47 fe 1e 42 b2 c9

      public key (65 octets):  04 a5 3a 7d 4a 05 3d 00 09 c6 d0 29 35 d4
         07 22 a4 89 34 bc 52 f3 e1 42 b9 ae a0 46 e6 8f 6e e3 12 8f 71
         00 39 de 87 1a e9 e9 08 bd ed 3f fc d7 96 ae ef e0 75 66 91 a8
         a9 3a de 35 9d 6f 51 0a fe

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55





Thomson                 Expires November 9, 2018               [Page 29]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  c1 bc b0 6e cb 53 22 20 4b 7f a2 9e cb df 3e 03
         75 c4 58 ac d8 b7 7e fa 3a ce e7 fd a2 96 52 c7

      secret (32 octets):  15 20 67 07 6f 6b d3 0f d0 7d 28 8c ad f7 bb
         ec 9e 01 2e 13 2f bd b2 30 51 65 12 8f f1 f9 a6 65

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  15 20 67 07 6f 6b d3 0f d0 7d 28 8c ad f7 bb ec
         9e 01 2e 13 2f bd b2 30 51 65 12 8f f1 f9 a6 65

      hash (32 octets):  ea 5d d3 f6 f2 a2 4c f3 86 c6 b5 f9 77 c2 01 da
         ca 5a 24 5d 72 8c e9 b3 10 68 25 b1 c1 84 84 64

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 ea 5d d3 f6 f2 a2 4c f3 86 c6 b5 f9 77 c2 01
         da ca 5a 24 5d 72 8c e9 b3 10 68 25 b1 c1 84 84 64

      output (32 octets):  d4 3d c7 d5 c9 a6 94 43 03 90 b7 07 bd 94 83
         e6 a7 22 23 f2 5d 84 3f c8 0d 9c 13 b3 99 cf 3e 5c

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  15 20 67 07 6f 6b d3 0f d0 7d 28 8c ad f7 bb ec
         9e 01 2e 13 2f bd b2 30 51 65 12 8f f1 f9 a6 65

      hash (32 octets):  ea 5d d3 f6 f2 a2 4c f3 86 c6 b5 f9 77 c2 01 da
         ca 5a 24 5d 72 8c e9 b3 10 68 25 b1 c1 84 84 64

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 ea 5d d3 f6 f2 a2 4c f3 86 c6 b5 f9 77 c2 01
         da ca 5a 24 5d 72 8c e9 b3 10 68 25 b1 c1 84 84 64

      output (32 octets):  25 b3 6d 74 09 ba c9 1f 12 12 80 5f 74 11 ac
         e8 64 cc fb 8e d0 f8 4e 99 15 27 0c ee f3 96 dd 67

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  15 20 67 07 6f 6b d3 0f d0 7d 28 8c ad f7 bb ec
         9e 01 2e 13 2f bd b2 30 51 65 12 8f f1 f9 a6 65



Thomson                 Expires November 9, 2018               [Page 30]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  fb 84 7a cd 1c a6 cf 1c e5 de 71 f9 0f f9 01
         f5 9b c5 72 e1 15 ea c4 2d c0 1d 33 b2 ce 63 fd 90

   {server}  extract secret "master":

      salt (32 octets):  fb 84 7a cd 1c a6 cf 1c e5 de 71 f9 0f f9 01 f5
         9b c5 72 e1 15 ea c4 2d c0 1d 33 b2 ce 63 fd 90

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  26 5f bc 12 20 a8 05 0d bd 6a 52 ee f2 f9 e8
         fe 66 6b e3 2e 3d f5 36 99 bb 6a 84 92 4d e3 2b c4

   {server}  send handshake record:

      payload (123 octets):  02 00 00 77 03 03 32 3c 7a e0 64 49 20 89
         38 28 d2 5c fc 9d c8 57 7c 86 cd 57 eb ad f1 f3 0b 54 1c 77 a6
         88 1a 22 00 13 01 00 00 4f 00 33 00 45 00 17 00 41 04 a5 3a 7d
         4a 05 3d 00 09 c6 d0 29 35 d4 07 22 a4 89 34 bc 52 f3 e1 42 b9
         ae a0 46 e6 8f 6e e3 12 8f 71 00 39 de 87 1a e9 e9 08 bd ed 3f
         fc d7 96 ae ef e0 75 66 91 a8 a9 3a de 35 9d 6f 51 0a fe 00 2b
         00 02 7f 1c

      ciphertext (128 octets):  16 03 03 00 7b 02 00 00 77 03 03 32 3c
         7a e0 64 49 20 89 38 28 d2 5c fc 9d c8 57 7c 86 cd 57 eb ad f1
         f3 0b 54 1c 77 a6 88 1a 22 00 13 01 00 00 4f 00 33 00 45 00 17
         00 41 04 a5 3a 7d 4a 05 3d 00 09 c6 d0 29 35 d4 07 22 a4 89 34
         bc 52 f3 e1 42 b9 ae a0 46 e6 8f 6e e3 12 8f 71 00 39 de 87 1a
         e9 e9 08 bd ed 3f fc d7 96 ae ef e0 75 66 91 a8 a9 3a de 35 9d
         6f 51 0a fe 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  25 b3 6d 74 09 ba c9 1f 12 12 80 5f 74 11 ac e8
         64 cc fb 8e d0 f8 4e 99 15 27 0c ee f3 96 dd 67

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b8 52 4d 7f 0f 65 e8 c6 1f b6 9c 19 4b 10
         b4 77



Thomson                 Expires November 9, 2018               [Page 31]

Internet-Draft               TLS 1.3 Traces                     May 2018


      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  47 46 a4 0a 4c ae 16 a7 84 ee 13 ec

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  25 b3 6d 74 09 ba c9 1f 12 12 80 5f 74 11 ac e8
         64 cc fb 8e d0 f8 4e 99 15 27 0c ee f3 96 dd 67

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  40 a3 6b 54 ca b9 0c 09 2a 76 a2 d0 58 33 27
         d8 ee b2 21 54 57 29 00 50 64 9d 48 30 f0 62 e8 16

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (639 octets):  08 00 00 12 00 10 00 0a 00 08 00 06 00 17
         00 18 00 1d 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93
         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b



Thomson                 Expires November 9, 2018               [Page 32]

Internet-Draft               TLS 1.3 Traces                     May 2018


         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 54
         8b 8c 8c 20 af 1c 12 b4 b8 9e 72 90 54 d7 e3 28 04 f6 32 89 82
         3f 97 21 28 73 2c 9c 3d 2c a0 70 c8 2b 70 1c 38 e2 4c 41 5c 34
         48 6f fe 3b 69 bd 3d c5 dd 92 78 57 35 9d c6 f1 58 8c e9 11 35
         61 19 22 2e 3e 17 8f b6 ae fd c3 b7 55 4f fd fe 1e 83 f1 e8 1c
         59 50 7a 4d e1 fe 2a 37 2a c9 e9 63 b0 01 80 e3 dd 55 05 6f 8c
         c0 ff 99 71 31 46 9d a9 bc 4c 07 6e a3 9d 31 82 b6 93 60 93 a5
         cd 14 00 00 20 56 98 4f 7a 93 a9 1d a4 13 9d ad 7b 56 f6 a0 7b
         32 c0 e4 fd 0f 41 d3 52 a3 84 49 27 15 b5 37 37

      ciphertext (661 octets):  17 03 03 02 90 c3 83 2f 06 5f 61 34 26
         77 b5 8d bc 88 35 41 45 94 42 17 76 d7 12 7d 9e 1f a1 74 a1 cc
         1f 03 42 85 52 06 1f 98 ad 94 1d cf 0a 7a 54 dd 99 5a 6e ae fe
         60 26 b8 19 b7 55 3a 0c 57 15 af e5 fb bf 84 7b aa 85 58 4c 67
         c5 f9 1d 4a 20 48 97 43 35 24 d9 5a 1c 67 27 67 8f 00 e5 04 b3
         42 6f 3d fa fd f4 a6 20 7f 21 4d e8 e5 fb a7 e1 91 c5 a9 e0 87
         c0 e1 96 90 15 7f 36 38 87 84 87 40 d8 c3 35 4e 1b e6 c5 5e 3b
         62 44 7d f5 e7 12 e2 5e 3e e7 8e 1e a9 5f 79 42 12 0c 50 82 7c
         9e 19 50 b0 fc 45 18 6d 38 10 14 68 61 ad 8f e1 b5 35 71 d6 63
         34 68 58 c7 d6 d4 d8 c3 7f 54 04 6c 5b 57 84 83 c8 a5 02 52 b4
         81 de 1a 3b 25 f8 be 88 a2 ce 0d 1b eb 88 4f d7 2d bf 6d cc 63
         45 b7 f4 f0 b8 8b 9a 28 fb 77 45 b7 78 ac 50 60 df 3d ef 6d 7a
         38 b2 07 d6 7e c8 6b f6 92 ed bb 27 11 92 fc ab 48 c7 20 96 76
         74 d7 54 3c 7e e6 ab c1 03 40 34 71 f5 b3 b7 10 a4 45 c9 01 27
         f1 9f d1 b3 df cb fc 10 81 3c 24 a1 4d 9e 05 b0 06 7f d1 ba 05
         07 77 38 2a 1b e5 27 00 ec 5b 5a f5 37 8f 5b f2 b5 eb fc e1 bf
         34 ae 75 40 f8 33 f8 4c 3b c2 b1 41 21 e8 86 db eb 00 e7 4e e4
         be f1 73 f3 ac 1e ff 7a 73 4a a5 c1 7b 5d fb 91 cd 67 23 f0 9f
         4a dc 53 1c db ae 22 6d a8 d4 6b 3c ee c6 b7 ad 7e ee 53 e0 6c
         0c 98 fc b7 97 d1 e2 0f 4a c5 2f 04 64 fe 73 f8 e3 ea 59 12 9d
         07 4e 08 ac 6a d3 4c a4 4b f4 05 18 13 71 9f 26 db b4 45 a6 cc
         47 1c e6 70 e8 6d b0 51 2e 43 68 a8 62 9d 81 53 c3 ae 8c 45 8c
         0c e3 64 d1 c3 02 68 8f 5c 37 3f 29 5d 87 a7 47 71 68 a1 b8 fe
         ff 3e 97 bc 6d ec 60 e9 78 98 1c 0a 21 2f 4e 54 d0 65 3c 99 7d
         6d e3 a6 96 85 11 43 04 5f 62 17 52 46 0d e6 1e 71 f3 5b 2a df
         4a 01 0a 32 39 3d b2 5d 13 8d 39 5b 19 ce 52 79 94 07 39 4e 25
         f9 a9 3e 81 48 0f 28 5e 9d e3 7e 45 18 61 b4 37 1e be 34 4d bb
         b5 41 1e 95 80 10 18 a1 c9 e1 ae ea 59 4b 43 e6 9c a0 e1 95 1c
         ec 34 31 65 ef 62 b1 2c 26 ad c6 dc 84 dc ca bb 4e 2d a7 39 93
         ea 1e 59 8f 93 d8 81 0a b8 7f ea 69 ed dd e2 6f dd 60 76 9c 93
         9f 55 7c 92 02 02 0d ef 7c e8 be 75 0d d0 07 bd e2 d3 8b c6 2b
         c2 e8 a4 ac 63 f7 92 41 48 4e 66 d8 74 ca 48 0b 56 54

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  26 5f bc 12 20 a8 05 0d bd 6a 52 ee f2 f9 e8 fe
         66 6b e3 2e 3d f5 36 99 bb 6a 84 92 4d e3 2b c4



Thomson                 Expires November 9, 2018               [Page 33]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e 12
         c4 b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e
         12 c4 b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      output (32 octets):  74 05 88 82 2b 82 e2 b0 78 1a eb e6 e2 b8 d0
         3d 0e 5d 38 e4 be ce b1 2c 75 88 c3 9e c9 98 cc b3

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  26 5f bc 12 20 a8 05 0d bd 6a 52 ee f2 f9 e8 fe
         66 6b e3 2e 3d f5 36 99 bb 6a 84 92 4d e3 2b c4

      hash (32 octets):  c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e 12
         c4 b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e
         12 c4 b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      output (32 octets):  b9 51 8c 14 5e ab 7f 62 a1 7a c1 aa 7b 1c f7
         62 49 d5 8e 2a c7 6d 8c 24 ea fb 94 f8 af f2 a7 85

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  26 5f bc 12 20 a8 05 0d bd 6a 52 ee f2 f9 e8 fe
         66 6b e3 2e 3d f5 36 99 bb 6a 84 92 4d e3 2b c4

      hash (32 octets):  c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e 12
         c4 b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 c3 57 c1 04 b8 f6 50 db c2 1a 81 37 6f de 5e 12 c4
         b3 ed 2f 34 7d 20 ec 17 c6 da ac 99 7e 17 0b

      output (32 octets):  fb 23 c3 e6 42 16 b5 3e ab 24 4d b8 5d 68 9c
         37 ad 0c 98 c9 ca 22 9c c6 00 f2 5a 82 ea 88 5b 98

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  b9 51 8c 14 5e ab 7f 62 a1 7a c1 aa 7b 1c f7 62
         49 d5 8e 2a c7 6d 8c 24 ea fb 94 f8 af f2 a7 85

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00





Thomson                 Expires November 9, 2018               [Page 34]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  19 94 2e 00 f2 da 41 f3 a3 ff 5f e0 9a 04
         cd a6

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c0 63 37 f6 59 ac e3 22 51 b8 bf 66

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  d4 3d c7 d5 c9 a6 94 43 03 90 b7 07 bd 94 83 e6
         a7 22 23 f2 5d 84 3f c8 0d 9c 13 b3 99 cf 3e 5c

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  0b e3 4b 20 15 c0 e1 42 a2 77 d3 60 a1 6b
         92 a9

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2a 7b 39 0e 2f fe 90 bc 24 4a 6c 0e

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":




Thomson                 Expires November 9, 2018               [Page 35]

Internet-Draft               TLS 1.3 Traces                     May 2018


      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  c1 bc b0 6e cb 53 22 20 4b 7f a2 9e cb df 3e 03
         75 c4 58 ac d8 b7 7e fa 3a ce e7 fd a2 96 52 c7

      secret (32 octets):  15 20 67 07 6f 6b d3 0f d0 7d 28 8c ad f7 bb
         ec 9e 01 2e 13 2f bd b2 30 51 65 12 8f f1 f9 a6 65

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  25 b3 6d 74 09 ba c9 1f 12 12 80 5f 74 11 ac e8
         64 cc fb 8e d0 f8 4e 99 15 27 0c ee f3 96 dd 67

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b8 52 4d 7f 0f 65 e8 c6 1f b6 9c 19 4b 10
         b4 77

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  47 46 a4 0a 4c ae 16 a7 84 ee 13 ec

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":





Thomson                 Expires November 9, 2018               [Page 36]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  d4 3d c7 d5 c9 a6 94 43 03 90 b7 07 bd 94 83 e6
         a7 22 23 f2 5d 84 3f c8 0d 9c 13 b3 99 cf 3e 5c

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  91 22 c8 4b de 2e 5e d6 31 98 b6 53 d2 6a 26
         29 d0 c2 e7 df 1c 2a 71 8b 94 47 14 67 d9 a3 d2 e1

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 2e fa 94 90 b4 ee db e9 ad 2c 94
         f4 c5 7c 9a c0 cb 2f af e9 f3 5c 73 4f fb 30 d4 27 b2 46 1e 58

      ciphertext (58 octets):  17 03 03 00 35 cb e7 be 1b a5 7d b8 9a 7e
         10 c9 ea c8 f0 4a 67 79 64 c9 b7 06 48 f7 a6 5f d2 99 2a b7 8c
         5a d4 a2 23 4f 5a 9d 2b a4 01 fe a1 b1 79 08 83 76 f1 5f 41 7a
         88 ad

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  74 05 88 82 2b 82 e2 b0 78 1a eb e6 e2 b8 d0 3d
         0e 5d 38 e4 be ce b1 2c 75 88 c3 9e c9 98 cc b3

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  71 dd 63 40 83 51 91 1f 0f 99 e2 50 91 8c
         ee 92

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  41 6d d6 7f ac af da f1 0e 68 d8 ac

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  26 5f bc 12 20 a8 05 0d bd 6a 52 ee f2 f9 e8 fe
         66 6b e3 2e 3d f5 36 99 bb 6a 84 92 4d e3 2b c4

      hash (32 octets):  86 4e fc 7a 2c 2d d7 fe 3c 8a ff 44 66 94 61 df
         a1 f2 ea 09 61 ba 6b 8d d3 8e 39 84 1d 73 28 3f

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 86 4e fc 7a 2c 2d d7 fe 3c 8a ff 44 66 94 61 df a1
         f2 ea 09 61 ba 6b 8d d3 8e 39 84 1d 73 28 3f



Thomson                 Expires November 9, 2018               [Page 37]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  61 56 5f d8 b0 f5 af f8 e0 bb 0c b3 b2 21 ff
         23 1f f1 c2 94 54 da b9 0b 23 24 85 58 38 53 53 90

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 c2 02 0f 74 ad b1 26 f4 d3
         e8 f0 be e7 e6 07 f2 8e be 43

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 41 9c a2 f9 54 53 89 b0 13
         04 a7 21 15 81 30 66 1e 81 37

6.  Client Authentication

   In this example, the server requests client authentication.  The
   client uses a certificate with an RSA key, the server uses an ECDSA
   certificate with a P-256 key.  Note that private keys for this
   example are not included in the draft.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  92 5c 3e a9 cc 23 54 f7 fc cc 72 e0 6b
         1c a4 6f 3d ff 4d ac 74 06 a1 8d 7f 62 0d 7d 07 bc e2 06

      public key (32 octets):  3e 50 ce d2 ff 42 70 26 a7 04 08 b2 a1 06
         7e 7a 0b 17 b5 62 82 37 37 a9 4c c6 1b 0d e1 8a b1 60

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (186 octets):  01 00 00 b6 03 03 61 2a c8 cc 5f e9 f5 fb
         d3 47 c5 43 07 f4 04 b5 06 55 e3 80 2e 45 3e 1e 0c d8 3f eb 55
         20 c9 6a 00 00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00



Thomson                 Expires November 9, 2018               [Page 38]

Internet-Draft               TLS 1.3 Traces                     May 2018


         26 00 24 00 1d 00 20 3e 50 ce d2 ff 42 70 26 a7 04 08 b2 a1 06
         7e 7a 0b 17 b5 62 82 37 37 a9 4c c6 1b 0d e1 8a b1 60 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d
         00 02 01 01

      ciphertext (191 octets):  16 03 01 00 ba 01 00 00 b6 03 03 61 2a
         c8 cc 5f e9 f5 fb d3 47 c5 43 07 f4 04 b5 06 55 e3 80 2e 45 3e
         1e 0c d8 3f eb 55 20 c9 6a 00 00 06 13 01 13 03 13 02 01 00 00
         87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 3e 50 ce d2 ff 42 70 26
         a7 04 08 b2 a1 06 7e 7a 0b 17 b5 62 82 37 37 a9 4c c6 1b 0d e1
         8a b1 60 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  25 e6 55 61 c7 22 21 87 12 98 92 62 d4
         92 ce 83 8e 5d dd 74 7c ba 59 f5 83 2f 7b be a7 49 7e e3

      public key (32 octets):  e5 2b 2c 13 b6 a8 94 da 54 05 1f cf e9 eb
         83 ae 8b c5 24 0c 64 4d 8d 2b f3 1c 8c 1d 64 a6 e6 15

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55



Thomson                 Expires November 9, 2018               [Page 39]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  3a 09 65 1f 90 f7 64 4b 9b 88 28 8f a6 ac ab 1f
         52 a2 7d 14 ce 69 48 6a 77 a7 4d 3a 79 78 b7 6a

      secret (32 octets):  e2 f6 91 f0 0f 56 47 bf 83 3c 67 ca 1f b2 c1
         ed db 65 89 0a 2b 5a 9a c3 a0 64 79 7b be 15 0a 44

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  e2 f6 91 f0 0f 56 47 bf 83 3c 67 ca 1f b2 c1 ed
         db 65 89 0a 2b 5a 9a c3 a0 64 79 7b be 15 0a 44

      hash (32 octets):  69 24 45 18 d1 4c d4 9c 9f 0e 4f 86 aa 05 e8 db
         a0 ab 18 b4 b3 76 65 fa 42 4e 09 6a ef 42 f0 6f

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 69 24 45 18 d1 4c d4 9c 9f 0e 4f 86 aa 05 e8
         db a0 ab 18 b4 b3 76 65 fa 42 4e 09 6a ef 42 f0 6f

      output (32 octets):  3b 8b 48 1c 2c c3 80 46 79 a0 27 43 a1 3f 48
         58 98 33 04 cd 73 a4 d6 c2 85 04 78 b1 02 4d 02 1d

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  e2 f6 91 f0 0f 56 47 bf 83 3c 67 ca 1f b2 c1 ed
         db 65 89 0a 2b 5a 9a c3 a0 64 79 7b be 15 0a 44

      hash (32 octets):  69 24 45 18 d1 4c d4 9c 9f 0e 4f 86 aa 05 e8 db
         a0 ab 18 b4 b3 76 65 fa 42 4e 09 6a ef 42 f0 6f

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 69 24 45 18 d1 4c d4 9c 9f 0e 4f 86 aa 05 e8
         db a0 ab 18 b4 b3 76 65 fa 42 4e 09 6a ef 42 f0 6f

      output (32 octets):  27 ef 4c 28 b7 23 f0 9e e4 b1 32 9a 88 c8 65
         e4 ad 6d 6c 1f 01 da 89 a2 d5 39 d3 5b 40 35 56 01

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  e2 f6 91 f0 0f 56 47 bf 83 3c 67 ca 1f b2 c1 ed
         db 65 89 0a 2b 5a 9a c3 a0 64 79 7b be 15 0a 44



Thomson                 Expires November 9, 2018               [Page 40]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  35 53 46 91 49 a4 c3 6d d3 13 ed 2a fe b0 fe
         f8 03 0a 86 7a c6 aa c6 fc 75 8c da 33 df 9b 36 4e

   {server}  extract secret "master":

      salt (32 octets):  35 53 46 91 49 a4 c3 6d d3 13 ed 2a fe b0 fe f8
         03 0a 86 7a c6 aa c6 fc 75 8c da 33 df 9b 36 4e

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  ad 01 3f b2 67 50 37 1f b0 4c ce b4 8b 1a 3d
         cc 73 0a fd 8a 9e 3e 1a e9 a2 78 6a f8 06 e1 0a 96

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 64 1f 2e aa 09 bf bd 80 9c
         78 a6 14 50 f2 f2 15 52 0b e8 95 f1 46 1f 4b 34 8b 4e 21 bb 20
         e7 66 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 e5 2b 2c 13 b6
         a8 94 da 54 05 1f cf e9 eb 83 ae 8b c5 24 0c 64 4d 8d 2b f3 1c
         8c 1d 64 a6 e6 15 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 64 1f 2e
         aa 09 bf bd 80 9c 78 a6 14 50 f2 f2 15 52 0b e8 95 f1 46 1f 4b
         34 8b 4e 21 bb 20 e7 66 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 e5 2b 2c 13 b6 a8 94 da 54 05 1f cf e9 eb 83 ae 8b c5 24 0c
         64 4d 8d 2b f3 1c 8c 1d 64 a6 e6 15 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  27 ef 4c 28 b7 23 f0 9e e4 b1 32 9a 88 c8 65 e4
         ad 6d 6c 1f 01 da 89 a2 d5 39 d3 5b 40 35 56 01

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  ff f1 1e de 07 b8 42 cd 77 9f b3 66 d8 f3
         7c 72

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  71 b1 b3 ac d7 cd 1d 94 b6 b9 3b 51



Thomson                 Expires November 9, 2018               [Page 41]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  send a EncryptedExtensions handshake message

   {server}  send a CertificateRequest handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  27 ef 4c 28 b7 23 f0 9e e4 b1 32 9a 88 c8 65 e4
         ad 6d 6c 1f 01 da 89 a2 d5 39 d3 5b 40 35 56 01

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  25 3a 2a 55 4a 3b d5 8a 5e 44 17 2a af 21 4f
         c8 05 03 eb 0c 81 0d 85 30 96 59 12 1b ae ad 08 28

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (511 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0d
         00 00 27 00 00 24 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08
         04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02
         0b 00 01 3b 00 00 01 37 00 01 32 30 82 01 2e 30 81 d5 a0 03 02
         01 02 02 01 07 30 0a 06 08 2a 86 48 ce 3d 04 03 02 30 13 31 11
         30 0f 06 03 55 04 03 13 08 65 63 64 73 61 32 35 36 30 1e 17 0d
         31 36 30 37 33 30 30 31 32 34 30 30 5a 17 0d 32 36 30 37 33 30
         30 31 32 34 30 30 5a 30 13 31 11 30 0f 06 03 55 04 03 13 08 65
         63 64 73 61 32 35 36 30 59 30 13 06 07 2a 86 48 ce 3d 02 01 06
         08 2a 86 48 ce 3d 03 01 07 03 42 00 04 08 d5 30 16 15 75 f4 cf
         e7 f1 54 ee 34 48 18 00 86 00 1e 88 43 1a 79 ee 62 ee 6e 2f 83
         ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4 d2 f5 b5 6d 1f 04 ec e4
         5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d d0 a3 1a 30 18 30 09 06
         03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80
         30 0a 06 08 2a 86 48 ce 3d 04 03 02 03 48 00 30 45 02 21 00 df
         30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4 79 ca 69 3f ee ca 3b 71
         b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62 e2 a4 72 50 d3 20 fe a8
         3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db d1 3f ee 94 6e 51 3e 01
         1d 11 00 00 0f 00 00 4b 04 03 00 47 30 45 02 21 00 87 a0 61 13
         56 79 77 66 cc c3 aa 50 c6 bf cb eb 39 fc 98 ab a1 bc 3a 02 59
         8e 6e 02 1c 12 4e c6 02 20 3e 86 29 b5 a8 ff 09 af ff 16 05 72
         88 ca ee 59 2a bd f0 5e b5 8c b3 86 ed 25 ae ca 6f 20 70 a1 14



Thomson                 Expires November 9, 2018               [Page 42]

Internet-Draft               TLS 1.3 Traces                     May 2018


         00 00 20 e2 ca c1 76 50 fa 8a e5 0e 09 af 16 58 d1 dc ac 10 59
         e9 86 63 51 83 4a 21 1c ed e1 65 83 c1 79

      ciphertext (533 octets):  17 03 03 02 10 3b d7 33 d0 7e 9c e1 c0
         01 dd 0a 50 63 2b d8 96 6e a8 b6 66 78 6c 11 bd ec c7 e5 98 69
         9b 9e 4f 11 ad 0b c4 b8 10 8e f6 8d ec 25 f1 57 29 3a 05 6a 30
         90 e2 ee b7 f4 2f 80 c7 13 a5 cb d2 e1 e7 c5 05 3d bd a6 1a f8
         a5 92 00 3c e2 5e 7b f9 eb 13 50 8a 0d 5b 3d da da 97 fc ab ad
         5c 50 7b 9e e2 3b 81 85 b9 07 4b fc 97 a4 9c 4b 91 ef f9 db 6f
         0a 5e e8 39 f4 59 71 d7 5f 7f fe 8b c4 22 5c 6f 9b de 1d 51 f3
         2f 88 45 3f 4c 66 0a 4d bc 58 1f 81 83 6b 05 62 54 90 15 02 93
         51 be fc 0a 6d ba 04 01 46 33 80 c1 ff 35 50 15 a4 ed b8 07 cd
         ce 1e bf 6f 06 da 8c be fe 21 82 ae 1e 6c 98 6c 65 fc f3 2c fb
         59 a5 3f 7f d8 4e 19 af b4 2b 6f 31 21 d3 4f 76 0b 1c da 9e af
         4c 06 a5 29 11 44 62 c0 8a 69 44 07 33 f6 3c ce f0 4f ef 4e b8
         03 21 28 59 b6 36 18 ed 8d 6c ea e6 ae 12 f0 51 81 e4 08 d2 0b
         28 b8 4d bf d7 3c ed fb fb b1 a6 f5 45 91 8c d5 bb 3b b1 d5 05
         be 72 2b a2 5b ae 6c 03 d9 f7 5f be 35 09 e8 10 30 bc 96 9a 90
         f9 a5 ef f1 c7 e2 0e a4 77 b9 ec 9a 5f da 73 ec c0 3d 76 09 ec
         a5 aa c1 8b 2c 21 a6 e0 67 ab 5a ff b6 b0 28 06 bf 03 48 df a1
         54 91 fc 90 c6 61 c3 75 90 cd e6 33 42 51 ae 41 ed 32 4d 9d 8e
         8e 5e 67 31 58 39 52 ee 4d 16 0c f7 4d 97 52 fb 38 85 44 cc 1f
         c7 33 94 a6 5c b1 ce cb ce e0 64 fd 70 7a 02 06 45 62 af 90 a5
         82 4d fa df 1c dd 56 58 77 42 6c da db c6 5d b4 11 82 9d 40 6e
         44 44 75 59 b8 86 6d dd d9 b0 00 ff 64 7d 72 3e 9c fe 8b 77 dd
         af f3 c3 01 8b 6c 73 56 ce fd 1f ff 5c d8 27 49 dd c5 cd 83 6a
         eb 29 cd 35 87 95 06 42 be 68 f9 a3 30 9c 83 d1 e5 6c d1 7e 8e
         7b de 52 45 79 37 a4 f7 ae 23 de 59 d5 c5 fd a3 44 75 8a 83 11
         ca 97 d4 53 97 4d c9 2e 35 4c f5 f3 2a 6d bd 77

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  ad 01 3f b2 67 50 37 1f b0 4c ce b4 8b 1a 3d cc
         73 0a fd 8a 9e 3e 1a e9 a2 78 6a f8 06 e1 0a 96

      hash (32 octets):  4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67 ce
         3d 55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67
         ce 3d 55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      output (32 octets):  2d 89 87 13 c4 ec 3e 37 f0 e7 df c4 cf 4d 5a
         98 ea 87 d4 1c bd 12 ea 72 5f b0 1a b4 49 ec 77 59

   {server}  derive secret "tls13 s ap traffic":





Thomson                 Expires November 9, 2018               [Page 43]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  ad 01 3f b2 67 50 37 1f b0 4c ce b4 8b 1a 3d cc
         73 0a fd 8a 9e 3e 1a e9 a2 78 6a f8 06 e1 0a 96

      hash (32 octets):  4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67 ce
         3d 55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67
         ce 3d 55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      output (32 octets):  e5 f8 a8 f0 8b 06 02 91 b1 d1 8a b3 7b 19 03
         39 d3 b6 d1 25 aa 70 ee 8c b5 1e b7 3c 2d 2f 3f 12

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  ad 01 3f b2 67 50 37 1f b0 4c ce b4 8b 1a 3d cc
         73 0a fd 8a 9e 3e 1a e9 a2 78 6a f8 06 e1 0a 96

      hash (32 octets):  4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67 ce
         3d 55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 4b e0 dc 3f 6e 12 17 41 70 3c d1 10 d4 63 67 ce 3d
         55 a6 4d 48 fc 68 8a b9 f5 fa ec 86 c9 70 d0

      output (32 octets):  69 01 41 d4 a9 f7 5c bf df b2 ec f6 a4 9d 64
         f5 87 72 2c 8a ec 1a 1d 89 e5 b6 c3 75 1c e9 ef 2f

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  e5 f8 a8 f0 8b 06 02 91 b1 d1 8a b3 7b 19 03 39
         d3 b6 d1 25 aa 70 ee 8c b5 1e b7 3c 2d 2f 3f 12

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  a5 c7 84 04 db 8a 93 10 c7 69 05 1c 75 af
         de 9b

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  57 f7 51 58 c1 8c 1a 46 f5 d6 1b ed

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  3b 8b 48 1c 2c c3 80 46 79 a0 27 43 a1 3f 48 58
         98 33 04 cd 73 a4 d6 c2 85 04 78 b1 02 4d 02 1d

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00



Thomson                 Expires November 9, 2018               [Page 44]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  33 73 ea a5 e3 2b 09 c7 42 24 56 19 e3 dc
         45 f1

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  36 22 21 57 55 c9 17 3f 4e 36 16 a0

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  3a 09 65 1f 90 f7 64 4b 9b 88 28 8f a6 ac ab 1f
         52 a2 7d 14 ce 69 48 6a 77 a7 4d 3a 79 78 b7 6a

      secret (32 octets):  e2 f6 91 f0 0f 56 47 bf 83 3c 67 ca 1f b2 c1
         ed db 65 89 0a 2b 5a 9a c3 a0 64 79 7b be 15 0a 44

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)



Thomson                 Expires November 9, 2018               [Page 45]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  27 ef 4c 28 b7 23 f0 9e e4 b1 32 9a 88 c8 65 e4
         ad 6d 6c 1f 01 da 89 a2 d5 39 d3 5b 40 35 56 01

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  ff f1 1e de 07 b8 42 cd 77 9f b3 66 d8 f3
         7c 72

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  71 b1 b3 ac d7 cd 1d 94 b6 b9 3b 51

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  send a Certificate handshake message

   {client}  send a CertificateVerify handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  3b 8b 48 1c 2c c3 80 46 79 a0 27 43 a1 3f 48 58
         98 33 04 cd 73 a4 d6 c2 85 04 78 b1 02 4d 02 1d

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  e0 89 b7 e1 9d 2e 76 d9 f7 fb b1 ae 78 d5 f2
         79 71 25 d1 71 6d 8e c5 a3 7e da 3f 42 6f 3d 39 51

   {client}  send a Finished handshake message



Thomson                 Expires November 9, 2018               [Page 46]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  send handshake record:

      payload (623 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82 01
         b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86
         f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06 63
         6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39
         5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f 30
         0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06 09
         2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81
         00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7 a1
         c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81 e5
         22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f f1
         90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97 1c
         7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7 fe
         9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7 e0
         28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02
         30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a 86
         48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0 22
         af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91 6d
         c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80 be
         2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e f0
         c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2 17
         bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac 0f
         78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00 0f 00 00 84
         08 04 00 80 12 66 15 3b e9 34 48 cc 4b d5 99 33 e4 c8 40 8c dd
         6c 7c d8 0f b6 39 0e 29 ae dc 59 17 48 48 f9 5a 0e 42 d5 0e b2
         de 1c 24 a1 29 31 42 0e cd 4d 35 b4 83 40 72 bf ef d6 ca c4 10
         ba 11 26 05 f8 76 48 a1 65 92 c2 0a 85 bb a9 2a 23 1b e3 0b 19
         b9 ca 30 de 01 da c3 ff bf 99 8e 82 78 e2 e7 d8 47 52 9a c5 56
         5e f9 af 9f 27 4b ca f6 d7 e5 c2 74 7b dc 41 6c a6 a6 4a 44 14
         32 f3 60 27 f1 9f 14 00 00 20 94 f6 71 23 03 b6 43 a3 62 7b ef
         21 9e ea f6 8c 6b 78 34 c0 92 62 60 9b 44 e4 07 e0 43 3a f0 58

      ciphertext (645 octets):  17 03 03 02 80 05 d3 c7 2f 3c 34 56 6c
         09 93 f8 31 2e fb 4d b3 7f e8 ba 05 2b 7b 16 28 2a 65 bc bf b5
         10 2c 1e 0f 26 3f 90 dd 28 0b 8b 7a 5a fc 4d 29 23 6b 28 6a ab
         00 2e 34 36 08 1f 48 c9 64 ee 05 39 d7 bd ef c7 78 df f0 4f 7d
         77 1a 3a f2 37 30 b3 d9 c4 7f 0c 82 9f 03 0d cd 75 d7 ee a8 61
         56 e6 16 d4 f6 bb 16 0f fa 1b 4c f3 40 36 cc af f9 fe d0 bd 34
         c1 23 5d 92 fe 6b 10 fe 1c f1 84 45 3d 00 13 b3 23 64 e1 a3 4e
         d4 69 aa b5 f2 e5 48 8f 5e 53 37 69 dd e3 95 d1 06 90 51 7f fb
         b3 91 cc 62 6e 84 3b 68 0e 1c c4 44 0b df df b7 0e 7d 88 d2 01
         b4 40 b1 96 b4 82 e5 bc a7 32 a9 30 69 08 45 74 53 56 d1 df 44
         a1 c5 3f 10 ad 76 3a be 71 28 15 e5 42 39 da a7 74 75 7f ee 76
         f0 ac 15 15 ea ed 44 e7 25 a8 d0 48 2f 77 a8 dd a0 f8 19 58 86
         6e 73 3d 3b 83 bc e6 31 72 8f 2e a3 de 12 d5 68 5a b0 e1 7b 30
         7f bd b4 1e 21 8c 1c 1e 75 f7 7a 8d c6 12 45 9d af f0 a6 82 d6
         30 89 0d 5c c2 b5 93 72 fa 9c 70 01 4d c0 88 ab ca a2 40 1a ad



Thomson                 Expires November 9, 2018               [Page 47]

Internet-Draft               TLS 1.3 Traces                     May 2018


         77 52 20 cb 56 9f 43 71 13 f8 3b 61 17 a1 8b ee 06 1b 4c da e8
         6a db ac 19 97 79 01 e0 bf 75 9d fb 9b 86 04 ec 4f 4a c6 ba ac
         58 65 45 96 ea 5f 91 22 ac 9d 0e 49 58 9d cc fe dd 0f ee 0d e8
         26 84 3e a6 bd c4 d4 89 dd 81 50 c2 5c 29 32 3f 36 db c8 34 99
         8a f1 c4 65 9e e3 48 e9 12 f2 9d 3d 58 9b 57 64 23 b3 fd e5 c3
         3a 40 b3 f3 54 c1 4d f8 45 95 3b 46 c2 e5 3d 64 dc 78 f0 cf 93
         cd 81 75 01 d2 5d 46 0f c6 2b 98 7a 17 aa 5a 5c bf f3 7c f7 0f
         be 49 29 62 f0 01 de 94 d0 cb 2e 38 f1 87 76 31 51 35 fc 72 e2
         62 50 b4 72 2d b6 7d b5 d2 ef 1c ca 40 4b ad f7 90 92 d0 28 98
         3d a2 c3 6f f6 e4 e9 90 68 b5 f2 1f d5 f8 f3 f2 92 dc b5 a1 dc
         e7 27 5a 66 7b 01 d7 a1 69 fa c1 25 e7 d2 79 57 91 b0 67 e3 08
         6f d2 7f 34 21 f8 69 b6 f5 e4 43 ac 4a e6 d2 de 35 b5 4e 2e ed
         7f 80 c8 cb 57 83 ba eb c9 79 91 1b 4a e1 86 10 51 55 21 f0 e7
         0a 6e ee 89 f5 63 7e f3 43 0a 10 c0 7d 8b 7c 34 cc 5c 45 77 7a
         0c 30 b4 d2 5d ca 49 e8 95 66 a8 92 cb a8 07 0d 95 5d d9 6a 1f
         0a 22 05 25 0f 67 1f d7 aa 2b 6c de cb a9 ec a7 f5 05 2a 24 1a
         d3 a6

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  2d 89 87 13 c4 ec 3e 37 f0 e7 df c4 cf 4d 5a 98
         ea 87 d4 1c bd 12 ea 72 5f b0 1a b4 49 ec 77 59

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  8c 60 05 e5 92 bc 3e 2a 40 be 66 99 0b 68
         b7 c4

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  6d 3e 58 b8 ec 9d 99 f2 7c df 7d b6

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  ad 01 3f b2 67 50 37 1f b0 4c ce b4 8b 1a 3d cc
         73 0a fd 8a 9e 3e 1a e9 a2 78 6a f8 06 e1 0a 96

      hash (32 octets):  a7 03 cb 69 b1 fe 40 88 f9 22 8f 25 71 50 3c 42
         fd f8 f3 ab 11 93 8e b4 a6 71 3d cc b9 5b 26 24

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 a7 03 cb 69 b1 fe 40 88 f9 22 8f 25 71 50 3c 42 fd
         f8 f3 ab 11 93 8e b4 a6 71 3d cc b9 5b 26 24

      output (32 octets):  66 ff ea 98 02 5f fb d1 c1 a6 65 87 4e 35 f7
         7b 2a 06 b9 f9 cb 38 3c 33 32 71 20 70 91 58 10 28

   {server}  calculate finished "tls13 finished" (same as client)



Thomson                 Expires November 9, 2018               [Page 48]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 40 be e4 fc d7 b2 84 af 5f
         a9 c3 d9 60 91 1e 02 db c2 2b

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 89 1d 85 12 81 26 1b 82 7a
         d6 1b 2e 49 fd 07 f7 56 05 f8

7.  Compatibility Mode

   This example shows use of the handshake with the client requesting
   that the server use compatibility mode as defined in Appendix D.4 of
   [TLS13].

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  8f 6b 8f c8 a7 59 de d5 4d cb 0f c5 0d
         9c 63 4b f4 9b bf 68 99 b2 94 2d 6b 31 ea 0f b3 88 2e 8e

      public key (32 octets):  66 28 a6 a2 e3 71 d1 47 c8 06 4f 27 0e 2e
         44 c1 b9 8c c5 e1 cf 10 ad 76 bb 64 d4 8d 48 65 da 12

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (218 octets):  01 00 00 d6 03 03 45 46 bb b0 04 1b fe b1
         b5 b4 58 43 41 ea 8e 11 35 ef c5 e4 1e e0 86 aa d3 4b 58 27 b8
         41 19 c9 20 9f e5 a0 50 54 6f 6d 1e d3 87 df 22 63 4d db ec 21
         10 d5 b9 d7 b7 3d e7 ba 05 5d 84 3c 7d 96 5f 00 06 13 01 13 03
         13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72
         ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00
         01 01 01 02 01 03 01 04 00 33 00 26 00 24 00 1d 00 20 66 28 a6
         a2 e3 71 d1 47 c8 06 4f 27 0e 2e 44 c1 b9 8c c5 e1 cf 10 ad 76
         bb 64 d4 8d 48 65 da 12 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01



Thomson                 Expires November 9, 2018               [Page 49]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (223 octets):  16 03 01 00 da 01 00 00 d6 03 03 45 46
         bb b0 04 1b fe b1 b5 b4 58 43 41 ea 8e 11 35 ef c5 e4 1e e0 86
         aa d3 4b 58 27 b8 41 19 c9 20 9f e5 a0 50 54 6f 6d 1e d3 87 df
         22 63 4d db ec 21 10 d5 b9 d7 b7 3d e7 ba 05 5d 84 3c 7d 96 5f
         00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06
         73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17
         00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00 26 00 24 00
         1d 00 20 66 28 a6 a2 e3 71 d1 47 c8 06 4f 27 0e 2e 44 c1 b9 8c
         c5 e1 cf 10 ad 76 bb 64 d4 8d 48 65 da 12 00 2b 00 03 02 7f 1c
         00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04
         01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  0e 6c 07 4a d7 f5 0a 4d cb 57 a4 2e 09
         96 5f 01 07 e4 44 72 84 90 56 3b 6f 5b 86 3d 49 19 da eb

      public key (32 octets):  1b d6 ab af 01 d1 8a e5 b3 32 cc 7f 73 b3
         a1 ad fa 06 dd a0 7b c0 ed 7e 89 b1 3b b8 dd 46 63 31

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (122 octets):  02 00 00 76 03 03 49 38 39 04 ae 77 af 8d
         cc bd 98 39 54 a5 49 eb 01 76 8b d1 e0 bd 8e 63 2d db 3b c3 26
         9d 9f b4 20 9f e5 a0 50 54 6f 6d 1e d3 87 df 22 63 4d db ec 21
         10 d5 b9 d7 b7 3d e7 ba 05 5d 84 3c 7d 96 5f 13 01 00 00 2e 00
         33 00 24 00 1d 00 20 1b d6 ab af 01 d1 8a e5 b3 32 cc 7f 73 b3
         a1 ad fa 06 dd a0 7b c0 ed 7e 89 b1 3b b8 dd 46 63 31 00 2b 00
         02 7f 1c

      ciphertext (127 octets):  16 03 03 00 7a 02 00 00 76 03 03 49 38
         39 04 ae 77 af 8d cc bd 98 39 54 a5 49 eb 01 76 8b d1 e0 bd 8e
         63 2d db 3b c3 26 9d 9f b4 20 9f e5 a0 50 54 6f 6d 1e d3 87 df
         22 63 4d db ec 21 10 d5 b9 d7 b7 3d e7 ba 05 5d 84 3c 7d 96 5f
         13 01 00 00 2e 00 33 00 24 00 1d 00 20 1b d6 ab af 01 d1 8a e5




Thomson                 Expires November 9, 2018               [Page 50]

Internet-Draft               TLS 1.3 Traces                     May 2018


         b3 32 cc 7f 73 b3 a1 ad fa 06 dd a0 7b c0 ed 7e 89 b1 3b b8 dd
         46 63 31 00 2b 00 02 7f 1c

   {server}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  e5 c9 8e 88 7f 31 e1 a9 84 e8 f6 36 f0 50 04 1e
         b9 64 e0 39 6a 73 4e 5e 51 a9 3e 4b 29 e5 5b 5b

      secret (32 octets):  9c dd 8b 0f 57 66 39 d7 0f e3 dc c3 9f 11 5f
         91 d7 6d 03 10 e6 a8 96 cd 19 7a f0 86 8e b4 0f 8a

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  9c dd 8b 0f 57 66 39 d7 0f e3 dc c3 9f 11 5f 91
         d7 6d 03 10 e6 a8 96 cd 19 7a f0 86 8e b4 0f 8a

      hash (32 octets):  af 6a 62 20 24 51 24 70 fb 9b ed d0 18 98 32 51
         34 a6 e0 62 98 9b 5e 32 26 44 34 fb 3f 3a 81 82

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 af 6a 62 20 24 51 24 70 fb 9b ed d0 18 98 32
         51 34 a6 e0 62 98 9b 5e 32 26 44 34 fb 3f 3a 81 82





Thomson                 Expires November 9, 2018               [Page 51]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  f7 cb 20 2e 83 76 71 55 07 ea 58 9b 67 17 b2
         2a 34 33 62 90 04 0e c2 6a 3e 83 61 c0 c2 5a d6 c6

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  9c dd 8b 0f 57 66 39 d7 0f e3 dc c3 9f 11 5f 91
         d7 6d 03 10 e6 a8 96 cd 19 7a f0 86 8e b4 0f 8a

      hash (32 octets):  af 6a 62 20 24 51 24 70 fb 9b ed d0 18 98 32 51
         34 a6 e0 62 98 9b 5e 32 26 44 34 fb 3f 3a 81 82

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 af 6a 62 20 24 51 24 70 fb 9b ed d0 18 98 32
         51 34 a6 e0 62 98 9b 5e 32 26 44 34 fb 3f 3a 81 82

      output (32 octets):  84 11 1e 05 de a7 a1 2a 47 ce ce c9 02 77 4d
         6d f3 29 a2 58 bd ab 6d 15 1b 11 d8 ae 82 13 ad b8

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  9c dd 8b 0f 57 66 39 d7 0f e3 dc c3 9f 11 5f 91
         d7 6d 03 10 e6 a8 96 cd 19 7a f0 86 8e b4 0f 8a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  4d d3 92 3c e6 17 fa 80 14 86 b8 a0 20 94 33
         5a a0 29 ce 9b 85 d2 5f 81 a3 88 5e f6 a5 8d 8c 25

   {server}  extract secret "master":

      salt (32 octets):  4d d3 92 3c e6 17 fa 80 14 86 b8 a0 20 94 33 5a
         a0 29 ce 9b 85 d2 5f 81 a3 88 5e f6 a5 8d 8c 25

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  53 0a bd ff 91 46 43 5c 0a 97 db d7 39 14 c5
         99 11 17 4e fb 1f 6a 45 53 70 d1 a1 c1 71 0a 0f 57

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  84 11 1e 05 de a7 a1 2a 47 ce ce c9 02 77 4d 6d
         f3 29 a2 58 bd ab 6d 15 1b 11 d8 ae 82 13 ad b8



Thomson                 Expires November 9, 2018               [Page 52]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  98 c7 0e a3 e2 8a 44 2c ef ad 01 99 09 d9
         61 31

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  04 a7 27 94 c1 5c 6e 56 ff 06 0e 44

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  84 11 1e 05 de a7 a1 2a 47 ce ce c9 02 77 4d 6d
         f3 29 a2 58 bd ab 6d 15 1b 11 d8 ae 82 13 ad b8

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  b0 d2 47 f3 0c a0 20 11 69 83 49 1d bd 41 da
         4a 52 85 c1 0b 84 47 b5 62 38 05 e4 c2 71 1f 07 2f

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05



Thomson                 Expires November 9, 2018               [Page 53]

Internet-Draft               TLS 1.3 Traces                     May 2018


         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d
         e1 00 00 0f 00 00 84 08 04 00 80 8d ce a5 cc 2a 71 ac 1c fd a3
         6c fd 49 2a 3b 77 9f e9 30 e0 cd 1e 30 84 c7 0e dd 7e dc 80 41
         bd 6e 83 ff 2f 7a 45 08 80 95 35 91 6a bc f7 9a f2 8a 32 38 77
         75 6a 9e 4d 78 99 11 aa 46 03 ab ea 96 65 33 18 b3 04 35 dc 51
         e9 b8 62 3f 4b 7b e0 3d bd 86 d9 c7 ae db a9 03 6e 6b a8 21 d8
         91 fb 6b 54 ce 35 97 2c f3 54 15 b7 a4 f2 70 95 b8 bc ff f0 ea
         d2 33 96 05 1b a0 5f 17 78 1b 7c c2 46 14 00 00 20 27 b0 cd 24
         7c fa 09 76 7e 87 6a f0 28 4f e2 83 8c a7 62 a9 0d d5 dd aa 6e
         3d ad 65 ba b7 b4 3f

      ciphertext (673 octets):  17 03 03 02 9c 91 61 3f 33 79 a3 6b 64
         63 15 d1 59 e6 5f be 6d a8 6d ca 9d a1 60 57 fc 5d 05 6b be d7
         48 d4 c8 1d de 27 b2 79 40 3a b7 62 0d 19 f1 20 82 20 eb 29 0e
         e8 10 9b ea e4 40 c3 9d f7 f1 72 71 8e cc c6 1d c3 41 48 63 9b
         c3 a7 a5 96 c9 f2 3c f5 10 05 60 63 37 29 dc 53 25 ad 32 44 9e
         08 ae e5 e0 ae 06 28 51 5a 74 61 10 23 4b d1 a5 5e d2 a0 b0 a0
         ee f3 fc f5 cf d6 59 10 60 0e ad 51 11 53 68 be c5 15 10 98 3a
         f7 c7 0d 93 d4 2b 67 10 7d cb ff 46 ec 6b 9d 5f 94 a2 55 ce a9
         7b d5 1f a8 bf 1b 31 7c f6 e6 e7 aa d2 e0 be 29 8e 9b fb 17 96
         65 30 1f ae 9e 47 80 0a 00 ae c2 02 54 24 8a 53 47 ba ce 12 7b
         ea 53 aa fd d0 4a 00 4a b4 29 cc c5 0d 59 1d 6d 53 75 e4 22 97
         f9 7a 73 dc da be 82 47 ba c6 6f b6 67 99 d0 06 65 ea 60 13 09
         56 22 7e be dc aa be d3 47 0e cc a9 7f b2 43 44 9e f1 0f 3e c9
         90 c8 eb 98 fb e0 2b 81 7b e8 66 75 03 6f 2c 84 2f 12 2c 94 98
         73 65 ee 3f ab 4a 22 61 0f 94 4f 0c a8 0f 15 3e f6 55 e7 c2 f6
         68 d6 63 c5 c3 d8 9d f4 39 70 48 75 01 32 87 ba 60 55 b2 90 89
         7b 07 f7 8c ba 14 59 29 31 72 19 82 37 0e 8a 00 c5 39 45 36 8a
         a6 15 be 31 fc f0 58 5d a2 ce 89 7a c6 b9 53 6c e1 04 40 9c e8
         49 2c 1f b8 60 dd 7a 3a 8d be 6c 87 03 6a ae 1d 01 89 63 47 1b
         1b 9c 0e 56 40 08 b4 29 56 12 b5 4c 4e b8 d5 3e b9 27 8c 40 12
         77 5f 39 08 b0 fa d2 90 70 f3 be 8a e3 a6 dc cf e6 8f 47 34 c3
         19 43 42 c4 ef 77 52 fd 41 26 29 19 11 d9 dd 79 08 8e 1c 0b 25
         df ba 2b 27 89 d6 54 c2 dc 6c ff 66 a1 3f 5a 34 c4 b5 e0 a3 a3
         fe 30 a2 5b 1f 41 a8 79 63 4e 7e 56 43 e2 6d 18 31 aa 8d 0a f7
         ce a9 ea 13 cd 2a 61 48 9b d5 c7 a3 3d 2c 5e 81 af 22 db 56 c3
         cd ae 8f 05 6a 25 d3 30 cf c9 e4 da 2e f7 34 e4 c2 e3 19 6b 5d
         8d 69 d8 de 53 57 22 91 cb 16 4c 78 e0 4c 97 cf 0c 27 49 62 66
         54 f8 58 f4 84 1c 48 54 4f c4 e9 d9 c9 e9 a9 de d4 1c 44 d1 93
         de 1e 11 f6 1c a8 d8 8c b1 08 f5 75 a4 46 72 92 dc 05 ab 0b d7
         b8 22 d6 06 3a e1 6c 1b a0 f4 e8 f4 6d 72 16 e3 9a 1a 9f 29 65
         bb 92 d4 21 3e a5 92 87 b3 6e 91 f4 ac dd 46 5d 1c d7 32 a9 d7



Thomson                 Expires November 9, 2018               [Page 54]

Internet-Draft               TLS 1.3 Traces                     May 2018


         92 ac 5d 03 09 a5 e4 83 eb 37 74 0e 3f 07 ef 44 29 53 ec 37 c4
         f2 b5 c3 46 0d ab 0f 36 7f

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  53 0a bd ff 91 46 43 5c 0a 97 db d7 39 14 c5 99
         11 17 4e fb 1f 6a 45 53 70 d1 a1 c1 71 0a 0f 57

      hash (32 octets):  1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1 02
         6b 82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1
         02 6b 82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      output (32 octets):  b6 11 e6 d7 96 7d 5f 7b bb 0d 04 c6 8d c2 4f
         e8 4f ff 6a 70 84 dc 25 00 4a ed ac bd 33 2d 48 11

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  53 0a bd ff 91 46 43 5c 0a 97 db d7 39 14 c5 99
         11 17 4e fb 1f 6a 45 53 70 d1 a1 c1 71 0a 0f 57

      hash (32 octets):  1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1 02
         6b 82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1
         02 6b 82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      output (32 octets):  cb 5a 62 a2 7e ab 51 94 e0 03 40 65 71 8d 5c
         68 33 91 be 60 af 5c 0f ea db d1 dc 86 e9 52 e6 17

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  53 0a bd ff 91 46 43 5c 0a 97 db d7 39 14 c5 99
         11 17 4e fb 1f 6a 45 53 70 d1 a1 c1 71 0a 0f 57

      hash (32 octets):  1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1 02
         6b 82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 1a b9 b6 04 f5 94 f3 98 7b a3 4d 4e 68 b9 c1 02 6b
         82 0b 77 c1 32 a8 3b 1e 93 41 30 a8 73 0a 17

      output (32 octets):  d5 9e 99 95 e9 47 cb 77 70 c3 17 85 ee 58 49
         be 75 3c d1 b9 ac e9 92 2e 5a cc 8e 08 e8 05 97 4c




Thomson                 Expires November 9, 2018               [Page 55]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  cb 5a 62 a2 7e ab 51 94 e0 03 40 65 71 8d 5c 68
         33 91 be 60 af 5c 0f ea db d1 dc 86 e9 52 e6 17

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  08 7b 42 45 a5 08 b9 5d df e0 fa 70 66 57
         34 ec

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  aa 94 c5 ad e0 37 c2 6f d1 9d 4f 5f

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  f7 cb 20 2e 83 76 71 55 07 ea 58 9b 67 17 b2 2a
         34 33 62 90 04 0e c2 6a 3e 83 61 c0 c2 5a d6 c6

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  88 a1 2f 57 8e a3 3c 89 c0 48 22 a5 e4 07
         21 b0

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  73 09 7f db 20 32 2f ae cb fa 26 1a

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55






Thomson                 Expires November 9, 2018               [Page 56]

Internet-Draft               TLS 1.3 Traces                     May 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  e5 c9 8e 88 7f 31 e1 a9 84 e8 f6 36 f0 50 04 1e
         b9 64 e0 39 6a 73 4e 5e 51 a9 3e 4b 29 e5 5b 5b

      secret (32 octets):  9c dd 8b 0f 57 66 39 d7 0f e3 dc c3 9f 11 5f
         91 d7 6d 03 10 e6 a8 96 cd 19 7a f0 86 8e b4 0f 8a

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  84 11 1e 05 de a7 a1 2a 47 ce ce c9 02 77 4d 6d
         f3 29 a2 58 bd ab 6d 15 1b 11 d8 ae 82 13 ad b8

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  98 c7 0e a3 e2 8a 44 2c ef ad 01 99 09 d9
         61 31

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  04 a7 27 94 c1 5c 6e 56 ff 06 0e 44

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires November 9, 2018               [Page 57]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  f7 cb 20 2e 83 76 71 55 07 ea 58 9b 67 17 b2 2a
         34 33 62 90 04 0e c2 6a 3e 83 61 c0 c2 5a d6 c6

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  2f 9d 64 b5 7e 06 41 34 49 d6 1a 24 49 42 74
         1b 06 a7 aa b5 d9 42 fb 29 34 96 ab b8 d1 a5 4f ef

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 35 ad 6b 81 ff 2c e5 2c 8a 2c 66
         3c a8 99 c9 9a 58 a3 e3 96 44 c9 b1 ef cf 3d ee bf 5c e7 27 cc

      ciphertext (58 octets):  17 03 03 00 35 db 58 27 83 02 f0 f9 79 89
         d9 c8 82 92 24 85 a2 a2 a5 d2 18 38 14 d7 88 9a 8b 59 70 ba 17
         81 af ac a9 85 ea 40 3d 57 ab 92 05 f0 d2 75 0c 4b 07 29 e9 57
         f2 64

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  b6 11 e6 d7 96 7d 5f 7b bb 0d 04 c6 8d c2 4f e8
         4f ff 6a 70 84 dc 25 00 4a ed ac bd 33 2d 48 11

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  bb 5e 2b a4 5b 94 2d 6f 3d 65 99 92 b5 a8
         20 08

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00



Thomson                 Expires November 9, 2018               [Page 58]

Internet-Draft               TLS 1.3 Traces                     May 2018


      iv output (12 octets):  eb c4 27 36 be 1d 59 b5 ef f1 e6 43

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  53 0a bd ff 91 46 43 5c 0a 97 db d7 39 14 c5 99
         11 17 4e fb 1f 6a 45 53 70 d1 a1 c1 71 0a 0f 57

      hash (32 octets):  03 d4 96 d4 31 3d ba 1b f1 f5 04 b7 2d e2 1f eb
         79 07 5c e6 3e 3f 0c 1b 11 e4 70 48 0b ec e1 ce

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 03 d4 96 d4 31 3d ba 1b f1 f5 04 b7 2d e2 1f eb 79
         07 5c e6 3e 3f 0c 1b 11 e4 70 48 0b ec e1 ce

      output (32 octets):  11 2f 16 0f 26 84 67 b1 fa 78 e3 44 38 f8 ee
         2c fb 2f 31 bd 3d c5 9d 3b 1c 68 ab 03 1d 3d a7 f7

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 4c 1b 6e 12 75 58 d4 1f 52
         b7 e6 25 fb d5 2f 49 b2 52 f8

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 6a c7 e0 3c aa ae 22 da a0
         33 18 7e 65 35 91 7f 01 dd 65

8.  Security Considerations

   It probably isn't a good idea to use the private key here.  If it
   weren't for the fact that it is too small to provide any meaningful
   security, it is now very well known.








Thomson                 Expires November 9, 2018               [Page 59]

Internet-Draft               TLS 1.3 Traces                     May 2018


9.  IANA Considerations

   This document makes no requests of IANA.

10.  References

10.1.  Normative References

   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-21 (work in progress),
              July 2017.

10.2.  Informative References

   [FIPS186]  National Institute of Standards and Technology (NIST),
              "Digital Signature Standard (DSS)", NIST PUB 186-4 , July
              2013.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

10.3.  URIs

   [1] https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS

Appendix A.  Acknowledgements

   This draft is generated using tests that were written for NSS [1].
   None of this would have been possible without Franziskus Kiefer, Eric
   Rescorla and Tim Taubert, who did a lot of the work in NSS.

Author's Address

   Martin Thomson
   Mozilla

   Email: martin.thomson@gmail.com













Thomson                 Expires November 9, 2018               [Page 60]
