



TLS                                                           M. Thomson
Internet-Draft                                                   Mozilla
Intended status: Informational                              May 30, 2018
Expires: December 1, 2018


                  Example Handshake Traces for TLS 1.3
                  draft-ietf-tls-tls13-vectors-latest

Abstract

   Examples of TLS 1.3 handshakes are shown.  Private keys and inputs
   are provided so that these handshakes might be reproduced.
   Intermediate values, including secrets, traffic keys and ivs are
   shown so that implementations might be checked incrementally against
   these values.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 1, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Thomson                 Expires December 1, 2018                [Page 1]

Internet-Draft               TLS 1.3 Traces                     May 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Private Keys  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Simple 1-RTT Handshake  . . . . . . . . . . . . . . . . . . .   3
   4.  Resumed 0-RTT Handshake . . . . . . . . . . . . . . . . . . .  15
   5.  HelloRetryRequest . . . . . . . . . . . . . . . . . . . . . .  26
   6.  Client Authentication . . . . . . . . . . . . . . . . . . . .  38
   7.  Compatibility Mode  . . . . . . . . . . . . . . . . . . . . .  49
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  59
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  60
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  60
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  60
     10.2.  Informative References . . . . . . . . . . . . . . . . .  60
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .  60
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  60

1.  Introduction

   TLS 1.3 [TLS13] defines a new key schedule and a number new
   cryptographic operations.  This document includes sample handshakes
   that show all intermediate values.  This allows an implementation to
   be verified incrementally, examining inputs and outputs of each
   cryptographic computation independently.

   A private key is included with the traces so that implementations can
   be checked by importing these values and verifying that the same
   outputs are produced.

2.  Private Keys

   Ephemeral private keys are shown as they are generated in the traces.

   The server in most examples uses an RSA certificate with a private
   key of:

   modulus (public):  b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c
      0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab
      bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
      a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f
      da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0
      3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e
      3f

   public exponent:  01 00 01

   private exponent:  04 de a7 05 d4 3a 6e a7 20 9d d8 07 21 11 a8 3c 81
      e3 22 a5 92 78 b3 34 80 64 1e af 7c 0a 69 85 b8 e3 1c 44 f6 de 62



Thomson                 Expires December 1, 2018                [Page 2]

Internet-Draft               TLS 1.3 Traces                     May 2018


      e1 b4 c2 30 9f 61 26 e7 7b 7c 41 e9 23 31 4b bf a3 88 13 05 dc 12
      17 f1 6c 81 9c e5 38 e9 22 f3 69 82 8d 0e 57 19 5d 8c 84 88 46 02
      07 b2 fa a7 26 bc f7 08 bb d7 db 7f 67 9f 89 34 92 fc 2a 62 2e 08
      97 0a ac 44 1c e4 e0 c3 08 8d f2 5a e6 79 23 3d f8 a3 bd a2 ff 99
      41

   prime1:  e4 35 fb 7c c8 37 37 75 6d ac ea 96 ab 7f 59 a2 cc 10 69 db
      7d eb 19 0e 17 e3 3a 53 2b 27 3f 30 a3 27 aa 0a aa bc 58 cd 67 46
      6a f9 84 5f ad c6 75 fe 09 4a f9 2c 4b d1 f2 c1 bc 33 dd 2e 05 15

   prime2:  ca bd 3b c0 e0 43 86 64 c8 d4 cc 9f 99 97 7a 94 d9 bb fe ad
      8e 43 87 0a ba e3 f7 eb 8b 4e 0e ee 8a f1 d9 b4 71 9b a6 19 6c f2
      cb ba ee eb f8 b3 49 0a fe 9e 9f fa 74 a8 8a a5 1f c6 45 62 93 03

   exponent1:  3f 57 34 5c 27 fe 1b 68 7e 6e 76 16 27 b7 8b 1b 82 64 33
      dd 76 0f a0 be a6 a6 ac f3 94 90 aa 1b 47 cd a4 86 9d 68 f5 84 dd
      5b 50 29 bd 32 09 3b 82 58 66 1f e7 15 02 5e 5d 70 a4 5a 08 d3 d3
      19

   exponent2:  18 3d a0 13 63 bd 2f 28 85 ca cb dc 99 64 bf 47 64 f1 51
      76 36 f8 64 01 28 6f 71 89 3c 52 cc fe 40 a6 c2 3d 0d 08 6b 47 c6
      fb 10 d8 fd 10 41 e0 4d ef 7e 9a 40 ce 95 7c 41 77 94 e1 04 12 d1
      39

   coefficient:  83 9c a9 a0 85 e4 28 6b 2c 90 e4 66 99 7a 2c 68 1f 21
      33 9a a3 47 78 14 e4 de c1 18 33 05 0e d5 0d d1 3c c0 38 04 8a 43
      c5 9b 2a cc 41 68 89 c0 37 66 5f e5 af a6 05 96 9f 8c 01 df a5 ca
      96 9d

3.  Simple 1-RTT Handshake

   In this example, the simplest possible handshake is completed.  The
   server is authenticated, but the client remains anonymous.  After
   connecting, a few application data octets are exchanged.  The server
   sends a session ticket that permits the use of 0-RTT in any resumed
   session.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  0e 11 d6 8d 0d 69 22 19 74 ea a9 34 3b
         9e 9f 84 4e bc d8 94 8c d8 41 ab a4 2e fd 7f 7f 0b 67 f5

      public key (32 octets):  fa 82 9d 76 f2 c3 70 e2 8d 9e fc 0b 7f 2b
         5b b8 e1 dd d9 09 63 da 09 2f b3 ea cc ef 9b 44 13 41

   {client}  send a ClientHello handshake message

   {client}  send handshake record:



Thomson                 Expires December 1, 2018                [Page 3]

Internet-Draft               TLS 1.3 Traces                     May 2018


      payload (190 octets):  01 00 00 ba 03 03 16 d8 ef d4 a3 29 9f 5d
         2d da 26 a3 75 4f 16 13 58 d0 f8 f6 34 38 fc fe e8 66 0a 61 d2
         e0 cd de 00 00 06 13 01 13 03 13 02 01 00 00 8b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23 00
         00 00 33 00 26 00 24 00 1d 00 20 fa 82 9d 76 f2 c3 70 e2 8d 9e
         fc 0b 7f 2b 5b b8 e1 dd d9 09 63 da 09 2f b3 ea cc ef 9b 44 13
         41 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01

      ciphertext (195 octets):  16 03 01 00 be 01 00 00 ba 03 03 16 d8
         ef d4 a3 29 9f 5d 2d da 26 a3 75 4f 16 13 58 d0 f8 f6 34 38 fc
         fe e8 66 0a 61 d2 e0 cd de 00 00 06 13 01 13 03 13 02 01 00 00
         8b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 23 00 00 00 33 00 26 00 24 00 1d 00 20 fa 82 9d 76
         f2 c3 70 e2 8d 9e fc 0b 7f 2b 5b b8 e1 dd d9 09 63 da 09 2f b3
         ea cc ef 9b 44 13 41 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  18 5b 4a 64 91 a7 28 ce 76 00 f6 ab 72
         18 c1 01 59 18 18 bb 7f 8d d1 e9 37 d0 f2 af 12 48 f0 ed

      public key (32 octets):  44 b9 86 d8 3c 79 15 3f 1c ac 09 15 12 9c
         e0 df 09 4c 4d 02 92 cc c1 00 61 ee 79 73 0b 61 b4 5c

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a





Thomson                 Expires December 1, 2018                [Page 4]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  a1 59 cb b4 83 d0 71 83 3d c1 32 45 e2 f9 f0 6e
         ba 88 e0 7d 8c 9f 15 69 c0 21 8d 6a 12 48 f5 4f

      secret (32 octets):  ad d6 47 62 88 23 46 7e be 51 c5 57 60 1f bb
         e1 86 90 01 70 e6 89 bb d5 02 fb dc 6b 00 df 09 89

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  ad d6 47 62 88 23 46 7e be 51 c5 57 60 1f bb e1
         86 90 01 70 e6 89 bb d5 02 fb dc 6b 00 df 09 89

      hash (32 octets):  ef a9 6a 42 95 ce 9f c4 1d 18 f9 41 a7 ff 0e 2a
         43 1f ea ce fe 5b 68 de a5 0e d7 b4 b0 69 58 90

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 ef a9 6a 42 95 ce 9f c4 1d 18 f9 41 a7 ff 0e
         2a 43 1f ea ce fe 5b 68 de a5 0e d7 b4 b0 69 58 90

      output (32 octets):  88 31 6e 39 bb 69 9c 6e f9 2a 43 2f d2 cf c5
         51 46 ca fe 79 ec 7f 70 3f 6a fb cb 1f 58 d2 1c 7c

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  ad d6 47 62 88 23 46 7e be 51 c5 57 60 1f bb e1
         86 90 01 70 e6 89 bb d5 02 fb dc 6b 00 df 09 89

      hash (32 octets):  ef a9 6a 42 95 ce 9f c4 1d 18 f9 41 a7 ff 0e 2a
         43 1f ea ce fe 5b 68 de a5 0e d7 b4 b0 69 58 90

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 ef a9 6a 42 95 ce 9f c4 1d 18 f9 41 a7 ff 0e
         2a 43 1f ea ce fe 5b 68 de a5 0e d7 b4 b0 69 58 90




Thomson                 Expires December 1, 2018                [Page 5]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  22 bb 5c 28 77 a5 5a 17 b3 f0 04 8f e5 0f b4
         e6 75 e2 11 54 79 04 2a ed 6b 07 eb a4 66 15 b8 e9

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  ad d6 47 62 88 23 46 7e be 51 c5 57 60 1f bb e1
         86 90 01 70 e6 89 bb d5 02 fb dc 6b 00 df 09 89

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  61 4c 98 33 08 28 a1 f6 bb 10 1b f9 48 ec 23
         e7 51 4e 44 68 a7 54 d6 4c ee 33 df c0 20 9c a0 fe

   {server}  extract secret "master":

      salt (32 octets):  61 4c 98 33 08 28 a1 f6 bb 10 1b f9 48 ec 23 e7
         51 4e 44 68 a7 54 d6 4c ee 33 df c0 20 9c a0 fe

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  b0 0d 51 e2 42 7b dc af 46 ff 1a b7 f9 ca b7
         9a 99 d7 34 32 f5 1f 58 73 93 e2 90 f1 4c 54 2c 03

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 fd de eb e5 c5 9f 90 77 2b
         b1 0f a9 2e a3 64 10 43 43 4e 32 10 27 04 97 9e 81 b3 ee d1 9a
         56 74 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 44 b9 86 d8 3c
         79 15 3f 1c ac 09 15 12 9c e0 df 09 4c 4d 02 92 cc c1 00 61 ee
         79 73 0b 61 b4 5c 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 fd de eb
         e5 c5 9f 90 77 2b b1 0f a9 2e a3 64 10 43 43 4e 32 10 27 04 97
         9e 81 b3 ee d1 9a 56 74 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 44 b9 86 d8 3c 79 15 3f 1c ac 09 15 12 9c e0 df 09 4c 4d 02
         92 cc c1 00 61 ee 79 73 0b 61 b4 5c 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  22 bb 5c 28 77 a5 5a 17 b3 f0 04 8f e5 0f b4 e6
         75 e2 11 54 79 04 2a ed 6b 07 eb a4 66 15 b8 e9




Thomson                 Expires December 1, 2018                [Page 6]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  9b e3 4c 23 1f 5d 6e d1 1b f5 2b 2a a1 7b
         b5 a7

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  76 af d1 de a3 d1 9a c6 7b cb 54 10

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  22 bb 5c 28 77 a5 5a 17 b3 f0 04 8f e5 0f b4 e6
         75 e2 11 54 79 04 2a ed 6b 07 eb a4 66 15 b8 e9

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  8f b1 b4 40 8a f6 e8 98 15 8f 81 22 b1 09 9b
         49 3e fd 03 36 cf 78 f8 f2 0f 30 b6 e8 30 67 68 31

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05



Thomson                 Expires December 1, 2018                [Page 7]

Internet-Draft               TLS 1.3 Traces                     May 2018


         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d
         e1 00 00 0f 00 00 84 08 04 00 80 92 b4 f9 35 e6 1a 3d 65 f5 5e
         19 f7 c9 15 3c 35 35 cb 7d ad 75 51 cb bf 24 e3 d9 8b cb 1f 01
         16 fd 46 21 ad 64 93 49 ca e3 cf 91 5f d7 86 a4 f4 3c c1 7c b2
         76 b6 52 51 0e 32 67 5e a9 64 82 93 66 d8 65 1c 66 a1 57 49 65
         89 b9 7c 87 8c 8c 78 7f 9e 1c 4d aa 18 b6 c6 c6 dc eb af f7 96
         13 7d 92 cb d0 53 a0 64 f1 1c a1 7e 94 b5 7f ae e1 1d 78 17 06
         3a 11 e5 2d 95 dd a7 88 1e 27 3d 56 3f 14 00 00 20 e0 47 db ed
         b2 01 6d 94 dd f0 69 b5 54 1f 30 da a3 1c 27 28 c6 b3 c6 e7 c9
         54 f2 24 3a 54 88 ee

      ciphertext (673 octets):  17 03 03 02 9c e4 09 e8 e1 9e a2 4d 40
         2e db e4 58 9f 66 5d 85 b4 85 74 c5 4f e1 0b 13 5a e0 5f 5d 3e
         b4 c7 3b c5 5d 96 70 9f b3 3c e4 2f a1 b7 20 60 8d bb c2 dc 35
         06 e4 17 2a e4 98 fd fb ac 18 67 fc 39 7e d3 30 0f 12 5b a6 33
         d4 23 0f 3c 5d 41 a7 0b bc 1f ec 8c 55 cf e4 a5 e6 3e 00 e4 10
         c3 7d 94 16 6d f0 98 bc 91 d8 d2 1d 4b 75 16 e1 b2 a1 f9 91 39
         57 b0 2a 60 56 5b 32 5d 42 10 58 ac 9c 11 1c 8e 78 28 2f 5c 08
         5f a0 ed 12 c7 05 85 30 6b ca e6 72 ce 60 d2 80 7e 3b da a2 d9
         18 fd 47 96 02 c1 8d d1 c2 70 99 b3 0a 36 54 5a 0f fc e3 15 ab
         fb cb 31 d5 d5 3a d0 da 37 a8 c3 70 77 2e 5a 8d 96 d7 36 5d 86
         60 e5 c0 d7 78 2c cc 73 88 78 ad fc 8a 49 9e 09 63 28 d1 ec 82
         da db 70 7d cd ef a9 bd fd 8c 81 33 28 bd 2d 4a 7c e2 95 df c9
         b0 f9 27 0a 90 a7 0a a1 8d 02 e9 04 c4 b5 bb e2 fa 35 4d 1a af
         fd 78 4a 9f 4a 55 80 8b 57 2e 1d 59 df 82 ce 09 2c ac 9b 2c ce
         27 32 2d c3 27 c7 52 8d da b1 fa 19 0f 1f ab 8d 80 79 38 4c 81
         b4 3a af 90 e7 33 77 51 89 a9 bb 07 71 11 aa ea 77 1c e1 c7 d2
         ae 9b 1d 1b cd fe 1c cf c9 cc f1 ec f6 10 8c 06 b2 37 39 14 43
         9b a7 40 f8 6d e0 a8 c3 1a 55 12 0e 21 f1 75 a9 ef fe dd 3f f7
         b3 da 24 87 f4 1c b3 6d fd 70 b2 58 5c 39 45 3c 6d 92 0f ba d9
         db 8e 71 b1 25 1d 03 40 e6 d8 ae 3b 92 2a 0e 2d 1f ca 81 26 8e
         63 dd dc 71 bb 7d 0b b4 46 15 46 3c 26 54 5b c0 e2 3a 32 a2 a8
         9e 75 d2 a1 f3 43 91 8a ed 00 f8 1d f5 7e 7d 39 58 75 97 7c 49
         e3 54 bd 5c c1 24 b2 87 16 fe 7b d8 d5 0f a5 68 88 1c 59 95 df
         05 68 1b f5 c2 ab 41 57 11 42 f1 e7 2b ff 3c d9 ae 76 8e 4a f9
         67 c0 ab ac 23 88 40 2d 6d 41 cc a8 87 a8 88 5a 4c ee 8c dc 80
         f6 3f 3a fe d3 08 e9 ba ed 36 fa 38 44 cf d4 1f f0 4c 9f 67 93
         0d 5a c8 10 ba 0c 6e ca 9a de 59 d3 22 3b c0 46 d7 d5 97 d0 d1
         9c a3 a6 ef 17 f1 0f 59 b4 d8 77 86 f7 e9 eb 65 35 76 22 bc b3
         c5 9e 3f 9c 7f bf 0c 23 c2 40 39 df 87 65 41 e3 92 70 93 0e 52
         27 9e 77 cc 39 6c ae f3 6f 26 52 5a 54 01 2b 61 34 a2 54 0a 6a
         5c 10 78 26 1a 7b 7d e2 1d 9a c8 d3 01 36 b4 43 0b 4c 5e ea 29



Thomson                 Expires December 1, 2018                [Page 8]

Internet-Draft               TLS 1.3 Traces                     May 2018


         c4 0d e6 63 c3 6f c3 a8 06 a0 f4 10 ea bc ca 4e b6 1f c0 b8 1b
         95 f6 8f 4b ed d8 9a a5 2a

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  b0 0d 51 e2 42 7b dc af 46 ff 1a b7 f9 ca b7 9a
         99 d7 34 32 f5 1f 58 73 93 e2 90 f1 4c 54 2c 03

      hash (32 octets):  88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82 63
         42 c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82
         63 42 c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      output (32 octets):  29 57 79 7e ff c8 8b 20 4c 4b ca bc 1d db d1
         d9 df 28 ce f1 bb 5f 6e 0e 01 64 f3 21 a3 e1 e3 ef

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  b0 0d 51 e2 42 7b dc af 46 ff 1a b7 f9 ca b7 9a
         99 d7 34 32 f5 1f 58 73 93 e2 90 f1 4c 54 2c 03

      hash (32 octets):  88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82 63
         42 c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82
         63 42 c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      output (32 octets):  75 2a 80 17 c6 7a 3d 39 11 8c 7f 1b 81 f4 90
         09 b5 52 8c 2d c8 ca e8 7a c7 71 cc 91 8b 93 3a 01

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  b0 0d 51 e2 42 7b dc af 46 ff 1a b7 f9 ca b7 9a
         99 d7 34 32 f5 1f 58 73 93 e2 90 f1 4c 54 2c 03

      hash (32 octets):  88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82 63
         42 c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 88 3f af 17 9d 5d a4 12 81 48 d5 18 6d d2 82 63 42
         c1 1d cd 4a 10 c4 1e d8 16 10 11 1d 36 8e 6e

      output (32 octets):  8a 4b e2 60 0e a6 71 a9 f7 c0 8b ee 68 65 9c
         d7 90 08 0b 43 61 23 64 9a 25 9b d5 70 92 ca 60 3f




Thomson                 Expires December 1, 2018                [Page 9]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  75 2a 80 17 c6 7a 3d 39 11 8c 7f 1b 81 f4 90 09
         b5 52 8c 2d c8 ca e8 7a c7 71 cc 91 8b 93 3a 01

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  39 37 a2 7f f2 95 74 f1 aa a1 39 db d5 bf
         80 ce

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ed 88 84 d1 9e bd 02 0d 0f 8b 14 d4

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  88 31 6e 39 bb 69 9c 6e f9 2a 43 2f d2 cf c5 51
         46 ca fe 79 ec 7f 70 3f 6a fb cb 1f 58 d2 1c 7c

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  9a 4a 23 64 e5 b3 e2 e1 82 fe 30 aa 7e 74
         f5 26

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  8d 93 2b 94 55 4e 43 a8 33 65 b6 3d

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55






Thomson                 Expires December 1, 2018               [Page 10]

Internet-Draft               TLS 1.3 Traces                     May 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  a1 59 cb b4 83 d0 71 83 3d c1 32 45 e2 f9 f0 6e
         ba 88 e0 7d 8c 9f 15 69 c0 21 8d 6a 12 48 f5 4f

      secret (32 octets):  ad d6 47 62 88 23 46 7e be 51 c5 57 60 1f bb
         e1 86 90 01 70 e6 89 bb d5 02 fb dc 6b 00 df 09 89

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  22 bb 5c 28 77 a5 5a 17 b3 f0 04 8f e5 0f b4 e6
         75 e2 11 54 79 04 2a ed 6b 07 eb a4 66 15 b8 e9

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  9b e3 4c 23 1f 5d 6e d1 1b f5 2b 2a a1 7b
         b5 a7

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  76 af d1 de a3 d1 9a c6 7b cb 54 10

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires December 1, 2018               [Page 11]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  88 31 6e 39 bb 69 9c 6e f9 2a 43 2f d2 cf c5 51
         46 ca fe 79 ec 7f 70 3f 6a fb cb 1f 58 d2 1c 7c

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  f2 e5 ce 78 af 57 dc e3 7e 88 7b 1b df 94 4e
         56 32 62 ca 0b 0a cd 35 e2 66 f4 7f 95 86 a7 8d bd

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 6c be 39 8a 65 6b 89 e4 c6 26 60
         8a ef 62 ff 53 af f1 8e 1b 42 d0 8d 38 a7 0b e2 b5 38 7f 79 6d

      ciphertext (58 octets):  17 03 03 00 35 9e c3 51 13 c8 92 24 f8 36
         9f 93 c5 ad 3d 89 00 41 2c 9a 59 c9 c3 77 2a af 05 a0 81 19 4f
         ba c2 f5 6d c8 16 17 74 e8 cd bf 68 78 95 e3 dd 87 d9 e9 f1 3b
         8e 33

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  29 57 79 7e ff c8 8b 20 4c 4b ca bc 1d db d1 d9
         df 28 ce f1 bb 5f 6e 0e 01 64 f3 21 a3 e1 e3 ef

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  3d f3 8b eb 1b 43 a5 25 cb 37 ac 6b 26 32
         5b 56

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  32 c7 12 42 e7 2f 33 2d 05 9d ce 8f

   {client}  derive secret "tls13 res master":





Thomson                 Expires December 1, 2018               [Page 12]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  b0 0d 51 e2 42 7b dc af 46 ff 1a b7 f9 ca b7 9a
         99 d7 34 32 f5 1f 58 73 93 e2 90 f1 4c 54 2c 03

      hash (32 octets):  7a 10 68 cd 1c 34 b2 af 92 1a 05 b0 59 76 fd d8
         22 15 80 d9 63 da 9f 88 a3 49 23 f4 3e 9d 64 70

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 7a 10 68 cd 1c 34 b2 af 92 1a 05 b0 59 76 fd d8 22
         15 80 d9 63 da 9f 88 a3 49 23 f4 3e 9d 64 70

      output (32 octets):  29 f5 9c a8 aa 60 4e 54 34 74 b7 b7 11 09 93
         1e f9 03 d4 fb 05 da b0 6f 97 04 dc db 85 02 4c d9

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {server}  generate resumption secret "tls13 resumption":

      PRK (32 octets):  29 f5 9c a8 aa 60 4e 54 34 74 b7 b7 11 09 93 1e
         f9 03 d4 fb 05 da b0 6f 97 04 dc db 85 02 4c d9

      hash (2 octets):  00 00

      info (22 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 75 6d 70 74
         69 6f 6e 02 00 00

      output (32 octets):  bb 57 02 d5 b0 67 7b 52 79 48 25 be a6 0c 6b
         80 91 a4 e2 de f2 39 e8 dc 35 c3 24 09 ae c1 31 b5

   {server}  send a NewSessionTicket handshake message

   {server}  send handshake record:

      payload (205 octets):  04 00 00 c9 00 00 00 1e 0d 19 d2 54 02 00
         00 00 b2 25 33 ce 6b cd df 9e 7a ce 75 99 9c 00 00 00 00 c9 0b
         33 af 80 83 0a bf b8 07 26 87 7c e1 79 04 00 70 83 a0 82 5c 91
         ab 16 b1 83 9f 88 52 1d e8 5d a3 c0 e8 88 36 6d a0 dc ef 81 3b
         8d db 83 ca 1e 06 74 49 de a8 cb 26 2c 8d 8b 24 54 d2 7b 48 d5
         2a 11 28 71 bb 83 a2 15 72 91 b4 5e c3 45 b6 b0 65 da d8 b3 e1
         50 c7 21 55 19 cf 37 7b 04 8b 01 eb 57 48 cb 99 3b d3 92 76 89
         9e b2 ea e4 f8 36 44 72 d8 d2 a8 30 fa bf 8a c1 a2 a0 33 c0 28
         ca 9c 27 a1 c1 5c 49 5c 22 c2 ce 1c 54 8e 60 12 f8 5c f3 1b 9b
         75 fc f9 75 03 5d 94 b0 d9 39 a5 54 23 00 08 00 2a 00 04 00 00
         04 00



Thomson                 Expires December 1, 2018               [Page 13]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (227 octets):  17 03 03 00 de 3f 17 59 44 5d 2f cd 1f
         d8 14 3d 74 7a e6 cc b0 06 79 73 78 a0 c3 8b 8a 82 ea 18 e1 4a
         79 b5 1b 7e 53 ba 20 cd 4e a7 5d 98 cc 27 80 d9 1b 15 0d e6 68
         61 47 2d 81 99 3f 7f fd b2 e5 26 f4 f4 a0 d8 85 b0 44 15 39 c2
         91 3d ac 66 12 35 0b bf 11 c8 34 bb 03 98 4e 71 3a 88 79 26 97
         ad 35 7c 55 3c 0d d7 44 14 4c 61 96 bd f4 fd 87 4b 9f 6b 06 1e
         a0 c2 f1 31 2a 5d d8 64 d7 09 23 e4 68 67 19 64 9e ef 5b 51 79
         80 11 12 6b 60 55 e5 95 3e 3d 6d fa a6 42 26 04 6c c9 6e 61 4d
         fa 08 7b ab e9 22 42 07 f8 83 17 2c 5d 95 f7 61 20 d2 b6 ad 8b
         0a 1a 49 92 db 79 7a 9d 48 e2 b9 d2 5a 37 5f ee b9 06 01 4b 78
         39 fc 5e 1d 5b 37 1b b7 b6 88 0e 58 51 8a 20 55 dc 53 37 cf 80
         a4 b4 3b f4

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 64 65 e3 ce b3 6d 21 ae 0b
         a7 66 7e 41 b8 35 a5 2e d2 06 80 de 39 9a 15 5e 2e 04 d8 c4 e2
         37 87 b8 52 fb 12 9c d8 7d b9 ff 0d 01 31 97 13 ab 1f 43 3a 34
         19 44 25 f1 de fe be ef 07 6d a0 c6 dc 73 9c 8b

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 83 d5 16 d9 66 af 4a a5 55
         75 97 17 53 2d 7a a1 41 c4 96 5a 4c 2b 6c e9 9b 79 c3 0c 3e 66
         9b f9 a4 1a b0 15 b8 ee ad 0d 6b 23 15 55 42 47 20 63 0b b6 d2
         5c fd 92 b8 dd 43 79 60 6d 78 82 4b 6f e6 0d b3

   {client}  generate resumption secret "tls13 resumption" (same as
      server)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 f8 55 04 83 3a 26 ec c4 d3
         8a b2 5c d3 ad 72 b5 08 3b ab

   {server}  send alert record:

      payload (2 octets):  01 00



Thomson                 Expires December 1, 2018               [Page 14]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (24 octets):  17 03 03 00 13 c8 4e bf c6 b9 4d 72 5f 27
         0d ae b2 5c 78 56 d4 df ca f9

4.  Resumed 0-RTT Handshake

   This handshake resumes from the handshake in Section 3.  Since the
   server provided a session ticket that permitted 0-RTT, and the client
   is configured for 0-RTT, the client is able to send 0-RTT data.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  16 67 2a 6f 0c 85 f3 60 c5 3e f3 9a e2
         3b a3 cd 5b 4c da ba 84 f9 9d c0 14 af 96 c9 c0 7e 71 a5

      public key (32 octets):  4b 24 f2 77 29 ac a4 f2 c7 f6 cc 3b 99 ee
         74 a6 7d f4 a9 e0 c6 93 33 6f 27 db b2 17 b3 0c ce 0e

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  bb 57 02 d5 b0 67 7b 52 79 48 25 be a6 0c 6b 80
         91 a4 e2 de f2 39 e8 dc 35 c3 24 09 ae c1 31 b5

      secret (32 octets):  0e 04 db 74 43 bf 3c aa 00 71 c7 1a 89 b5 46
         b9 77 2c 7b 53 e7 69 70 57 e1 dc 8d 08 37 a2 88 3c

   {client}  send a ClientHello handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  de e1 e5 0f 5c 18 7b 42 99 bf 91 e8 13 d9 42 e3
         8e fd 88 ca de a3 0d 8e b5 07 60 c6 d8 87 9a ba

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  34 46 27 0b f1 a7 32 59 30 86 aa 58 67 b8 40
         2c 60 da 6a 24 24 77 12 18 51 54 5d 90 72 34 5d fa

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 80 b6 ec c3 13 26 5a 47
         bb 5f 4a 5c b2 61 08 67 07 4c 06 8c d3 ad ae b2 53 36 19 04 d2
         6d d8 e2 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12



Thomson                 Expires December 1, 2018               [Page 15]

Internet-Draft               TLS 1.3 Traces                     May 2018


         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 4b 24 f2 77 29 ac a4 f2 c7 f6 cc 3b 99 ee
         74 a6 7d f4 a9 e0 c6 93 33 6f 27 db b2 17 b3 0c ce 0e 00 2a 00
         00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 29 00 dd 00 b8 00 b2 25 33 ce 6b cd df 9e 7a ce 75 99 9c 00
         00 00 00 c9 0b 33 af 80 83 0a bf b8 07 26 87 7c e1 79 04 00 70
         83 a0 82 5c 91 ab 16 b1 83 9f 88 52 1d e8 5d a3 c0 e8 88 36 6d
         a0 dc ef 81 3b 8d db 83 ca 1e 06 74 49 de a8 cb 26 2c 8d 8b 24
         54 d2 7b 48 d5 2a 11 28 71 bb 83 a2 15 72 91 b4 5e c3 45 b6 b0
         65 da d8 b3 e1 50 c7 21 55 19 cf 37 7b 04 8b 01 eb 57 48 cb 99
         3b d3 92 76 89 9e b2 ea e4 f8 36 44 72 d8 d2 a8 30 fa bf 8a c1
         a2 a0 33 c0 28 ca 9c 27 a1 c1 5c 49 5c 22 c2 ce 1c 54 8e 60 12
         f8 5c f3 1b 9b 75 fc f9 75 03 5d 94 b0 d9 39 a5 54 23 0d 19 d2
         5a 00 21 20 4f 3b 8a 9b 7b c6 7d 2e 36 b6 ab fd 2f 3b 28 bf 47
         3f c2 72 0e 7b da 6e 9d 99 32 ad e4 aa 4a c8

      ciphertext (517 octets):  16 03 01 02 00 01 00 01 fc 03 03 80 b6
         ec c3 13 26 5a 47 bb 5f 4a 5c b2 61 08 67 07 4c 06 8c d3 ad ae
         b2 53 36 19 04 d2 6d d8 e2 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 4b 24 f2 77 29 ac a4 f2
         c7 f6 cc 3b 99 ee 74 a6 7d f4 a9 e0 c6 93 33 6f 27 db b2 17 b3
         0c ce 0e 00 2a 00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 29 00 dd 00 b8 00 b2 25 33 ce 6b cd df 9e
         7a ce 75 99 9c 00 00 00 00 c9 0b 33 af 80 83 0a bf b8 07 26 87
         7c e1 79 04 00 70 83 a0 82 5c 91 ab 16 b1 83 9f 88 52 1d e8 5d
         a3 c0 e8 88 36 6d a0 dc ef 81 3b 8d db 83 ca 1e 06 74 49 de a8
         cb 26 2c 8d 8b 24 54 d2 7b 48 d5 2a 11 28 71 bb 83 a2 15 72 91
         b4 5e c3 45 b6 b0 65 da d8 b3 e1 50 c7 21 55 19 cf 37 7b 04 8b
         01 eb 57 48 cb 99 3b d3 92 76 89 9e b2 ea e4 f8 36 44 72 d8 d2
         a8 30 fa bf 8a c1 a2 a0 33 c0 28 ca 9c 27 a1 c1 5c 49 5c 22 c2
         ce 1c 54 8e 60 12 f8 5c f3 1b 9b 75 fc f9 75 03 5d 94 b0 d9 39
         a5 54 23 0d 19 d2 5a 00 21 20 4f 3b 8a 9b 7b c6 7d 2e 36 b6 ab
         fd 2f 3b 28 bf 47 3f c2 72 0e 7b da 6e 9d 99 32 ad e4 aa 4a c8




Thomson                 Expires December 1, 2018               [Page 16]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive secret "tls13 c e traffic":

      PRK (32 octets):  0e 04 db 74 43 bf 3c aa 00 71 c7 1a 89 b5 46 b9
         77 2c 7b 53 e7 69 70 57 e1 dc 8d 08 37 a2 88 3c

      hash (32 octets):  3b 99 bd 4d 31 3a 87 83 7e 6d f4 ce 04 6f b1 fa
         46 5e 66 5f 9b 58 2f c3 11 7b 7d 03 6d b9 e3 a3

      info (53 octets):  00 20 11 74 6c 73 31 33 20 63 20 65 20 74 72 61
         66 66 69 63 20 3b 99 bd 4d 31 3a 87 83 7e 6d f4 ce 04 6f b1 fa
         46 5e 66 5f 9b 58 2f c3 11 7b 7d 03 6d b9 e3 a3

      output (32 octets):  6a 8b 06 41 9a d2 f7 66 f8 a6 62 e5 2e 53 f3
         64 30 19 2e 4c 54 1a b2 c6 72 6a 50 7f 44 91 d2 68

   {client}  derive secret "tls13 e exp master":

      PRK (32 octets):  0e 04 db 74 43 bf 3c aa 00 71 c7 1a 89 b5 46 b9
         77 2c 7b 53 e7 69 70 57 e1 dc 8d 08 37 a2 88 3c

      hash (32 octets):  3b 99 bd 4d 31 3a 87 83 7e 6d f4 ce 04 6f b1 fa
         46 5e 66 5f 9b 58 2f c3 11 7b 7d 03 6d b9 e3 a3

      info (54 octets):  00 20 12 74 6c 73 31 33 20 65 20 65 78 70 20 6d
         61 73 74 65 72 20 3b 99 bd 4d 31 3a 87 83 7e 6d f4 ce 04 6f b1
         fa 46 5e 66 5f 9b 58 2f c3 11 7b 7d 03 6d b9 e3 a3

      output (32 octets):  d4 10 10 68 2b 16 59 dd 1e 66 e7 85 66 86 94
         29 14 a4 a9 a0 99 ed cf 79 1e 38 08 0c f4 8b be 62

   {client}  derive write traffic keys for early application data:

      PRK (32 octets):  6a 8b 06 41 9a d2 f7 66 f8 a6 62 e5 2e 53 f3 64
         30 19 2e 4c 54 1a b2 c6 72 6a 50 7f 44 91 d2 68

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c8 53 71 da 92 5b 33 7d 6a 01 e5 44 ab 15
         03 ba

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2e d8 e7 bf 68 d5 34 76 0e a7 cb 67

   {client}  send application_data record:

      payload (6 octets):  41 42 43 44 45 46




Thomson                 Expires December 1, 2018               [Page 17]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (28 octets):  17 03 03 00 17 82 40 63 d8 4d 55 da 06 a8
         60 67 99 e8 b4 19 a1 61 6d d3 eb 04 6b da

   {server}  extract secret "early" (same as client)

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  df 07 6a 20 ed ab 9d 1a 96 cf 34 7f e0
         94 97 1e 8a ac 01 cb fe 0d 3f d6 02 65 44 e4 56 fe 8d 30

      public key (32 octets):  55 dc 9d 60 c0 37 5a 31 74 3c 24 ef bd 2b
         bc 07 7f 63 c1 cc 11 26 de f2 bc 7b 4a 29 b1 2c 28 51

   {server}  derive secret "tls13 c e traffic" (same as client)

   {server}  derive secret "tls13 e exp master" (same as client)

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  0e 04 db 74 43 bf 3c aa 00 71 c7 1a 89 b5 46 b9
         77 2c 7b 53 e7 69 70 57 e1 dc 8d 08 37 a2 88 3c

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  ad ff a8 3e 59 ca 9e 67 44 55 2c 10 29 5c d9
         7a 9d 27 b8 3a 3d 1f 51 aa 0c 96 af 50 68 34 4d 38

   {server}  extract secret "handshake":

      salt (32 octets):  ad ff a8 3e 59 ca 9e 67 44 55 2c 10 29 5c d9 7a
         9d 27 b8 3a 3d 1f 51 aa 0c 96 af 50 68 34 4d 38

      ikm (32 octets):  db ce a7 49 58 41 07 27 19 22 82 56 cc 36 04 7d
         90 23 45 db d5 4d bd e2 c2 57 e1 cd 48 1f 92 57

      secret (32 octets):  fe 3c ca 92 0b 98 7d 59 30 8d 59 2e 23 9e 1e
         da fd e5 ac 57 07 54 b6 12 b5 4f c1 90 17 dc e6 c5

   {server}  derive secret "tls13 c hs traffic":



Thomson                 Expires December 1, 2018               [Page 18]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  fe 3c ca 92 0b 98 7d 59 30 8d 59 2e 23 9e 1e da
         fd e5 ac 57 07 54 b6 12 b5 4f c1 90 17 dc e6 c5

      hash (32 octets):  1f df 76 b7 40 f9 88 02 d9 b4 cd c9 5b 8c 25 08
         f6 8a 95 81 7e 89 63 e9 9c 2f 56 d7 12 08 fd 93

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 1f df 76 b7 40 f9 88 02 d9 b4 cd c9 5b 8c 25
         08 f6 8a 95 81 7e 89 63 e9 9c 2f 56 d7 12 08 fd 93

      output (32 octets):  fe ad 5a df 89 37 8c 14 9d d8 6d 25 13 d0 3f
         bb fb e8 9b 9d 1d 77 fc c1 f3 1b 3c 8a a7 e1 87 9c

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  fe 3c ca 92 0b 98 7d 59 30 8d 59 2e 23 9e 1e da
         fd e5 ac 57 07 54 b6 12 b5 4f c1 90 17 dc e6 c5

      hash (32 octets):  1f df 76 b7 40 f9 88 02 d9 b4 cd c9 5b 8c 25 08
         f6 8a 95 81 7e 89 63 e9 9c 2f 56 d7 12 08 fd 93

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 1f df 76 b7 40 f9 88 02 d9 b4 cd c9 5b 8c 25
         08 f6 8a 95 81 7e 89 63 e9 9c 2f 56 d7 12 08 fd 93

      output (32 octets):  6c c9 48 1f d1 e0 45 cb 7d fc 21 2d 30 d9 b0
         65 f1 a7 d4 5b fe 76 d6 66 29 77 79 4b 1e 6d a1 26

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  fe 3c ca 92 0b 98 7d 59 30 8d 59 2e 23 9e 1e da
         fd e5 ac 57 07 54 b6 12 b5 4f c1 90 17 dc e6 c5

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  70 b6 88 d9 db 78 84 26 d7 4a 56 ec 70 37 d1
         7e 5a fb 16 ce f7 98 84 85 06 a8 b9 82 88 52 f4 8e

   {server}  extract secret "master":

      salt (32 octets):  70 b6 88 d9 db 78 84 26 d7 4a 56 ec 70 37 d1 7e
         5a fb 16 ce f7 98 84 85 06 a8 b9 82 88 52 f4 8e




Thomson                 Expires December 1, 2018               [Page 19]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  44 85 64 d4 50 84 1a 5c 56 cc 4a d5 10 35 0f
         fc b7 97 98 c6 d9 8d d9 fe 74 b8 9f 2c 1f 83 c6 0e

   {server}  send handshake record:

      payload (96 octets):  02 00 00 5c 03 03 7c 98 25 91 b4 00 47 18 c3
         78 76 bc 26 b5 4f 8b f3 ea 42 41 51 09 8b 04 14 87 ba ed 49 d3
         69 04 00 13 01 00 00 34 00 29 00 02 00 00 00 33 00 24 00 1d 00
         20 55 dc 9d 60 c0 37 5a 31 74 3c 24 ef bd 2b bc 07 7f 63 c1 cc
         11 26 de f2 bc 7b 4a 29 b1 2c 28 51 00 2b 00 02 7f 1c

      ciphertext (101 octets):  16 03 03 00 60 02 00 00 5c 03 03 7c 98
         25 91 b4 00 47 18 c3 78 76 bc 26 b5 4f 8b f3 ea 42 41 51 09 8b
         04 14 87 ba ed 49 d3 69 04 00 13 01 00 00 34 00 29 00 02 00 00
         00 33 00 24 00 1d 00 20 55 dc 9d 60 c0 37 5a 31 74 3c 24 ef bd
         2b bc 07 7f 63 c1 cc 11 26 de f2 bc 7b 4a 29 b1 2c 28 51 00 2b
         00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  6c c9 48 1f d1 e0 45 cb 7d fc 21 2d 30 d9 b0 65
         f1 a7 d4 5b fe 76 d6 66 29 77 79 4b 1e 6d a1 26

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  f3 d5 1f 2b f2 c2 c5 d0 4d cc f5 3f a6 7a
         ca 3e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c1 b7 83 b3 ad 19 4e 34 57 ee 28 5e

   {server}  send a EncryptedExtensions handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  6c c9 48 1f d1 e0 45 cb 7d fc 21 2d 30 d9 b0 65
         f1 a7 d4 5b fe 76 d6 66 29 77 79 4b 1e 6d a1 26

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00





Thomson                 Expires December 1, 2018               [Page 20]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  a8 db f7 72 b6 c1 a1 32 13 6b 22 8f 4f 17 67
         c7 11 f6 8b d4 68 f0 84 7d f3 9b c3 07 b0 8c fe 38

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (74 octets):  08 00 00 22 00 20 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 00 2a
         00 00 14 00 00 20 99 5f f7 08 2f 4c e6 2b ac a5 d5 e6 33 9f 62
         cd 4f fa 7a cc 0e 37 52 e9 6a ec 77 6d 57 38 c8 f5

      ciphertext (96 octets):  17 03 03 00 5b f7 c1 71 64 30 14 3a 54 04
         4a 55 12 0f 08 4d ac e3 be c1 68 2d 13 90 00 80 4b 12 1a f4 e7
         20 07 6a 9d 2a b7 c1 53 8d 7f 3f 65 f9 fe fc 6b 3e 5d af b6 c8
         86 c6 8a ce 17 f8 60 22 c4 b5 be 2e 93 f8 84 18 23 2c 67 aa e3
         15 27 7f 9d ff 2b 7b 97 50 25 70 03 94 d7 02 3d fb cd 00

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  44 85 64 d4 50 84 1a 5c 56 cc 4a d5 10 35 0f fc
         b7 97 98 c6 d9 8d d9 fe 74 b8 9f 2c 1f 83 c6 0e

      hash (32 octets):  c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48 dd
         ec 28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48
         dd ec 28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      output (32 octets):  3b 72 4f 58 a8 ba 12 60 0f 6d aa bb fb 46 37
         78 59 6d 7f e2 be 48 5e ce 83 72 6c d8 0e 26 75 1b

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  44 85 64 d4 50 84 1a 5c 56 cc 4a d5 10 35 0f fc
         b7 97 98 c6 d9 8d d9 fe 74 b8 9f 2c 1f 83 c6 0e

      hash (32 octets):  c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48 dd
         ec 28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48
         dd ec 28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      output (32 octets):  ae a8 04 a4 06 20 68 f0 f6 a7 25 40 a7 a2 38
         05 7f 25 05 14 db d8 0d 4c 73 4b 32 0a af 2e 7a 68




Thomson                 Expires December 1, 2018               [Page 21]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  44 85 64 d4 50 84 1a 5c 56 cc 4a d5 10 35 0f fc
         b7 97 98 c6 d9 8d d9 fe 74 b8 9f 2c 1f 83 c6 0e

      hash (32 octets):  c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48 dd
         ec 28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 c1 c2 9a cb f8 3f b8 ea 83 85 88 f4 cc 1c 48 dd ec
         28 08 4d d3 08 ae fd 39 4c 7c 4c 46 fa 21 94

      output (32 octets):  b4 c0 45 90 e5 4c 47 5d c7 50 c4 a1 ea 11 d2
         4e c0 38 52 bd 58 6e 05 15 42 4d fb 78 ea 9e af 77

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  ae a8 04 a4 06 20 68 f0 f6 a7 25 40 a7 a2 38 05
         7f 25 05 14 db d8 0d 4c 73 4b 32 0a af 2e 7a 68

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  67 52 5c 34 04 b0 d8 10 7c 42 1f 2d 2d ae
         ca 05

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ac 5f d6 dd c3 db 5e f6 17 8f ff e0

   {server}  derive read traffic keys for early application data (same
      as client write traffic keys)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  0e 04 db 74 43 bf 3c aa 00 71 c7 1a 89 b5 46 b9
         77 2c 7b 53 e7 69 70 57 e1 dc 8d 08 37 a2 88 3c

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  ad ff a8 3e 59 ca 9e 67 44 55 2c 10 29 5c d9
         7a 9d 27 b8 3a 3d 1f 51 aa 0c 96 af 50 68 34 4d 38

   {client}  extract secret "handshake":



Thomson                 Expires December 1, 2018               [Page 22]

Internet-Draft               TLS 1.3 Traces                     May 2018


      salt (32 octets):  ad ff a8 3e 59 ca 9e 67 44 55 2c 10 29 5c d9 7a
         9d 27 b8 3a 3d 1f 51 aa 0c 96 af 50 68 34 4d 38

      ikm (32 octets):  db ce a7 49 58 41 07 27 19 22 82 56 cc 36 04 7d
         90 23 45 db d5 4d bd e2 c2 57 e1 cd 48 1f 92 57

      secret (32 octets):  fe 3c ca 92 0b 98 7d 59 30 8d 59 2e 23 9e 1e
         da fd e5 ac 57 07 54 b6 12 b5 4f c1 90 17 dc e6 c5

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  6c c9 48 1f d1 e0 45 cb 7d fc 21 2d 30 d9 b0 65
         f1 a7 d4 5b fe 76 d6 66 29 77 79 4b 1e 6d a1 26

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  f3 d5 1f 2b f2 c2 c5 d0 4d cc f5 3f a6 7a
         ca 3e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c1 b7 83 b3 ad 19 4e 34 57 ee 28 5e

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send a EndOfEarlyData handshake message

   {client}  send handshake record:

      payload (4 octets):  05 00 00 00

      ciphertext (26 octets):  17 03 03 00 15 6f 05 61 b3 b5 43 43 a9 9f
         54 10 97 39 26 e8 74 f9 0d af b0 56




Thomson                 Expires December 1, 2018               [Page 23]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  derive write traffic keys for handshake data:

      PRK (32 octets):  fe ad 5a df 89 37 8c 14 9d d8 6d 25 13 d0 3f bb
         fb e8 9b 9d 1d 77 fc c1 f3 1b 3c 8a a7 e1 87 9c

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  e5 f6 34 66 fc 3c 55 1c d6 6f 46 4d a4 30
         b1 bf

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f2 00 7b 2a c1 2e b4 7c 4f 53 5f 8f

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  fe ad 5a df 89 37 8c 14 9d d8 6d 25 13 d0 3f bb
         fb e8 9b 9d 1d 77 fc c1 f3 1b 3c 8a a7 e1 87 9c

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  ba 8c 51 4b fe f1 51 fb e5 31 c0 83 94 c5 9d
         d9 12 f4 dc cc f3 3c ef cf 0f 60 63 87 b0 bc 18 5c

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 e5 f7 a2 85 d0 b6 17 83 17 e1 ab
         4d 10 fc 41 6e 53 8a ef 5c e4 a7 70 e9 7e 31 8a 54 91 d0 71 6e

      ciphertext (58 octets):  17 03 03 00 35 50 cf c6 3d 2f bf ab 59 6e
         0f 2c 7e 15 b5 9b 9c 16 c5 49 e4 b2 a7 6f 1d 3c 8b 3b 47 14 c4
         17 19 5e f5 78 0b d3 59 ea aa 1d 03 5a d6 92 b9 89 dc 2d 77 97
         42 12

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  3b 72 4f 58 a8 ba 12 60 0f 6d aa bb fb 46 37 78
         59 6d 7f e2 be 48 5e ce 83 72 6c d8 0e 26 75 1b

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00



Thomson                 Expires December 1, 2018               [Page 24]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  54 bf 3d 28 92 82 8a 2a 23 80 26 8b 88 b9
         ce da

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f8 f4 ac 16 02 5a 10 6c 4f a3 26 ab

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  44 85 64 d4 50 84 1a 5c 56 cc 4a d5 10 35 0f fc
         b7 97 98 c6 d9 8d d9 fe 74 b8 9f 2c 1f 83 c6 0e

      hash (32 octets):  49 04 74 b7 43 dc fb f2 5c 73 ed c7 24 20 e7 00
         92 fd 6a a0 e8 0d 39 c9 78 12 c7 e0 b1 9c 60 a3

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 49 04 74 b7 43 dc fb f2 5c 73 ed c7 24 20 e7 00 92
         fd 6a a0 e8 0d 39 c9 78 12 c7 e0 b1 9c 60 a3

      output (32 octets):  38 ca a7 01 32 2f 9e fe 57 f7 ca a1 bf ec 5c
         0f 62 ea d6 77 99 8f 4f 82 53 db 4a 08 39 22 54 2c

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  fe ad 5a df 89 37 8c 14 9d d8 6d 25 13 d0 3f bb
         fb e8 9b 9d 1d 77 fc c1 f3 1b 3c 8a a7 e1 87 9c

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  e5 f6 34 66 fc 3c 55 1c d6 6f 46 4d a4 30
         b1 bf

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f2 00 7b 2a c1 2e b4 7c 4f 53 5f 8f

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31



Thomson                 Expires December 1, 2018               [Page 25]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (72 octets):  17 03 03 00 43 f9 c8 d1 8f 46 1d 09 6b 57
         e5 a0 3c a4 98 78 24 d0 8e c2 a7 a6 14 36 b5 97 9d dc 8e 44 08
         82 d2 b0 3c 8b 8e b1 53 7a 99 f4 7b 9f b3 18 7d 39 5f 5e 1c 49
         4f f8 d0 f6 b2 7b 24 d7 e9 a0 36 19 b3 3f b2 16

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 2d 96 44 b2 6f 66 e3 72 f2
         a1 b3 70 0a 41 3b ba 4c d6 d6 49 ad b5 e0 08 9c 42 fe d3 85 99
         87 58 6b 1a 1d fe 46 cb 01 b8 d1 0e f2 5e a4 ad e7 5e 19 0c 6d
         94 62 6a b8 09 ca 99 a3 27 4c e9 de a1 9c fb a8

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 0f 0a a9 c6 57 db 40 e0 33
         86 7b 6e 4d 3f ab f6 96 64 df

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 71 21 82 22 36 47 3e 39 0c
         f2 f7 53 3e b2 43 cc 2a e9 ba

5.  HelloRetryRequest

   In this example, the client initiates a handshake with an X25519
   [RFC7748] share.  The server however prefers P-256 [FIPS186] and
   sends a HelloRetryRequest that requires the client to generate a key
   share on the P-256 curve.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  4d 9a 17 3c 67 e7 c3 03 f3 c3 8a f8 c6
         a1 71 7f 0b 30 3a 33 c5 4f 2c 16 b0 77 8d bd 17 75 57 83

      public key (32 octets):  c2 48 fa bb d7 8c 5f b6 e2 b8 aa 40 45 d7
         67 3d fc 5c bf 28 e0 76 82 39 95 f8 20 90 7b 9a 26 3c

   {client}  send a ClientHello handshake message

   {client}  send handshake record:



Thomson                 Expires December 1, 2018               [Page 26]

Internet-Draft               TLS 1.3 Traces                     May 2018


      payload (174 octets):  01 00 00 aa 03 03 5f 16 86 09 48 66 ad 0b
         83 cb 0d b8 3c b2 cb e5 d7 7d 8d 1b 9a 9d 73 fd 57 21 8e 20 24
         26 2d ac 00 00 06 13 01 13 03 13 02 01 00 00 7b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00 20 c2 48 fa bb d7
         8c 5f b6 e2 b8 aa 40 45 d7 67 3d fc 5c bf 28 e0 76 82 39 95 f8
         20 90 7b 9a 26 3c 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03
         05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04
         02 05 02 06 02 02 02 00 2d 00 02 01 01

      ciphertext (179 octets):  16 03 01 00 ae 01 00 00 aa 03 03 5f 16
         86 09 48 66 ad 0b 83 cb 0d b8 3c b2 cb e5 d7 7d 8d 1b 9a 9d 73
         fd 57 21 8e 20 24 26 2d ac 00 00 06 13 01 13 03 13 02 01 00 00
         7b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00
         20 c2 48 fa bb d7 8c 5f b6 e2 b8 aa 40 45 d7 67 3d fc 5c bf 28
         e0 76 82 39 95 f8 20 90 7b 9a 26 3c 00 2b 00 03 02 7f 1c 00 0d
         00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05
         01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61 11
         be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2 c8
         a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17 00 2c 00 74 00 72
         f8 35 15 58 69 3c 6c 43 e7 b8 8e c4 00 00 00 00 5c 8d f4 97 69
         4b 42 25 39 7b 30 2d 9b ff 03 d7 00 30 e6 c7 bb b5 88 f7 03 f1
         cd 87 71 5a 40 34 c6 bc b4 48 b9 af ce 11 9e 2b aa 22 be c4 17
         59 52 a4 bc a2 59 2b f8 66 9b 49 0a 6a 59 a7 89 33 03 54 00 5e
         69 af 95 f6 2c 0b c7 63 57 b8 fe c4 05 31 6e b7 f0 4c 0c 9a f3
         90 0c 34 ed 60 27 58 b1 2e 00 2b 00 02 7f 1c

      ciphertext (181 octets):  16 03 03 00 b0 02 00 00 ac 03 03 cf 21
         ad 74 e5 9a 61 11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c
         5e 07 9e 09 e2 c8 a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17
         00 2c 00 74 00 72 f8 35 15 58 69 3c 6c 43 e7 b8 8e c4 00 00 00
         00 5c 8d f4 97 69 4b 42 25 39 7b 30 2d 9b ff 03 d7 00 30 e6 c7
         bb b5 88 f7 03 f1 cd 87 71 5a 40 34 c6 bc b4 48 b9 af ce 11 9e
         2b aa 22 be c4 17 59 52 a4 bc a2 59 2b f8 66 9b 49 0a 6a 59 a7
         89 33 03 54 00 5e 69 af 95 f6 2c 0b c7 63 57 b8 fe c4 05 31 6e
         b7 f0 4c 0c 9a f3 90 0c 34 ed 60 27 58 b1 2e 00 2b 00 02 7f 1c

   {client}  create an ephemeral P-256 key pair:

      private key (32 octets):  4a f0 1f 29 ae e0 a3 98 56 07 df 46 2c
         53 57 b3 0b 4c 98 1d 04 85 bb 95 46 1b 34 ae e3 4c dc 99



Thomson                 Expires December 1, 2018               [Page 27]

Internet-Draft               TLS 1.3 Traces                     May 2018


      public key (65 octets):  04 3a bf 52 fe f6 21 e5 ef e6 48 c4 db 41
         48 f0 17 03 cc 45 6e c2 be fc b0 37 84 32 58 05 23 5c 85 bf bb
         e3 9a 08 95 c0 e3 ff 64 86 f9 0b 96 8e 3d b2 2c cd 70 11 07 99
         28 2f ae 0e b6 01 42 c8 8a

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 5f 16 86 09 48 66 ad 0b
         83 cb 0d b8 3c b2 cb e5 d7 7d 8d 1b 9a 9d 73 fd 57 21 8e 20 24
         26 2d ac 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00 41 04 3a bf 52 fe
         f6 21 e5 ef e6 48 c4 db 41 48 f0 17 03 cc 45 6e c2 be fc b0 37
         84 32 58 05 23 5c 85 bf bb e3 9a 08 95 c0 e3 ff 64 86 f9 0b 96
         8e 3d b2 2c cd 70 11 07 99 28 2f ae 0e b6 01 42 c8 8a 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2c
         00 74 00 72 f8 35 15 58 69 3c 6c 43 e7 b8 8e c4 00 00 00 00 5c
         8d f4 97 69 4b 42 25 39 7b 30 2d 9b ff 03 d7 00 30 e6 c7 bb b5
         88 f7 03 f1 cd 87 71 5a 40 34 c6 bc b4 48 b9 af ce 11 9e 2b aa
         22 be c4 17 59 52 a4 bc a2 59 2b f8 66 9b 49 0a 6a 59 a7 89 33
         03 54 00 5e 69 af 95 f6 2c 0b c7 63 57 b8 fe c4 05 31 6e b7 f0
         4c 0c 9a f3 90 0c 34 ed 60 27 58 b1 2e 00 2d 00 02 01 01 00 15
         00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      ciphertext (517 octets):  16 03 03 02 00 01 00 01 fc 03 03 5f 16
         86 09 48 66 ad 0b 83 cb 0d b8 3c b2 cb e5 d7 7d 8d 1b 9a 9d 73
         fd 57 21 8e 20 24 26 2d ac 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00
         41 04 3a bf 52 fe f6 21 e5 ef e6 48 c4 db 41 48 f0 17 03 cc 45
         6e c2 be fc b0 37 84 32 58 05 23 5c 85 bf bb e3 9a 08 95 c0 e3
         ff 64 86 f9 0b 96 8e 3d b2 2c cd 70 11 07 99 28 2f ae 0e b6 01
         42 c8 8a 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2c 00 74 00 72 f8 35 15 58 69 3c 6c 43 e7 b8 8e
         c4 00 00 00 00 5c 8d f4 97 69 4b 42 25 39 7b 30 2d 9b ff 03 d7
         00 30 e6 c7 bb b5 88 f7 03 f1 cd 87 71 5a 40 34 c6 bc b4 48 b9



Thomson                 Expires December 1, 2018               [Page 28]

Internet-Draft               TLS 1.3 Traces                     May 2018


         af ce 11 9e 2b aa 22 be c4 17 59 52 a4 bc a2 59 2b f8 66 9b 49
         0a 6a 59 a7 89 33 03 54 00 5e 69 af 95 f6 2c 0b c7 63 57 b8 fe
         c4 05 31 6e b7 f0 4c 0c 9a f3 90 0c 34 ed 60 27 58 b1 2e 00 2d
         00 02 01 01 00 15 00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral P-256 key pair:

      private key (32 octets):  69 95 05 71 84 1f ea 5b a0 c1 7a ef 1b
         7c 0c 89 af 89 dc 0f 87 b1 42 ed 78 8c eb 41 94 84 4d b5

      public key (65 octets):  04 3a 3f ca 61 66 ea ae 13 66 18 da fd ac
         c5 80 ea 1e 77 3c 7f 83 f8 10 a1 5d ff df f6 4a 1a df 40 c0 a5
         bf 55 bf 3e 8a 6e de 0c 29 04 23 bf a8 d8 ec 20 7b 3e 9a b3 09
         fa f6 c4 54 66 64 ba 0a bf

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55





Thomson                 Expires December 1, 2018               [Page 29]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  c3 46 9d 59 ca 60 91 62 b4 8d 15 7e 7a 52 42 0d
         64 b5 3e 28 27 43 36 ea 19 b4 41 2f 3e 4c c9 9a

      secret (32 octets):  6c 28 8d a8 3f 55 db 1b 55 35 d4 14 6d 7f ec
         50 42 7c 92 70 3f 5a dd 87 88 a2 73 6c b3 cc c6 c6

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  6c 28 8d a8 3f 55 db 1b 55 35 d4 14 6d 7f ec 50
         42 7c 92 70 3f 5a dd 87 88 a2 73 6c b3 cc c6 c6

      hash (32 octets):  ea 90 59 25 ff 34 af f2 cd c0 a2 73 02 6d ca 20
         42 b4 ac ce d5 c2 39 bc 70 75 97 ab 4e 76 49 93

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 ea 90 59 25 ff 34 af f2 cd c0 a2 73 02 6d ca
         20 42 b4 ac ce d5 c2 39 bc 70 75 97 ab 4e 76 49 93

      output (32 octets):  13 9e 41 fb 28 32 03 f6 93 c6 d9 e5 2c c2 49
         a8 79 0d c0 c2 6c c3 25 78 52 cf 85 e1 3d 52 41 54

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  6c 28 8d a8 3f 55 db 1b 55 35 d4 14 6d 7f ec 50
         42 7c 92 70 3f 5a dd 87 88 a2 73 6c b3 cc c6 c6

      hash (32 octets):  ea 90 59 25 ff 34 af f2 cd c0 a2 73 02 6d ca 20
         42 b4 ac ce d5 c2 39 bc 70 75 97 ab 4e 76 49 93

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 ea 90 59 25 ff 34 af f2 cd c0 a2 73 02 6d ca
         20 42 b4 ac ce d5 c2 39 bc 70 75 97 ab 4e 76 49 93

      output (32 octets):  32 5e 97 bf bc 11 6b 52 c9 51 7c 0f 84 07 91
         f8 a2 9e b3 14 14 45 12 d1 ad d6 1f be 40 db 9b 07

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  6c 28 8d a8 3f 55 db 1b 55 35 d4 14 6d 7f ec 50
         42 7c 92 70 3f 5a dd 87 88 a2 73 6c b3 cc c6 c6



Thomson                 Expires December 1, 2018               [Page 30]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  96 10 54 f9 51 fa 1e df 42 51 c5 ff 05 74 89
         21 a2 9b 5d 03 61 65 dd 0a 3e 60 89 98 fe b8 87 8a

   {server}  extract secret "master":

      salt (32 octets):  96 10 54 f9 51 fa 1e df 42 51 c5 ff 05 74 89 21
         a2 9b 5d 03 61 65 dd 0a 3e 60 89 98 fe b8 87 8a

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  12 1a 6b 7a 18 82 bd 4a bc 75 69 10 8b c3 ec
         78 0e dd ba a2 3b 0b 57 ab a5 20 8b 80 b0 77 ba aa

   {server}  send handshake record:

      payload (123 octets):  02 00 00 77 03 03 dd 7e a4 ed e1 be 69 9f
         44 5f b6 f2 23 15 cc 7c bd 91 a8 20 8a 7a a0 24 e0 3e f2 2c 61
         e6 3e bb 00 13 01 00 00 4f 00 33 00 45 00 17 00 41 04 3a 3f ca
         61 66 ea ae 13 66 18 da fd ac c5 80 ea 1e 77 3c 7f 83 f8 10 a1
         5d ff df f6 4a 1a df 40 c0 a5 bf 55 bf 3e 8a 6e de 0c 29 04 23
         bf a8 d8 ec 20 7b 3e 9a b3 09 fa f6 c4 54 66 64 ba 0a bf 00 2b
         00 02 7f 1c

      ciphertext (128 octets):  16 03 03 00 7b 02 00 00 77 03 03 dd 7e
         a4 ed e1 be 69 9f 44 5f b6 f2 23 15 cc 7c bd 91 a8 20 8a 7a a0
         24 e0 3e f2 2c 61 e6 3e bb 00 13 01 00 00 4f 00 33 00 45 00 17
         00 41 04 3a 3f ca 61 66 ea ae 13 66 18 da fd ac c5 80 ea 1e 77
         3c 7f 83 f8 10 a1 5d ff df f6 4a 1a df 40 c0 a5 bf 55 bf 3e 8a
         6e de 0c 29 04 23 bf a8 d8 ec 20 7b 3e 9a b3 09 fa f6 c4 54 66
         64 ba 0a bf 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  32 5e 97 bf bc 11 6b 52 c9 51 7c 0f 84 07 91 f8
         a2 9e b3 14 14 45 12 d1 ad d6 1f be 40 db 9b 07

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  e9 a1 09 34 70 9e f2 20 6f 52 5a 30 a9 19
         07 6d



Thomson                 Expires December 1, 2018               [Page 31]

Internet-Draft               TLS 1.3 Traces                     May 2018


      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  cd 28 21 88 10 b8 61 89 9d 47 67 4b

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  32 5e 97 bf bc 11 6b 52 c9 51 7c 0f 84 07 91 f8
         a2 9e b3 14 14 45 12 d1 ad d6 1f be 40 db 9b 07

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  6e 06 75 58 5a 5b f3 a0 89 70 e7 ff 34 52 5b
         27 91 ef 5d fb d5 ce 82 66 fb 07 1a 3f e4 6d ec d2

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (639 octets):  08 00 00 12 00 10 00 0a 00 08 00 06 00 17
         00 18 00 1d 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93
         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b



Thomson                 Expires December 1, 2018               [Page 32]

Internet-Draft               TLS 1.3 Traces                     May 2018


         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 7f
         aa 26 d5 1c 86 b5 45 8a 4b 0b 32 0e cb 16 4b f7 a5 a9 26 4b 0d
         58 59 fd fa fa c4 84 8c bc f3 5c 92 55 76 5d 52 99 01 45 e3 1d
         1c d1 e8 44 af e1 e3 7a 0c 99 db 48 24 0b 5e 0c e5 11 c8 ee 38
         da 25 49 c4 a0 3e 46 3c c9 83 dd 95 bc 5d 76 78 8f 37 a3 f6 19
         05 f0 30 4f 07 46 8a ee 2e c4 35 65 a4 80 57 b4 78 b6 09 c0 8c
         d9 7a 0e a8 cf 1a fc c8 69 8a f9 4b 95 ec 2f e7 07 0c cf 82 a6
         db 14 00 00 20 7b 0c 90 ee 65 d9 c8 87 86 bc 4c 6b 02 b0 c0 b1
         35 c7 f3 0d ba 15 9a a7 05 69 dd 55 f6 75 36 63

      ciphertext (661 octets):  17 03 03 02 90 1a e8 b7 60 74 3f df 85
         7a 60 c1 55 85 26 e9 27 ed 44 49 e2 50 04 96 a9 29 42 43 a5 0b
         05 22 81 fc 8d 28 cb 41 46 84 30 64 d2 8e d2 bc 28 f3 d5 fa 22
         ad 0a 00 83 71 c4 9d b0 fc c2 b9 57 9f 34 1c da 3f 96 dd 68 fa
         37 d3 5e 82 15 45 01 3f 26 8e ee fd f4 c2 ba ed 7c e3 92 ba e6
         18 81 03 36 ee 75 55 ba 0d 05 35 cf b6 6a c3 cf e5 8d cb 22 79
         73 8d f7 32 57 59 2c 74 cc 18 2f 6d a1 92 0c 56 ad 05 5e e4 7c
         80 78 ef 79 ea 1b fb c3 d4 88 e2 48 9e fe 0c 51 cb 25 8f bc 65
         44 bf bd c9 25 1b 4e 30 d2 63 bb 8f b0 64 c4 ca a4 5a 1f ae 34
         db 29 b6 79 dc 16 c3 51 56 c1 4f f8 4a 42 bd d8 57 e2 13 fa 44
         a0 6b 60 96 59 75 38 9b 36 09 40 d5 13 2b 03 2b 08 aa f3 24 29
         74 7c 52 a5 72 97 dd 80 4e f2 96 28 eb d0 9a 9e ff 98 e7 b0 e8
         44 c2 69 6f 22 20 62 40 5f 99 5a 92 41 dd 00 56 be 10 1c 60 18
         0c 34 5a 29 07 aa 4b 77 6c c9 99 ba 89 a7 ec e7 74 71 03 55 e2
         d8 8c 81 ad a2 de 7b 11 ad 3c cf 51 00 f3 2b 69 94 fe f8 e4 22
         56 27 53 aa 97 13 da b8 b4 8f 81 85 db d0 e1 a9 65 b8 01 a6 53
         2b a3 fe ca d4 b7 1a a5 6b 00 d4 38 e9 7d 53 9d 48 f6 a0 61 eb
         d8 22 20 23 fe bb 0b d2 22 4f 36 9f 9c 64 19 86 08 88 e9 19 e3
         d0 85 9a 6a 10 57 6b 12 9c 0d 14 57 f8 b2 bf bc b0 12 70 c4 d0
         4c 18 e3 9f 0e 55 22 f2 8c 93 90 88 20 a2 37 03 d9 32 e4 cd 35
         2a 00 a9 3a f5 55 db 16 22 ca 92 dd 69 ab 77 34 4b 1d 35 f3 68
         be 55 fe a4 ce 7f b2 e5 36 8d a9 4e 9f ef 86 fc e6 15 7f 68 25
         1a cc b1 c1 83 c5 5d 98 14 80 0b c8 37 eb e8 58 26 5b 14 29 5f
         df f9 53 41 5a 87 09 44 fd 36 57 80 82 aa 2b 62 a6 4d b0 e7 55
         38 7f 42 54 1b a0 ef 3e 5d e8 55 3c 36 71 de 33 f5 02 16 30 0a
         8d 87 44 f3 3b 26 6c 26 04 d1 e9 87 d1 09 61 c5 c9 b7 9e 08 04
         9d 33 eb ed f7 94 27 f0 65 8c bd 18 e3 e8 d8 8d 20 fa d3 1d 63
         53 19 53 6c d6 e9 99 ab a0 da d4 d3 71 12 6c 47 36 78 36 47 67
         05 f7 f4 00 ba 04 0e f9 1d 1c 69 dd bc 43 86 19 f2 7e 24 67 73
         79 5d a7 3a 6b cc 2e d5 99 2d 06 58 74 e4 90 e3 f8 ab 15 3c be
         6c 88 8f 4b b1 51 53 6d f2 8d db 15 c4 b9 71 e2 c3 5b 15 c7 f9
         79 8a cf f3 4d de d4 12 b7 6d b6 b7 55 aa ef 75 bb b1

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  12 1a 6b 7a 18 82 bd 4a bc 75 69 10 8b c3 ec 78
         0e dd ba a2 3b 0b 57 ab a5 20 8b 80 b0 77 ba aa



Thomson                 Expires December 1, 2018               [Page 33]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61 25
         37 21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61
         25 37 21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      output (32 octets):  d3 96 4e bb 13 99 2b 9e 65 d5 33 76 ea 6e 17
         d8 ac 23 07 36 cb 1a 51 60 dc f9 09 83 a4 b4 d2 57

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  12 1a 6b 7a 18 82 bd 4a bc 75 69 10 8b c3 ec 78
         0e dd ba a2 3b 0b 57 ab a5 20 8b 80 b0 77 ba aa

      hash (32 octets):  1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61 25
         37 21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61
         25 37 21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      output (32 octets):  e4 12 62 8f 3b 33 e9 40 46 33 6e de a8 78 58
         27 5a 7b 2c 84 78 3c e1 d1 fc 80 e3 e7 6a 99 a6 4f

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  12 1a 6b 7a 18 82 bd 4a bc 75 69 10 8b c3 ec 78
         0e dd ba a2 3b 0b 57 ab a5 20 8b 80 b0 77 ba aa

      hash (32 octets):  1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61 25
         37 21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 1c 94 28 a6 cd 63 48 83 1e f9 f6 23 c1 5d 61 25 37
         21 04 22 4e c6 5f 29 3b 37 bf 82 65 16 5b a0

      output (32 octets):  ad ea 98 da aa a0 51 b6 90 84 07 5b c9 4c a1
         ed 5a d1 fc b5 de dc c3 41 d1 9b 9d 7f 05 e9 bd 71

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  e4 12 62 8f 3b 33 e9 40 46 33 6e de a8 78 58 27
         5a 7b 2c 84 78 3c e1 d1 fc 80 e3 e7 6a 99 a6 4f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00





Thomson                 Expires December 1, 2018               [Page 34]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  9c 53 f1 bc 28 03 25 14 60 30 32 cc a9 5d
         5d d3

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  a0 74 5c b4 cc 30 78 71 e5 03 a0 a4

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  13 9e 41 fb 28 32 03 f6 93 c6 d9 e5 2c c2 49 a8
         79 0d c0 c2 6c c3 25 78 52 cf 85 e1 3d 52 41 54

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  29 c1 0e 3c 40 4f 62 4c dd 2f 7a 86 89 d1
         57 04

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  3a 9e be d1 bf 0d 1a f2 5a ea 9a 5b

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":




Thomson                 Expires December 1, 2018               [Page 35]

Internet-Draft               TLS 1.3 Traces                     May 2018


      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  c3 46 9d 59 ca 60 91 62 b4 8d 15 7e 7a 52 42 0d
         64 b5 3e 28 27 43 36 ea 19 b4 41 2f 3e 4c c9 9a

      secret (32 octets):  6c 28 8d a8 3f 55 db 1b 55 35 d4 14 6d 7f ec
         50 42 7c 92 70 3f 5a dd 87 88 a2 73 6c b3 cc c6 c6

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  32 5e 97 bf bc 11 6b 52 c9 51 7c 0f 84 07 91 f8
         a2 9e b3 14 14 45 12 d1 ad d6 1f be 40 db 9b 07

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  e9 a1 09 34 70 9e f2 20 6f 52 5a 30 a9 19
         07 6d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  cd 28 21 88 10 b8 61 89 9d 47 67 4b

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":





Thomson                 Expires December 1, 2018               [Page 36]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  13 9e 41 fb 28 32 03 f6 93 c6 d9 e5 2c c2 49 a8
         79 0d c0 c2 6c c3 25 78 52 cf 85 e1 3d 52 41 54

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  48 4f 85 b5 59 a8 2b 3e 3c 40 41 48 e0 b5 a1
         a1 2e 5a 85 a8 c3 5e 50 84 86 47 fe 0f 42 50 e7 f0

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 6c ec 0a cb 6e 46 79 c4 0f a8 2d
         19 78 d8 f9 ce a1 39 ee 92 2d ab c7 4f ba db 57 40 b7 3b 24 b8

      ciphertext (58 octets):  17 03 03 00 35 8d 88 5a 14 a5 85 69 c1 ce
         79 26 6d 0a d7 64 86 6d 40 b3 9a e4 05 fd 38 a6 06 dd f1 99 83
         ae 88 56 57 50 46 b3 68 42 0f 2a 35 f1 0e 46 3f cb ca 8d f4 67
         12 27

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  d3 96 4e bb 13 99 2b 9e 65 d5 33 76 ea 6e 17 d8
         ac 23 07 36 cb 1a 51 60 dc f9 09 83 a4 b4 d2 57

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  f9 b0 8b 83 e8 1f cf d1 ab 02 8d df f7 d1
         9f f2

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ef 31 cc 8a 17 f4 8d a7 cf e8 3f ca

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  12 1a 6b 7a 18 82 bd 4a bc 75 69 10 8b c3 ec 78
         0e dd ba a2 3b 0b 57 ab a5 20 8b 80 b0 77 ba aa

      hash (32 octets):  87 50 6c dc bf fc ea fd 1a 85 52 a3 8e 5e 94 66
         f9 e9 97 5f c9 a0 21 cd 06 47 3b d8 89 1e 7f 16

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 87 50 6c dc bf fc ea fd 1a 85 52 a3 8e 5e 94 66 f9
         e9 97 5f c9 a0 21 cd 06 47 3b d8 89 1e 7f 16



Thomson                 Expires December 1, 2018               [Page 37]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  bd 3e 1d bc c6 5d 68 22 de 98 59 b7 2a ec 0e
         f6 bb aa 21 72 56 f3 fd 2a dd ed e0 46 38 0a f6 71

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 7d a4 32 bd 5e bb ea 96 a0
         22 fe e4 92 f2 16 75 8c bb e6

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 a5 38 81 5e 92 e4 bf f6 b8
         e2 9a 8e 39 53 40 1a a6 e4 cb

6.  Client Authentication

   In this example, the server requests client authentication.  The
   client uses a certificate with an RSA key, the server uses an ECDSA
   certificate with a P-256 key.  Note that private keys for this
   example are not included in the draft.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  b2 a6 97 31 5b f5 1e 73 7d fd 2f 95 28
         db fd 18 fd 5c 6c 59 c4 85 f2 c9 68 9a 32 a9 f3 15 5a d2

      public key (32 octets):  28 1d 69 35 c4 90 36 fe 1a a6 fd 51 dd bd
         b9 b6 c6 97 c8 d3 c3 d8 16 f9 8b 78 c0 e4 9b 99 8d 03

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (186 octets):  01 00 00 b6 03 03 6f fa 95 80 82 36 04 5f
         09 4d 1b f0 3e cc a3 e3 e7 ca d1 26 3c 28 c1 53 5c 05 65 85 ee
         f6 d6 ae 00 00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00



Thomson                 Expires December 1, 2018               [Page 38]

Internet-Draft               TLS 1.3 Traces                     May 2018


         26 00 24 00 1d 00 20 28 1d 69 35 c4 90 36 fe 1a a6 fd 51 dd bd
         b9 b6 c6 97 c8 d3 c3 d8 16 f9 8b 78 c0 e4 9b 99 8d 03 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d
         00 02 01 01

      ciphertext (191 octets):  16 03 01 00 ba 01 00 00 b6 03 03 6f fa
         95 80 82 36 04 5f 09 4d 1b f0 3e cc a3 e3 e7 ca d1 26 3c 28 c1
         53 5c 05 65 85 ee f6 d6 ae 00 00 06 13 01 13 03 13 02 01 00 00
         87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 28 1d 69 35 c4 90 36 fe
         1a a6 fd 51 dd bd b9 b6 c6 97 c8 d3 c3 d8 16 f9 8b 78 c0 e4 9b
         99 8d 03 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  4d b5 fc 19 d1 ed 20 01 9a a4 2f 92 77
         9b 09 ad 4f 29 c0 9d 21 09 31 c8 1d e3 6e c9 f2 c0 35 ef

      public key (32 octets):  fa cd d8 29 10 84 86 a3 1d 75 f1 90 45 6c
         f4 02 ce 1b 66 ee 1d b0 5f e0 d3 f1 16 03 43 81 b5 7f

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55



Thomson                 Expires December 1, 2018               [Page 39]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  0f 16 21 87 0f 5d d6 f8 42 4b 6f ae f7 b5 0b 43
         aa 40 f8 3b 08 f8 c1 de 8a cf 35 04 c2 e4 93 69

      secret (32 octets):  0d 48 ba 9f 04 2a 03 3f 40 3e 71 f1 ca 9c 11
         8f 52 b6 b5 26 1b cd 25 34 86 14 ed a1 88 d0 5c 30

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  0d 48 ba 9f 04 2a 03 3f 40 3e 71 f1 ca 9c 11 8f
         52 b6 b5 26 1b cd 25 34 86 14 ed a1 88 d0 5c 30

      hash (32 octets):  b5 74 63 77 69 8f 9c 55 a1 bb 37 19 b0 65 04 28
         b3 51 2e 73 6d 1a 15 63 c1 1a 95 5a 0a 57 b0 ef

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 b5 74 63 77 69 8f 9c 55 a1 bb 37 19 b0 65 04
         28 b3 51 2e 73 6d 1a 15 63 c1 1a 95 5a 0a 57 b0 ef

      output (32 octets):  58 a0 e2 38 51 69 d1 a1 04 2d 3a f6 cd 77 f5
         40 80 62 d3 1a cf 4e 22 81 ed cb 0d f6 3f e4 00 2e

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  0d 48 ba 9f 04 2a 03 3f 40 3e 71 f1 ca 9c 11 8f
         52 b6 b5 26 1b cd 25 34 86 14 ed a1 88 d0 5c 30

      hash (32 octets):  b5 74 63 77 69 8f 9c 55 a1 bb 37 19 b0 65 04 28
         b3 51 2e 73 6d 1a 15 63 c1 1a 95 5a 0a 57 b0 ef

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 b5 74 63 77 69 8f 9c 55 a1 bb 37 19 b0 65 04
         28 b3 51 2e 73 6d 1a 15 63 c1 1a 95 5a 0a 57 b0 ef

      output (32 octets):  89 b9 eb 88 96 cb 0b 81 42 62 a2 71 f3 86 0d
         1a ca 62 1b 8e 7b 72 af 37 8d 53 8e f9 52 0f 4b 15

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  0d 48 ba 9f 04 2a 03 3f 40 3e 71 f1 ca 9c 11 8f
         52 b6 b5 26 1b cd 25 34 86 14 ed a1 88 d0 5c 30



Thomson                 Expires December 1, 2018               [Page 40]

Internet-Draft               TLS 1.3 Traces                     May 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  62 68 8f 96 60 84 e6 27 64 f0 fb 14 34 40 8b
         1b a4 ff fa e9 a8 c7 25 01 7f 70 d5 8e a3 2c e7 02

   {server}  extract secret "master":

      salt (32 octets):  62 68 8f 96 60 84 e6 27 64 f0 fb 14 34 40 8b 1b
         a4 ff fa e9 a8 c7 25 01 7f 70 d5 8e a3 2c e7 02

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  84 30 4e 97 d9 8d 70 42 b4 b5 aa d6 51 84 8e
         fe a2 14 dd b2 4d fa 63 f2 9d cf 97 7c 39 d0 89 12

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 e2 d0 36 aa 33 a8 bb b2 f0
         e9 2a cf 3c ba f2 52 0a 14 04 52 47 1a cf 5e 87 ad a5 fe 77 ac
         54 8f 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 fa cd d8 29 10
         84 86 a3 1d 75 f1 90 45 6c f4 02 ce 1b 66 ee 1d b0 5f e0 d3 f1
         16 03 43 81 b5 7f 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 e2 d0 36
         aa 33 a8 bb b2 f0 e9 2a cf 3c ba f2 52 0a 14 04 52 47 1a cf 5e
         87 ad a5 fe 77 ac 54 8f 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 fa cd d8 29 10 84 86 a3 1d 75 f1 90 45 6c f4 02 ce 1b 66 ee
         1d b0 5f e0 d3 f1 16 03 43 81 b5 7f 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  89 b9 eb 88 96 cb 0b 81 42 62 a2 71 f3 86 0d 1a
         ca 62 1b 8e 7b 72 af 37 8d 53 8e f9 52 0f 4b 15

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  01 3a f6 5e e3 2b d9 99 70 f5 3b f9 fd c8
         65 2d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ca 90 74 da d6 44 75 14 b2 d7 0e ee



Thomson                 Expires December 1, 2018               [Page 41]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  send a EncryptedExtensions handshake message

   {server}  send a CertificateRequest handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  89 b9 eb 88 96 cb 0b 81 42 62 a2 71 f3 86 0d 1a
         ca 62 1b 8e 7b 72 af 37 8d 53 8e f9 52 0f 4b 15

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  df f9 9e 02 dd 44 db c3 cf fe df bd 38 98 e8
         94 df 6a fa 48 95 54 60 9f f1 cb 1d 45 8e 11 54 6f

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (511 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0d
         00 00 27 00 00 24 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08
         04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02
         0b 00 01 3b 00 00 01 37 00 01 32 30 82 01 2e 30 81 d5 a0 03 02
         01 02 02 01 07 30 0a 06 08 2a 86 48 ce 3d 04 03 02 30 13 31 11
         30 0f 06 03 55 04 03 13 08 65 63 64 73 61 32 35 36 30 1e 17 0d
         31 36 30 37 33 30 30 31 32 34 30 30 5a 17 0d 32 36 30 37 33 30
         30 31 32 34 30 30 5a 30 13 31 11 30 0f 06 03 55 04 03 13 08 65
         63 64 73 61 32 35 36 30 59 30 13 06 07 2a 86 48 ce 3d 02 01 06
         08 2a 86 48 ce 3d 03 01 07 03 42 00 04 08 d5 30 16 15 75 f4 cf
         e7 f1 54 ee 34 48 18 00 86 00 1e 88 43 1a 79 ee 62 ee 6e 2f 83
         ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4 d2 f5 b5 6d 1f 04 ec e4
         5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d d0 a3 1a 30 18 30 09 06
         03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80
         30 0a 06 08 2a 86 48 ce 3d 04 03 02 03 48 00 30 45 02 21 00 df
         30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4 79 ca 69 3f ee ca 3b 71
         b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62 e2 a4 72 50 d3 20 fe a8
         3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db d1 3f ee 94 6e 51 3e 01
         1d 11 00 00 0f 00 00 4b 04 03 00 47 30 45 02 20 24 c1 3a eb 55
         21 9a 78 dc e7 b6 3a 47 ba 60 ab 47 95 84 20 4c 5f 65 94 d6 80
         76 93 4b cb 81 39 02 21 00 ea ae af 34 9b b1 f2 db d7 87 30 ab
         75 ff 17 87 2b 4c 83 ff 57 a3 96 7a 2f 16 7d 61 82 df 5e 08 14



Thomson                 Expires December 1, 2018               [Page 42]

Internet-Draft               TLS 1.3 Traces                     May 2018


         00 00 20 98 27 b0 9e 46 7e 61 0d b0 c9 46 62 38 38 94 17 44 00
         f6 66 37 66 a9 07 a3 3f 75 48 8a ce 6e 29

      ciphertext (533 octets):  17 03 03 02 10 43 10 a4 17 d1 b7 16 e0
         e9 b4 5f 2f ad 32 18 d4 e6 fc 59 a2 3a 33 09 30 0a ee a7 26 0d
         93 c7 c8 da f5 6b f7 bd bd 23 96 80 b1 73 63 3b 36 ec 70 5d 6e
         da b4 7f 76 b8 36 6e fe 53 63 17 5d ac 2e 20 75 8e 48 97 7b 58
         a7 84 b5 2c 94 17 d1 fd 84 dc 46 26 60 3c 1d d2 70 2a e6 f5 18
         65 f1 3a 05 dc 90 32 5e e7 d1 22 54 91 f9 68 18 bf d3 aa bf 3b
         e0 f8 95 3e a0 c0 fa 0d c8 e3 7f a9 5a dc eb 76 68 dd 02 df ab
         da f9 44 81 a5 f8 71 9f 02 62 47 bf 4d d0 7c 15 ce 17 1f 68 27
         7d 17 ed 50 34 ce 65 2e 3a f7 f0 f3 e8 85 50 00 b5 df 73 3e 3b
         fb 96 ae ac 08 42 75 d1 43 de 15 bb 23 b0 cb c8 b7 58 e3 21 38
         aa 5e 6b 2f f8 96 d3 b9 3c 56 bb 87 0f b3 81 ff a0 4a 04 a3 2e
         b9 62 a3 fb db 73 eb 79 1a 49 0f 4b 99 bd 15 97 b5 82 43 1d 67
         a9 8e 3e 77 5f 33 e2 6f 24 c2 c7 ff c0 cc 06 cd 39 fb e7 db e8
         41 a5 e6 7b 62 0a 6b 23 74 b8 69 d4 d6 7e 67 44 ea e3 cc f9 ae
         ed 05 09 e4 b1 23 38 0c 70 e9 f9 7a 8c ca c5 a9 eb 04 4f bb 73
         c5 86 3f 9d 04 1d 5f b1 2d d6 b7 ad 2d 00 72 a1 82 70 0d fa 59
         d0 e4 14 b0 0a 7a 60 c2 78 8a f6 1b 06 25 6b 7b 44 d0 64 ae ab
         ff 06 6d 8c eb eb ef 09 a0 49 cb 40 1c 05 b3 51 54 cf 1d e8 5c
         dd a1 88 09 a6 8f 19 c2 b4 34 34 7f 8b 00 9a bf 41 64 30 2d c1
         fd 1c 3a a3 a8 4c c4 00 96 12 fd 5d 2a 29 17 02 6d 72 86 cc 9d
         77 39 53 13 bc 92 73 96 ff 40 e7 45 4b 56 71 98 1c 3d 8f ce ce
         4a 5b 1e 7c 87 a4 6f 30 b0 6b 0f a2 32 30 6d 0b 09 17 7f 70 49
         b7 b1 36 7f c2 ce b7 c7 50 b2 3b 8f 3a ae 59 a8 02 b9 94 e1 96
         ed ca 01 eb e0 ae 88 e5 1c 5a fc 65 b9 9a 0a 79 2e 22 04 86 fb
         25 a2 08 c5 6a 11 c3 30 fb 13 f4 62 fc 7c bf 10 ea 1c 19 3a 52
         c5 4f 54 87 a3 12 ce 10 30 d1 f5 13 fe 09 f3 9b

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  84 30 4e 97 d9 8d 70 42 b4 b5 aa d6 51 84 8e fe
         a2 14 dd b2 4d fa 63 f2 9d cf 97 7c 39 d0 89 12

      hash (32 octets):  a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7 ed
         6b 49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7
         ed 6b 49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      output (32 octets):  b7 b1 73 2a 72 18 2e 7c c6 f8 7f 46 44 3e cc
         26 75 ac f9 55 aa f9 39 e5 d7 24 ba 63 90 4a 9c 65

   {server}  derive secret "tls13 s ap traffic":





Thomson                 Expires December 1, 2018               [Page 43]

Internet-Draft               TLS 1.3 Traces                     May 2018


      PRK (32 octets):  84 30 4e 97 d9 8d 70 42 b4 b5 aa d6 51 84 8e fe
         a2 14 dd b2 4d fa 63 f2 9d cf 97 7c 39 d0 89 12

      hash (32 octets):  a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7 ed
         6b 49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7
         ed 6b 49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      output (32 octets):  1d c4 1b 97 67 4d 17 ba 19 fe 32 dd f8 ae cb
         15 c4 e1 52 81 6e c5 ab 2b e5 5a ce e8 b0 96 ce 48

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  84 30 4e 97 d9 8d 70 42 b4 b5 aa d6 51 84 8e fe
         a2 14 dd b2 4d fa 63 f2 9d cf 97 7c 39 d0 89 12

      hash (32 octets):  a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7 ed
         6b 49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 a5 bb 91 7f 97 1f 92 f6 04 14 87 60 4f 3a d7 ed 6b
         49 8b d3 9e ec 28 5d 28 20 8a 70 d4 3b 1a 75

      output (32 octets):  ce a2 d0 ee d6 3a c8 41 b5 12 98 0e b2 b1 57
         9d eb 6c ac 1c 7b 10 dc ec 9b d0 82 57 6f ae a7 23

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  1d c4 1b 97 67 4d 17 ba 19 fe 32 dd f8 ae cb 15
         c4 e1 52 81 6e c5 ab 2b e5 5a ce e8 b0 96 ce 48

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  4b 89 99 02 ad 41 7f a2 19 30 2a 69 e8 ac
         88 51

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  78 2d d4 57 7b bc a9 b3 8c 13 a4 a7

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  58 a0 e2 38 51 69 d1 a1 04 2d 3a f6 cd 77 f5 40
         80 62 d3 1a cf 4e 22 81 ed cb 0d f6 3f e4 00 2e

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00



Thomson                 Expires December 1, 2018               [Page 44]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key output (16 octets):  85 15 81 d8 54 7f c8 bf ab 8d 3c 20 ee 46
         98 37

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f6 ff e8 a6 33 ff 72 1a d8 32 b8 d3

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  0f 16 21 87 0f 5d d6 f8 42 4b 6f ae f7 b5 0b 43
         aa 40 f8 3b 08 f8 c1 de 8a cf 35 04 c2 e4 93 69

      secret (32 octets):  0d 48 ba 9f 04 2a 03 3f 40 3e 71 f1 ca 9c 11
         8f 52 b6 b5 26 1b cd 25 34 86 14 ed a1 88 d0 5c 30

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)



Thomson                 Expires December 1, 2018               [Page 45]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  89 b9 eb 88 96 cb 0b 81 42 62 a2 71 f3 86 0d 1a
         ca 62 1b 8e 7b 72 af 37 8d 53 8e f9 52 0f 4b 15

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  01 3a f6 5e e3 2b d9 99 70 f5 3b f9 fd c8
         65 2d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ca 90 74 da d6 44 75 14 b2 d7 0e ee

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  send a Certificate handshake message

   {client}  send a CertificateVerify handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  58 a0 e2 38 51 69 d1 a1 04 2d 3a f6 cd 77 f5 40
         80 62 d3 1a cf 4e 22 81 ed cb 0d f6 3f e4 00 2e

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  51 ff 86 6d 17 a7 1f d8 18 3b 94 aa 78 ed 84
         7e 04 e8 48 1a cf ac 4a 0e 05 ae e3 31 0f 13 b3 a7

   {client}  send a Finished handshake message



Thomson                 Expires December 1, 2018               [Page 46]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  send handshake record:

      payload (623 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82 01
         b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86
         f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06 63
         6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39
         5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f 30
         0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06 09
         2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81
         00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7 a1
         c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81 e5
         22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f f1
         90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97 1c
         7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7 fe
         9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7 e0
         28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02
         30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a 86
         48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0 22
         af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91 6d
         c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80 be
         2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e f0
         c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2 17
         bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac 0f
         78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00 0f 00 00 84
         08 04 00 80 02 90 83 ab 1a e8 46 56 fc 6d 7e d8 36 0e de e6 f7
         e7 82 98 55 bd 6b 58 81 c3 da 63 eb 04 cd e6 7e 05 c6 ea 48 cd
         57 64 35 3e fc 34 12 f1 db 3d 5a f9 f9 55 02 e4 5b 8b c5 68 21
         59 bf f8 82 45 1d 8c cd 6c ca e5 d4 aa 92 41 74 a2 85 57 c1 c0
         6b 4d c7 3f f3 a0 f8 62 00 7c 50 2e b3 e2 f8 e3 7d 0c 25 b1 b2
         5c b0 fe af a2 b7 95 2e 91 40 72 c1 09 2a 8d eb 05 6d 4c cc 58
         ba 9e 2e bb d2 47 14 00 00 20 93 79 91 99 bf 57 63 ef ed 09 d6
         39 6a b3 c0 34 70 2b 08 55 4f 51 14 75 c3 3e d3 b1 3e 2d 5d b7

      ciphertext (645 octets):  17 03 03 02 80 91 1a 83 c6 55 5a 8b a0
         cf 3c c8 d2 98 48 f1 ba 78 4b 8f 75 70 66 72 2e 1c 3a 0f 95 b8
         bc 6e 09 a0 82 1b db 9b 1d cb f6 a2 c8 73 90 f3 c4 09 17 3e 7d
         da 2e 23 75 30 22 5b 39 87 f6 57 6d f2 88 c5 d2 9d 0b 5e 72 a3
         17 cb f6 52 55 c2 25 63 64 76 26 ea 2c 16 7b 36 0a 86 6d 36 80
         00 59 d9 fb 6a 5a 61 ca de 75 e1 85 d8 88 4b d9 10 fd 36 b1 84
         68 10 a4 a5 bb 3f 60 f5 4c bb 61 53 3b 64 cf 66 64 38 ef ac e8
         19 dd 40 84 44 50 5f 82 b4 f5 16 b8 16 9d 45 77 4c a6 ed 07 f0
         dd 05 d0 7f f8 73 a9 84 40 b5 17 ca 6b 9e 68 05 1a 2c 6f 06 b2
         de b6 a8 c2 a7 dc db c6 ff d1 26 8b 2f f7 6d a5 92 cd 9e 0a cb
         1d 95 43 43 ae 2e c7 f9 22 cc 75 77 36 72 2d e0 6e ee 20 49 bc
         27 2c 4f a8 5e df 59 26 de 4a a9 32 cf 5d 9d 28 67 b4 6c 3c b2
         d5 22 63 40 83 6c 4b 21 05 a8 cc 70 3e 9e 29 b0 f2 16 d0 a2 ac
         02 a1 55 ef aa 2b ce 4d ca bb 40 40 08 30 34 b8 f1 82 a0 aa c2
         f1 b8 ec 52 4d 51 b9 cf 80 78 b2 59 29 ad 0d 52 7a 10 4f a2 57



Thomson                 Expires December 1, 2018               [Page 47]

Internet-Draft               TLS 1.3 Traces                     May 2018


         d2 18 d3 18 3d df 58 32 8e a3 a7 3a 15 0f 06 6d a0 d0 dd dc 3e
         1a c8 6e bb 48 b5 3f 85 36 d1 66 73 1b 4f ba 4d 47 03 f2 5c fb
         a3 fb 8c 61 4f 62 6d 07 42 ea 36 c7 5e 32 4f 9c 82 45 94 a0 99
         8a 43 6d 6f 9f 1e 96 9f 2f f9 17 ad 73 e2 e7 b1 23 91 28 bb b4
         9b f7 d2 8b 88 62 14 31 86 3d bb 85 be 54 1a ee b7 9d b7 d5 78
         cd 79 c9 c5 0f 3a 5f 43 fe cf fb d6 a7 b1 17 55 72 2e 1a ee d2
         2b 5c f1 c0 01 a6 98 cd 7e 9e 10 a6 61 2a bd f5 f3 65 87 00 03
         fc d9 b0 8c 20 40 94 c8 7d ee ef f7 34 7b dc 94 aa f1 d8 74 dd
         93 e3 be 5d b4 0c d3 42 2d 4d 59 ee c5 70 21 56 48 be fe 30 18
         ce 15 c7 0c 5a 10 62 40 84 a1 cd 0f 17 84 f7 3f f8 3d 63 ff 11
         45 b7 97 5d c3 f0 b8 a9 7a 40 5d 01 7c 1d 57 54 61 8c c0 92 14
         f6 e7 b6 94 bb f7 ad 8b df bc f9 3f ce d9 92 cd ba cf ec dd c2
         eb f1 af 42 eb 15 13 6e f7 81 84 50 cd c4 fb 25 c3 47 83 b9 77
         13 fc bf 8f 1a 1a 09 33 92 43 00 a7 b6 6f a6 70 00 30 34 74 ff
         62 b9 92 68 e8 78 d0 7a b2 2d d4 3c 1b 48 b1 e7 65 38 27 ea 82
         41 11 b7 8d 6e 30 68 b1 4d 5f a1 55 a6 98 7c 64 88 f3 36 5f 76
         f1 21

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  b7 b1 73 2a 72 18 2e 7c c6 f8 7f 46 44 3e cc 26
         75 ac f9 55 aa f9 39 e5 d7 24 ba 63 90 4a 9c 65

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c6 18 25 0e c8 fb 1e d7 b5 22 eb 35 12 1f
         be 3f

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  49 ce 20 59 33 a6 2b f6 a7 ac e2 0c

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  84 30 4e 97 d9 8d 70 42 b4 b5 aa d6 51 84 8e fe
         a2 14 dd b2 4d fa 63 f2 9d cf 97 7c 39 d0 89 12

      hash (32 octets):  1c 9f d8 82 e1 bd 5c 78 08 6b 90 42 a3 38 33 95
         91 03 f0 f0 66 a0 76 20 e7 7a 3b de 89 96 6a 49

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 1c 9f d8 82 e1 bd 5c 78 08 6b 90 42 a3 38 33 95 91
         03 f0 f0 66 a0 76 20 e7 7a 3b de 89 96 6a 49

      output (32 octets):  34 a6 e8 c5 3e 9f f2 1a f6 80 14 df 17 34 12
         4a b4 17 9c 56 75 8a f6 e4 31 1f 5f c3 e1 21 9f 79

   {server}  calculate finished "tls13 finished" (same as client)



Thomson                 Expires December 1, 2018               [Page 48]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 c7 87 07 cb e1 18 b9 33 ce
         ee d7 a2 ba 20 e7 55 39 79 ff

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 80 b4 7c 0d b3 f3 9a a3 cb
         18 41 08 1b 5c 33 9e 4c 44 a0

7.  Compatibility Mode

   This example shows use of the handshake with the client requesting
   that the server use compatibility mode as defined in Appendix D.4 of
   [TLS13].

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  bf 6e f7 76 6d 29 7f b0 d0 4a 1e 35 94
         78 7b 4e 70 f7 09 bc 35 cc 3d 21 84 e0 f4 97 35 1b 90 13

      public key (32 octets):  ee 57 7f fb 4f 33 83 a6 15 a3 f8 e8 ed 7a
         c6 64 a2 4b 48 54 39 d1 1a 5b 44 b6 4a 1b b4 b3 f5 70

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (218 octets):  01 00 00 d6 03 03 68 70 75 7d 6a 37 2c fc
         90 6b 61 21 65 e4 15 8e ec a6 25 7d 2a 29 bf a0 a9 02 57 c3 31
         c9 26 f5 20 c2 32 a7 24 8e c5 f1 ed 7d e8 49 6a cf b3 c8 56 42
         e8 0d 8a b4 dd 9c 3c e5 e7 3e 01 32 fb 21 16 00 06 13 01 13 03
         13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72
         ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00
         01 01 01 02 01 03 01 04 00 33 00 26 00 24 00 1d 00 20 ee 57 7f
         fb 4f 33 83 a6 15 a3 f8 e8 ed 7a c6 64 a2 4b 48 54 39 d1 1a 5b
         44 b6 4a 1b b4 b3 f5 70 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01



Thomson                 Expires December 1, 2018               [Page 49]

Internet-Draft               TLS 1.3 Traces                     May 2018


      ciphertext (223 octets):  16 03 01 00 da 01 00 00 d6 03 03 68 70
         75 7d 6a 37 2c fc 90 6b 61 21 65 e4 15 8e ec a6 25 7d 2a 29 bf
         a0 a9 02 57 c3 31 c9 26 f5 20 c2 32 a7 24 8e c5 f1 ed 7d e8 49
         6a cf b3 c8 56 42 e8 0d 8a b4 dd 9c 3c e5 e7 3e 01 32 fb 21 16
         00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06
         73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17
         00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00 26 00 24 00
         1d 00 20 ee 57 7f fb 4f 33 83 a6 15 a3 f8 e8 ed 7a c6 64 a2 4b
         48 54 39 d1 1a 5b 44 b6 4a 1b b4 b3 f5 70 00 2b 00 03 02 7f 1c
         00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04
         01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  c5 ca 87 ca 27 1b 62 76 59 da 37 01 34
         65 2c 69 a5 dc 05 72 be d6 86 14 8d 72 f4 05 ac 53 f3 40

      public key (32 octets):  f6 f6 00 47 3c a4 35 3c 8c 26 f5 93 ff bb
         22 5e 18 8c 86 10 cc 06 c8 2f b7 22 62 61 1d 99 80 24

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (122 octets):  02 00 00 76 03 03 47 b9 c4 6f c7 95 56 36
         ab 11 eb 46 5b 7b 82 fd cb 57 80 49 32 f8 b6 9c d9 6a b8 8d 8c
         3d 37 8c 20 c2 32 a7 24 8e c5 f1 ed 7d e8 49 6a cf b3 c8 56 42
         e8 0d 8a b4 dd 9c 3c e5 e7 3e 01 32 fb 21 16 13 01 00 00 2e 00
         33 00 24 00 1d 00 20 f6 f6 00 47 3c a4 35 3c 8c 26 f5 93 ff bb
         22 5e 18 8c 86 10 cc 06 c8 2f b7 22 62 61 1d 99 80 24 00 2b 00
         02 7f 1c

      ciphertext (127 octets):  16 03 03 00 7a 02 00 00 76 03 03 47 b9
         c4 6f c7 95 56 36 ab 11 eb 46 5b 7b 82 fd cb 57 80 49 32 f8 b6
         9c d9 6a b8 8d 8c 3d 37 8c 20 c2 32 a7 24 8e c5 f1 ed 7d e8 49
         6a cf b3 c8 56 42 e8 0d 8a b4 dd 9c 3c e5 e7 3e 01 32 fb 21 16
         13 01 00 00 2e 00 33 00 24 00 1d 00 20 f6 f6 00 47 3c a4 35 3c




Thomson                 Expires December 1, 2018               [Page 50]

Internet-Draft               TLS 1.3 Traces                     May 2018


         8c 26 f5 93 ff bb 22 5e 18 8c 86 10 cc 06 c8 2f b7 22 62 61 1d
         99 80 24 00 2b 00 02 7f 1c

   {server}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  cd 62 00 f6 08 8d 92 e4 64 78 f0 b7 84 4c b7 14
         b2 60 d1 e9 7a a2 29 4c 6a 01 3e 64 99 80 4d 0e

      secret (32 octets):  a6 a6 c4 d4 6e fe 07 17 e7 e0 f5 4f a2 ee e0
         d6 31 d2 7f 35 28 02 54 48 49 ce e3 8b d3 23 e1 b9

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  a6 a6 c4 d4 6e fe 07 17 e7 e0 f5 4f a2 ee e0 d6
         31 d2 7f 35 28 02 54 48 49 ce e3 8b d3 23 e1 b9

      hash (32 octets):  b1 df 6d e7 d1 a3 cd 99 4e d5 f1 ca d8 d1 fa e4
         b1 50 26 1f 79 25 09 4a 06 83 e4 cc ee c0 0e 84

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 b1 df 6d e7 d1 a3 cd 99 4e d5 f1 ca d8 d1 fa
         e4 b1 50 26 1f 79 25 09 4a 06 83 e4 cc ee c0 0e 84





Thomson                 Expires December 1, 2018               [Page 51]

Internet-Draft               TLS 1.3 Traces                     May 2018


      output (32 octets):  85 31 b7 ae 39 e8 9a 99 f0 14 92 0a d7 d5 6f
         66 86 1c bc 50 06 b2 ca 8a 7c f5 4d 60 1f ee 65 5d

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  a6 a6 c4 d4 6e fe 07 17 e7 e0 f5 4f a2 ee e0 d6
         31 d2 7f 35 28 02 54 48 49 ce e3 8b d3 23 e1 b9

      hash (32 octets):  b1 df 6d e7 d1 a3 cd 99 4e d5 f1 ca d8 d1 fa e4
         b1 50 26 1f 79 25 09 4a 06 83 e4 cc ee c0 0e 84

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 b1 df 6d e7 d1 a3 cd 99 4e d5 f1 ca d8 d1 fa
         e4 b1 50 26 1f 79 25 09 4a 06 83 e4 cc ee c0 0e 84

      output (32 octets):  eb a4 fa ac 2a 14 3b 3e ad 5a b5 06 d6 e3 bb
         d3 c3 63 ff bb 79 ed 6d 46 37 12 4c d2 1d 9f 8c 26

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  a6 a6 c4 d4 6e fe 07 17 e7 e0 f5 4f a2 ee e0 d6
         31 d2 7f 35 28 02 54 48 49 ce e3 8b d3 23 e1 b9

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  67 e0 3c d5 58 c2 ab f4 50 24 ba aa be 85 25
         76 a7 f5 42 1a f3 79 92 f6 d7 1c 6b 62 e0 ac 37 0d

   {server}  extract secret "master":

      salt (32 octets):  67 e0 3c d5 58 c2 ab f4 50 24 ba aa be 85 25 76
         a7 f5 42 1a f3 79 92 f6 d7 1c 6b 62 e0 ac 37 0d

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  81 6e df 36 65 44 fc 25 f7 bc 72 8b 91 a3 68
         68 b1 bc 8e f7 4e 10 f5 8c b2 25 ce c7 86 83 b6 ec

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  eb a4 fa ac 2a 14 3b 3e ad 5a b5 06 d6 e3 bb d3
         c3 63 ff bb 79 ed 6d 46 37 12 4c d2 1d 9f 8c 26



Thomson                 Expires December 1, 2018               [Page 52]

Internet-Draft               TLS 1.3 Traces                     May 2018


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  d2 7a 50 e3 09 57 fe 66 03 ae 0d ff 0c 63
         2b 99

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  25 b7 8f 88 a3 e4 3b 5e 31 e0 1d 1b

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  eb a4 fa ac 2a 14 3b 3e ad 5a b5 06 d6 e3 bb d3
         c3 63 ff bb 79 ed 6d 46 37 12 4c d2 1d 9f 8c 26

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  79 61 8b b4 4c 2e eb 32 2c be d8 8b ac 93 75
         04 0b 2c 38 54 51 e7 88 02 0f 0d a3 a8 82 88 5d d1

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05



Thomson                 Expires December 1, 2018               [Page 53]

Internet-Draft               TLS 1.3 Traces                     May 2018


         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d
         e1 00 00 0f 00 00 84 08 04 00 80 29 e8 9c 80 b3 4a 92 05 ae 89
         70 30 fb 61 4b 26 2b b8 74 2e 2f db 94 de 68 1c 39 68 6c b4 ad
         59 20 c7 eb 00 d3 0b e5 91 e2 a3 80 7f d4 56 f7 e2 39 70 bd 39
         3a 57 81 f8 77 30 cd d3 d2 99 f7 fb 37 11 3f 24 3b b5 0e c5 8b
         13 8a c2 fc 7f e0 1f 51 14 d6 d6 21 93 3e 30 20 0e 63 ca f1 f1
         96 15 1e ba 4c b0 4f 61 e4 25 42 f6 61 7d ad 43 b6 46 1f 69 41
         84 22 42 87 1e dc d2 2c 90 00 3d 44 36 14 00 00 20 ac d7 06 24
         a4 7f 41 59 48 c7 dd 5b 7a 6b 24 9d e5 60 81 e8 1e ee 1d 36 9a
         7d 02 27 31 98 c0 e5

      ciphertext (673 octets):  17 03 03 02 9c 64 60 84 38 bf 3e e1 bc
         f3 c7 9f 34 65 da 6d e2 44 1f 69 69 1a 51 23 6a 67 6c ba d2 b5
         1e 3b f4 43 50 b4 d0 af 41 53 4b b8 16 45 64 e7 cb 99 6c 67 1d
         ec da bf 0a f1 a4 7b e4 6c ad 26 3f 9a 2b 9a 33 12 be 13 70 2b
         aa c1 87 86 62 9a 64 2e 09 fb f8 b7 3d 05 b3 13 ea 81 99 45 d6
         1e d2 cc bf 00 65 40 d6 50 62 5c 53 ee 4a da a2 4a 89 cc 2f 2b
         8c 1c 9c 50 e8 46 2d d0 b0 ab 9d 34 d7 ba 25 dd e7 7b 2e 24 f9
         0d 9e df 14 3e 08 c5 ff d1 21 84 43 dc 9f 01 38 37 c9 52 55 34
         f9 18 92 84 d4 58 aa 35 3b 5f 13 0a 46 83 ea 34 d9 d6 71 1c 86
         7c bc c9 57 dd 3b b8 92 fb ad 4e ba 4c f2 c1 c1 6b 12 66 df 72
         f8 f5 06 20 31 ca 5e 69 68 2b a4 27 9a 2a 9a 8b 8d b9 3f c1 0d
         3e 90 34 11 f9 98 59 b2 de 68 dd ce 5b 6e de b1 6c 81 c5 ab c7
         b9 16 92 55 e8 78 bd 3f 9e 02 1d 57 17 17 6c 2b 93 75 07 4c dc
         45 d6 27 ff f2 21 9f b3 4d 55 aa 83 8e fa bd 97 2c 47 57 63 44
         88 99 67 6a ce 10 d9 ed ee 08 63 f6 49 02 39 df 42 60 f8 5d e2
         c6 14 40 82 60 03 dd 8b 46 5d e6 71 f7 fb f0 8c 1c b1 20 4c e3
         7b aa 74 85 77 4f a2 94 85 85 fd ad 1f 76 08 d7 4e 37 97 b5 06
         75 83 af d5 de c4 74 34 dc e2 d3 c4 7e 2b 6f 30 4e 2b 8f 41 aa
         73 d6 42 fd 1e 9d 6e 68 f2 4e 88 96 db 4a c9 78 be 51 cf c6 e4
         0a 87 89 9e cc a4 45 5b d9 b6 41 88 71 13 31 25 ec 60 50 10 68
         92 8d d7 36 e3 68 d9 0e 1f cf 58 4e c6 15 2b 1c 36 d1 f4 c0 61
         dc af a3 af 9e fd cf 56 f6 18 8e 36 65 ab 20 a2 63 6a fb 4f 9c
         6e 5a 41 f2 eb 31 8c 8b bf 8f 8f 03 5a 5f 1a 4d 57 4d f0 9f 89
         ad 87 8c a3 4c 85 f3 f1 70 62 d9 11 cc 0b 2e 6b e7 6e 85 83 9f
         40 67 7d df 14 0f 9f 33 56 8e d1 72 60 6b 42 aa e4 c1 1c 80 10
         4c 20 ba f9 ce 02 27 d0 e7 cb bc dc 6e 9f b7 ea 77 18 32 33 91
         15 b2 bd 5c 9c 0b 7e 1d 48 14 0d 1a ab f9 59 79 4e 04 01 c8 a5
         e1 e8 4f 00 10 ba ce 70 00 3a 51 d2 8f b6 2a 95 b0 05 b6 4f 68
         12 e5 39 e2 9d 20 56 b7 89 a7 91 c3 77 87 35 2d ed 6a 51 7b 77
         99 77 a0 22 3a e4 38 4a c7 44 61 95 dd 55 b1 76 23 d5 82 90 74
         2b fa ee 2c 97 a3 ea de 1f 31 0c 8d 46 42 21 3a 9d ab 5d 49 ec



Thomson                 Expires December 1, 2018               [Page 54]

Internet-Draft               TLS 1.3 Traces                     May 2018


         26 d3 31 79 8d d7 32 16 7e c2 da 7f 06 dc ca 81 6c 90 47 56 5b
         1c ae cc cd e0 2c c9 79 63

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  81 6e df 36 65 44 fc 25 f7 bc 72 8b 91 a3 68 68
         b1 bc 8e f7 4e 10 f5 8c b2 25 ce c7 86 83 b6 ec

      hash (32 octets):  64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b ba
         91 3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b
         ba 91 3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      output (32 octets):  11 07 f5 0b 6b fe 76 f8 6f c5 11 cd 47 c7 54
         15 f5 37 a8 76 dc 5d 34 3b 30 c5 93 89 09 63 43 1d

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  81 6e df 36 65 44 fc 25 f7 bc 72 8b 91 a3 68 68
         b1 bc 8e f7 4e 10 f5 8c b2 25 ce c7 86 83 b6 ec

      hash (32 octets):  64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b ba
         91 3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b
         ba 91 3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      output (32 octets):  63 c2 55 fa a4 75 06 a5 e6 16 eb b5 f5 8e 6e
         c1 68 1c e2 a9 47 70 38 4b da 88 a8 d1 90 68 b5 98

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  81 6e df 36 65 44 fc 25 f7 bc 72 8b 91 a3 68 68
         b1 bc 8e f7 4e 10 f5 8c b2 25 ce c7 86 83 b6 ec

      hash (32 octets):  64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b ba
         91 3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 64 49 a0 de 86 de fc 34 6f 41 e0 4a 4a 59 1b ba 91
         3f c7 db 47 e2 40 07 b4 84 67 84 90 a0 0e 74

      output (32 octets):  a0 7e 7c 74 dc 0b 4c 78 12 91 73 12 d2 93 3b
         1a 41 08 72 d1 01 64 52 e1 55 5a 61 7d a0 15 ae 12




Thomson                 Expires December 1, 2018               [Page 55]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  63 c2 55 fa a4 75 06 a5 e6 16 eb b5 f5 8e 6e c1
         68 1c e2 a9 47 70 38 4b da 88 a8 d1 90 68 b5 98

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  11 fc fa c9 b0 6f 03 ee 7f 54 cc e8 02 e5
         ae c3

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2f b2 36 e6 96 05 57 1c 04 9d 50 30

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  85 31 b7 ae 39 e8 9a 99 f0 14 92 0a d7 d5 6f 66
         86 1c bc 50 06 b2 ca 8a 7c f5 4d 60 1f ee 65 5d

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  a5 6a 6e fc b0 29 c7 ab 72 d5 c0 73 10 32
         cb 68

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9f 80 a1 85 3e 3c 45 59 e6 78 45 62

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55






Thomson                 Expires December 1, 2018               [Page 56]

Internet-Draft               TLS 1.3 Traces                     May 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  cd 62 00 f6 08 8d 92 e4 64 78 f0 b7 84 4c b7 14
         b2 60 d1 e9 7a a2 29 4c 6a 01 3e 64 99 80 4d 0e

      secret (32 octets):  a6 a6 c4 d4 6e fe 07 17 e7 e0 f5 4f a2 ee e0
         d6 31 d2 7f 35 28 02 54 48 49 ce e3 8b d3 23 e1 b9

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  eb a4 fa ac 2a 14 3b 3e ad 5a b5 06 d6 e3 bb d3
         c3 63 ff bb 79 ed 6d 46 37 12 4c d2 1d 9f 8c 26

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  d2 7a 50 e3 09 57 fe 66 03 ae 0d ff 0c 63
         2b 99

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  25 b7 8f 88 a3 e4 3b 5e 31 e0 1d 1b

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires December 1, 2018               [Page 57]

Internet-Draft               TLS 1.3 Traces                     May 2018


   {client}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  85 31 b7 ae 39 e8 9a 99 f0 14 92 0a d7 d5 6f 66
         86 1c bc 50 06 b2 ca 8a 7c f5 4d 60 1f ee 65 5d

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  05 96 c6 9e 2b ce 49 04 3f 20 87 0d 8b 87 3d
         9d e0 99 af 2b 1c 68 0f 0b f8 91 00 61 18 81 1c b8

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 59 1c c2 4a 14 81 6d 71 3f 87 80
         37 01 37 17 6c ee 89 4b e3 d7 4f fc 91 79 e2 92 14 5b 71 3f d2

      ciphertext (58 octets):  17 03 03 00 35 ee 3e d5 2f c1 fc d1 b3 79
         d4 fe 69 5b e5 78 ea fe dc be 58 60 25 15 9b ed 7c 18 da 1d 39
         79 6e f6 35 8d d2 f8 14 98 f4 f3 f5 25 38 92 1f 90 5a 07 5b 97
         c1 08

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  11 07 f5 0b 6b fe 76 f8 6f c5 11 cd 47 c7 54 15
         f5 37 a8 76 dc 5d 34 3b 30 c5 93 89 09 63 43 1d

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  48 79 1e 03 ad cb 0c 8d ee 16 f2 b5 5d a5
         99 93

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00



Thomson                 Expires December 1, 2018               [Page 58]

Internet-Draft               TLS 1.3 Traces                     May 2018


      iv output (12 octets):  1d 49 a5 f7 e4 0c 6c c9 2c 33 dc 88

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  81 6e df 36 65 44 fc 25 f7 bc 72 8b 91 a3 68 68
         b1 bc 8e f7 4e 10 f5 8c b2 25 ce c7 86 83 b6 ec

      hash (32 octets):  06 39 fb 77 31 a2 b7 11 d0 13 43 21 87 21 03 69
         14 33 97 b8 7d 25 ea c7 40 c8 3a 0a f5 15 d5 91

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 06 39 fb 77 31 a2 b7 11 d0 13 43 21 87 21 03 69 14
         33 97 b8 7d 25 ea c7 40 c8 3a 0a f5 15 d5 91

      output (32 octets):  cf 28 b2 d1 ac bd 06 ff 04 7c 73 41 f0 f2 5b
         ad 2c 73 17 5d 1b f8 30 33 10 a5 5a 32 72 d5 3c 83

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 17 be 12 68 19 02 47 ff b7
         83 9f e4 92 bf da 60 ea 5b 6b

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 2a f2 cc b8 79 ee 47 73 0b
         4e 70 06 23 39 46 cf 74 9b 89

8.  Security Considerations

   It probably isn't a good idea to use the private key here.  If it
   weren't for the fact that it is too small to provide any meaningful
   security, it is now very well known.








Thomson                 Expires December 1, 2018               [Page 59]

Internet-Draft               TLS 1.3 Traces                     May 2018


9.  IANA Considerations

   This document makes no requests of IANA.

10.  References

10.1.  Normative References

   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-21 (work in progress),
              July 2017.

10.2.  Informative References

   [FIPS186]  National Institute of Standards and Technology (NIST),
              "Digital Signature Standard (DSS)", NIST PUB 186-4 , July
              2013.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

10.3.  URIs

   [1] https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS

Appendix A.  Acknowledgements

   This draft is generated using tests that were written for NSS [1].
   None of this would have been possible without Franziskus Kiefer, Eric
   Rescorla and Tim Taubert, who did a lot of the work in NSS.

Author's Address

   Martin Thomson
   Mozilla

   Email: martin.thomson@gmail.com













Thomson                 Expires December 1, 2018               [Page 60]
