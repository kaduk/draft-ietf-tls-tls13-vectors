



TLS                                                           M. Thomson
Internet-Draft                                                   Mozilla
Intended status: Standards Track                        December 5, 2017
Expires: June 8, 2018


                  Example Handshake Traces for TLS 1.3
                  draft-ietf-tls-tls13-vectors-latest

Abstract

   Examples of TLS 1.3 handshakes are shown.  Private keys and inputs
   are provided so that these handshakes might be reproduced.
   Intermediate values, including secrets, traffic keys and ivs are
   shown so that implementations might be checked incrementally against
   these values.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on June 8, 2018.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Thomson                   Expires June 8, 2018                  [Page 1]

Internet-Draft               TLS 1.3 Traces                December 2017


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Private Keys  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Simple 1-RTT Handshake  . . . . . . . . . . . . . . . . . . .   3
   4.  Resumed 0-RTT Handshake . . . . . . . . . . . . . . . . . . .  15
   5.  HelloRetryRequest . . . . . . . . . . . . . . . . . . . . . .  26
   6.  Client Authentication . . . . . . . . . . . . . . . . . . . .  38
   7.  Compatibility Mode  . . . . . . . . . . . . . . . . . . . . .  49
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  59
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  59
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  59
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  60
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .  60
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  60

1.  Introduction

   TLS 1.3 [TLS13] defines a new key schedule and a number new
   cryptographic operations.  This document includes sample handshakes
   that show all intermediate values.  This allows an implementation to
   be verified incrementally, examining inputs and outputs of each
   cryptographic computation independently.

   A private key is included with the traces so that implementations can
   be checked by importing these values and verifying that the same
   outputs are produced.

2.  Private Keys

   Ephemeral private keys are shown as they are generated in the traces.

   The server in most examples uses an RSA certificate with a private
   key of:

   modulus (public):  b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c
      0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab
      bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
      a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f
      da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0
      3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e
      3f

   public exponent:  01 00 01

   private exponent:  04 de a7 05 d4 3a 6e a7 20 9d d8 07 21 11 a8 3c 81
      e3 22 a5 92 78 b3 34 80 64 1e af 7c 0a 69 85 b8 e3 1c 44 f6 de 62
      e1 b4 c2 30 9f 61 26 e7 7b 7c 41 e9 23 31 4b bf a3 88 13 05 dc 12



Thomson                   Expires June 8, 2018                  [Page 2]

Internet-Draft               TLS 1.3 Traces                December 2017


      17 f1 6c 81 9c e5 38 e9 22 f3 69 82 8d 0e 57 19 5d 8c 84 88 46 02
      07 b2 fa a7 26 bc f7 08 bb d7 db 7f 67 9f 89 34 92 fc 2a 62 2e 08
      97 0a ac 44 1c e4 e0 c3 08 8d f2 5a e6 79 23 3d f8 a3 bd a2 ff 99
      41

   prime1:  e4 35 fb 7c c8 37 37 75 6d ac ea 96 ab 7f 59 a2 cc 10 69 db
      7d eb 19 0e 17 e3 3a 53 2b 27 3f 30 a3 27 aa 0a aa bc 58 cd 67 46
      6a f9 84 5f ad c6 75 fe 09 4a f9 2c 4b d1 f2 c1 bc 33 dd 2e 05 15

   prime2:  ca bd 3b c0 e0 43 86 64 c8 d4 cc 9f 99 97 7a 94 d9 bb fe ad
      8e 43 87 0a ba e3 f7 eb 8b 4e 0e ee 8a f1 d9 b4 71 9b a6 19 6c f2
      cb ba ee eb f8 b3 49 0a fe 9e 9f fa 74 a8 8a a5 1f c6 45 62 93 03

   exponent1:  3f 57 34 5c 27 fe 1b 68 7e 6e 76 16 27 b7 8b 1b 82 64 33
      dd 76 0f a0 be a6 a6 ac f3 94 90 aa 1b 47 cd a4 86 9d 68 f5 84 dd
      5b 50 29 bd 32 09 3b 82 58 66 1f e7 15 02 5e 5d 70 a4 5a 08 d3 d3
      19

   exponent2:  18 3d a0 13 63 bd 2f 28 85 ca cb dc 99 64 bf 47 64 f1 51
      76 36 f8 64 01 28 6f 71 89 3c 52 cc fe 40 a6 c2 3d 0d 08 6b 47 c6
      fb 10 d8 fd 10 41 e0 4d ef 7e 9a 40 ce 95 7c 41 77 94 e1 04 12 d1
      39

   coefficient:  83 9c a9 a0 85 e4 28 6b 2c 90 e4 66 99 7a 2c 68 1f 21
      33 9a a3 47 78 14 e4 de c1 18 33 05 0e d5 0d d1 3c c0 38 04 8a 43
      c5 9b 2a cc 41 68 89 c0 37 66 5f e5 af a6 05 96 9f 8c 01 df a5 ca
      96 9d

3.  Simple 1-RTT Handshake

   In this example, the simplest possible handshake is completed.  The
   server is authenticated, but the client remains anonymous.  After
   connecting, a few application data octets are exchanged.  The server
   sends a session ticket that permits the use of 0-RTT in any resumed
   session.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  7d 29 70 43 e7 64 42 c0 ef 42 80 a6 22
         bd 1f 71 62 bf 3f ee 6f 6d ed 9e a3 30 a7 84 3c 0a 9f e8

      public key (32 octets):  36 c7 0b 78 b3 06 2e aa ae 92 57 c2 3d c2
         8f 95 1c 38 71 03 68 17 08 6e 68 73 13 e2 33 04 1d 6a

   {client}  send a ClientHello handshake message

   {client}  send handshake record:




Thomson                   Expires June 8, 2018                  [Page 3]

Internet-Draft               TLS 1.3 Traces                December 2017


      payload (190 octets):  01 00 00 ba 03 03 dc cb 39 95 a7 11 09 9a
         f6 b0 1a 3b 45 d1 3b 82 d4 c2 dd 82 38 54 44 78 c4 bb 28 f2 49
         ce 61 7d 00 00 06 13 01 13 03 13 02 01 00 00 8b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23 00
         00 00 28 00 26 00 24 00 1d 00 20 36 c7 0b 78 b3 06 2e aa ae 92
         57 c2 3d c2 8f 95 1c 38 71 03 68 17 08 6e 68 73 13 e2 33 04 1d
         6a 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01

      ciphertext (195 octets):  16 03 01 00 be 01 00 00 ba 03 03 dc cb
         39 95 a7 11 09 9a f6 b0 1a 3b 45 d1 3b 82 d4 c2 dd 82 38 54 44
         78 c4 bb 28 f2 49 ce 61 7d 00 00 06 13 01 13 03 13 02 01 00 00
         8b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 23 00 00 00 28 00 26 00 24 00 1d 00 20 36 c7 0b 78
         b3 06 2e aa ae 92 57 c2 3d c2 8f 95 1c 38 71 03 68 17 08 6e 68
         73 13 e2 33 04 1d 6a 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  7e bd 5c 2e f9 2e de fa 3f 1d 8d 50 51
         c3 a8 f7 c6 f9 a7 48 d0 92 24 06 9d bc b1 14 72 28 c3 34

      public key (32 octets):  c8 42 27 b9 73 ce 98 25 91 60 6c 6a 4d 55
         04 fa eb 78 0f ae 6a 49 cc 99 8d 87 fc 72 dc 57 d3 37

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a





Thomson                   Expires June 8, 2018                  [Page 4]

Internet-Draft               TLS 1.3 Traces                December 2017


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  f4 02 11 84 d2 9e fd f0 34 93 5d 46 50 79 b7 8b
         be 8a 4d 71 d7 f6 2b d8 3a cb d4 47 6e 76 0d 74

      secret (32 octets):  06 36 3a 31 ca bb d6 c1 86 ba d1 4f 06 54 cc
         8b 8c ae 81 2b c5 4c a9 88 e6 7a 24 ff 80 47 80 5c

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  06 36 3a 31 ca bb d6 c1 86 ba d1 4f 06 54 cc 8b
         8c ae 81 2b c5 4c a9 88 e6 7a 24 ff 80 47 80 5c

      hash (32 octets):  55 42 cf b0 5d c6 89 5d 98 15 e8 71 37 82 c8 61
         f5 ae 28 a2 3e 40 3b 6c d5 a1 a9 63 ea 51 1b 5d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 55 42 cf b0 5d c6 89 5d 98 15 e8 71 37 82 c8
         61 f5 ae 28 a2 3e 40 3b 6c d5 a1 a9 63 ea 51 1b 5d

      output (32 octets):  c7 55 cf 50 47 ef d0 2a 1d f4 f0 21 9e 7c 8c
         07 ce 94 05 b8 b2 50 4f 82 99 6f 49 82 71 70 54 46

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  06 36 3a 31 ca bb d6 c1 86 ba d1 4f 06 54 cc 8b
         8c ae 81 2b c5 4c a9 88 e6 7a 24 ff 80 47 80 5c

      hash (32 octets):  55 42 cf b0 5d c6 89 5d 98 15 e8 71 37 82 c8 61
         f5 ae 28 a2 3e 40 3b 6c d5 a1 a9 63 ea 51 1b 5d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 55 42 cf b0 5d c6 89 5d 98 15 e8 71 37 82 c8
         61 f5 ae 28 a2 3e 40 3b 6c d5 a1 a9 63 ea 51 1b 5d




Thomson                   Expires June 8, 2018                  [Page 5]

Internet-Draft               TLS 1.3 Traces                December 2017


      output (32 octets):  df 65 97 4b 9c 16 95 ee 7b 85 d4 47 c6 34 26
         cc ab 9a 2a ec 8b 52 77 a7 96 02 2e 87 21 4d 40 59

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  06 36 3a 31 ca bb d6 c1 86 ba d1 4f 06 54 cc 8b
         8c ae 81 2b c5 4c a9 88 e6 7a 24 ff 80 47 80 5c

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  c8 77 db 8a d8 10 d5 ae 89 91 ae 42 ac 94 aa
         c6 56 81 94 1e 9e 8c d3 b2 e7 c8 a0 c9 6a 5d 84 84

   {server}  extract secret "master":

      salt (32 octets):  c8 77 db 8a d8 10 d5 ae 89 91 ae 42 ac 94 aa c6
         56 81 94 1e 9e 8c d3 b2 e7 c8 a0 c9 6a 5d 84 84

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  ae 75 d6 4b f8 58 03 fb 05 be e8 50 25 ad f4
         94 e7 af b6 68 33 0c 5b 79 4a 89 91 00 49 d6 07 a2

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 b3 24 f3 ad b5 6c 97 b7 37
         d6 2e 35 99 a8 95 6b eb de cd b9 97 4e 19 a1 eb 22 2c bd 30 c9
         e6 ae 00 13 01 00 00 2e 00 28 00 24 00 1d 00 20 c8 42 27 b9 73
         ce 98 25 91 60 6c 6a 4d 55 04 fa eb 78 0f ae 6a 49 cc 99 8d 87
         fc 72 dc 57 d3 37 00 2b 00 02 7f 16

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 b3 24 f3
         ad b5 6c 97 b7 37 d6 2e 35 99 a8 95 6b eb de cd b9 97 4e 19 a1
         eb 22 2c bd 30 c9 e6 ae 00 13 01 00 00 2e 00 28 00 24 00 1d 00
         20 c8 42 27 b9 73 ce 98 25 91 60 6c 6a 4d 55 04 fa eb 78 0f ae
         6a 49 cc 99 8d 87 fc 72 dc 57 d3 37 00 2b 00 02 7f 16

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  df 65 97 4b 9c 16 95 ee 7b 85 d4 47 c6 34 26 cc
         ab 9a 2a ec 8b 52 77 a7 96 02 2e 87 21 4d 40 59




Thomson                   Expires June 8, 2018                  [Page 6]

Internet-Draft               TLS 1.3 Traces                December 2017


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  fa bd 9b 51 d3 ea a2 54 af b2 77 d2 f0 a3
         6e ff

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  37 dd 46 77 b2 86 16 4a 12 b4 40 c6

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  df 65 97 4b 9c 16 95 ee 7b 85 d4 47 c6 34 26 cc
         ab 9a 2a ec 8b 52 77 a7 96 02 2e 87 21 4d 40 59

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  02 c9 fa 48 8a 7e 0a be 88 a6 91 d7 0c ac cf
         17 9d f7 83 4d 68 da 67 63 5d 6d 17 82 ba 24 8a 47

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05



Thomson                   Expires June 8, 2018                  [Page 7]

Internet-Draft               TLS 1.3 Traces                December 2017


         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d
         e1 00 00 0f 00 00 84 08 04 00 80 44 eb 42 93 91 e8 0f f7 7f 37
         71 11 7a 02 d4 da cd 45 90 55 ca e4 68 21 c5 68 9a 86 00 d7 3c
         78 67 85 50 e9 c1 c3 cf 44 d8 76 a9 b3 2f 46 c4 fa 6f 5b 6a 40
         53 f8 7e 75 9a f1 40 ce 9d c2 92 ef e7 d9 a5 7b 1e 9e 87 33 65
         46 78 d5 7d 21 49 e0 eb 2d c2 2f a5 ef 83 03 29 7c 07 54 7a 68
         0f b2 1f cd e7 76 c7 d6 b9 e1 aa 6d 13 58 2a 2c 6b e1 b8 c3 78
         64 50 a3 19 69 f0 a5 39 54 51 25 3d 01 14 00 00 20 f2 41 5b ea
         b6 52 73 3c df 01 32 60 4c e9 55 38 86 36 7b ac 08 fd ea fd 69
         9b 41 42 1b f6 8a ba

      ciphertext (673 octets):  17 03 03 02 9c 3f 32 88 bd e8 25 69 3a
         80 c2 06 e5 29 12 e6 13 63 04 d6 8e 5e 00 a2 ed d5 72 13 ed cf
         a2 8c 75 33 86 68 1a b7 5b bb 25 7a 06 55 21 7c e7 92 2c 3d ec
         42 c4 1f 84 87 a0 38 bf e4 a4 14 9a d7 06 18 19 ff f9 21 5c bd
         96 8b a3 c6 1e ec c9 02 00 29 61 81 e5 12 e4 89 49 46 80 98 01
         a1 91 99 90 2d 25 6d cd 88 d4 9b 2b 43 e8 29 49 c4 3f e0 0f 65
         e8 43 16 f5 31 02 9c ce b2 e2 29 85 f1 a1 63 13 95 4a 4b d4 51
         0f ba 82 08 f7 51 1a 22 4f 2f 71 12 24 6a 55 4e 3c 0f fd 90 cd
         41 05 e3 a4 38 7a 25 f1 f3 ab 8b 31 df 3e 19 aa 38 cb 02 fb a0
         90 e5 a6 be 4e 7a ee 91 ba c2 57 85 e4 ed ab 60 3f 2b 71 3a b6
         e5 02 f6 7c c8 2d 57 16 13 8a d2 c5 a3 16 16 a5 e7 bf 19 28 45
         79 4e 97 22 38 eb 74 4c 63 3a 14 85 f6 38 6d 10 5f 81 9d 33 92
         38 84 cf bb 6d a7 db 04 8d 4f f6 a1 2d 87 52 89 a7 32 53 3e c4
         3b 5c 38 cc a6 34 ee 39 21 36 cc c3 fe 55 59 21 cf 36 d8 56 c6
         fd 97 2e 5f be df 44 83 c5 9e 18 1d 9e 5f 07 e3 2f 4a 39 b6 6d
         02 b0 a8 8b ab 8c 76 da f5 28 a4 c3 75 0a da 3a 8a 16 c5 83 3c
         3f 0d 76 d7 6c a8 38 61 ab 73 8f 47 22 f8 4e 34 59 09 8d b7 4b
         94 5e 01 31 5b 1c ed 91 25 0d e2 b6 fa 43 d0 74 27 9e cc 03 bc
         31 78 59 e6 71 3b 37 9b 9b 7e 0f 19 f6 6a 5c 9f 67 3b c7 ae 29
         ab 2e 0f e4 ea 22 18 d8 fe 4d 18 8c b8 6d 3e 80 98 79 8c 28 d4
         e7 61 1f ee 8a 0d ba f3 6a 71 ee 1b 92 74 09 3d b2 d5 5f d2 86
         37 4b 25 32 a9 2d 18 fe 5a e4 47 20 94 f7 93 c3 f7 2f 84 88 f4
         c3 f3 06 ad b3 6c dd 16 2a f7 7b 01 65 33 26 65 03 67 cf 70 b8
         da a4 2b 1b 15 0e 28 88 78 3c 10 e5 d2 8f fe 46 bf 9a fa e1 bd
         4f ef 0a c9 12 f9 1d 66 89 e9 12 9d 03 32 4b 8a 0b 06 7c f7 4f
         af ba a6 b4 f6 e8 fe ba 7f cf 13 72 a2 dd c6 9d 4a 98 d2 89 8c
         44 18 01 fb 9c 63 34 82 b3 95 fa bc 65 8e 1e 49 3f 55 cd 42 07
         4f 56 6b 86 a5 fd 58 58 c7 33 89 d3 26 cc eb 3e d5 2b 02 83 92
         7c 5e 58 f0 1c 36 e0 02 85 d2 ea 13 03 79 1a 2a 3f 51 0b 0a 0a
         b4 f9 87 16 07 10 6a 21 7f b7 6d 31 28 40 6e b3 22 35 e5 3a cc
         17 29 95 fb 4f 18 54 5e 23 33 0a 18 52 2c 3a 14 b8 54 76 65 2f



Thomson                   Expires June 8, 2018                  [Page 8]

Internet-Draft               TLS 1.3 Traces                December 2017


         45 2e d2 23 bb df da 47 d4 20 e0 2d 5f f8 e5 c1 65 73 e6 82 04
         f9 1f 78 06 61 32 77 31 18

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  ae 75 d6 4b f8 58 03 fb 05 be e8 50 25 ad f4 94
         e7 af b6 68 33 0c 5b 79 4a 89 91 00 49 d6 07 a2

      hash (32 octets):  48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6 14
         c4 e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6
         14 c4 e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      output (32 octets):  6d 19 9a eb e4 49 c8 37 46 d9 db 15 67 c0 74
         9f 59 f9 88 1c 30 74 ea a3 30 a8 d7 f0 c7 24 ea a3

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  ae 75 d6 4b f8 58 03 fb 05 be e8 50 25 ad f4 94
         e7 af b6 68 33 0c 5b 79 4a 89 91 00 49 d6 07 a2

      hash (32 octets):  48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6 14
         c4 e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6
         14 c4 e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      output (32 octets):  c7 ff 45 8f 17 c5 b9 45 a2 75 b1 e2 e1 93 32
         82 53 32 e5 85 fe 6e 84 e5 2b a3 ce 56 04 67 5c f1

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  ae 75 d6 4b f8 58 03 fb 05 be e8 50 25 ad f4 94
         e7 af b6 68 33 0c 5b 79 4a 89 91 00 49 d6 07 a2

      hash (32 octets):  48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6 14
         c4 e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 48 da c2 ae 03 23 ee 2f aa e7 03 a4 2f da e6 14 c4
         e3 6f 00 d9 52 ad 7d 45 be 5f fc 5e a4 11 be

      output (32 octets):  b9 cc a8 1d b5 95 f0 f4 66 78 c5 cd 3b 29 ef
         f6 68 8a 6c 53 12 88 7f b5 5f 9c 5d 43 06 ce db 12




Thomson                   Expires June 8, 2018                  [Page 9]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  c7 ff 45 8f 17 c5 b9 45 a2 75 b1 e2 e1 93 32 82
         53 32 e5 85 fe 6e 84 e5 2b a3 ce 56 04 67 5c f1

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  20 8b 15 6f d5 bb fa eb 74 81 80 94 85 fd
         12 ac

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c3 ee 89 4a a1 b3 3f 9d fe e8 d6 cf

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  c7 55 cf 50 47 ef d0 2a 1d f4 f0 21 9e 7c 8c 07
         ce 94 05 b8 b2 50 4f 82 99 6f 49 82 71 70 54 46

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  a7 1d 22 6b d3 99 15 76 d4 90 e7 3d fd e4
         c2 bc

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  59 c7 e8 46 2e 87 32 cb e4 c8 6c a7

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55






Thomson                   Expires June 8, 2018                 [Page 10]

Internet-Draft               TLS 1.3 Traces                December 2017


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  f4 02 11 84 d2 9e fd f0 34 93 5d 46 50 79 b7 8b
         be 8a 4d 71 d7 f6 2b d8 3a cb d4 47 6e 76 0d 74

      secret (32 octets):  06 36 3a 31 ca bb d6 c1 86 ba d1 4f 06 54 cc
         8b 8c ae 81 2b c5 4c a9 88 e6 7a 24 ff 80 47 80 5c

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  df 65 97 4b 9c 16 95 ee 7b 85 d4 47 c6 34 26 cc
         ab 9a 2a ec 8b 52 77 a7 96 02 2e 87 21 4d 40 59

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  fa bd 9b 51 d3 ea a2 54 af b2 77 d2 f0 a3
         6e ff

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  37 dd 46 77 b2 86 16 4a 12 b4 40 c6

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                   Expires June 8, 2018                 [Page 11]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  c7 55 cf 50 47 ef d0 2a 1d f4 f0 21 9e 7c 8c 07
         ce 94 05 b8 b2 50 4f 82 99 6f 49 82 71 70 54 46

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  7a c5 3f c2 a4 a8 08 d8 77 e5 84 be b7 d3 06
         8f 11 6b a3 d2 b3 77 d6 77 bb 3a 34 b4 19 ac fe 45

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 48 b4 25 1d fc 05 ca af 11 99 81
         2e ff 73 7d f8 80 65 fb 00 ab 0a 4b 7b 8e 71 13 03 74 55 a4 ce

      ciphertext (58 octets):  17 03 03 00 35 08 b0 a0 b5 8e b5 b5 2b c1
         fb 00 da 8f d2 04 f8 75 53 a9 e2 17 13 d9 5e ae 58 fc df 19 24
         a8 db cd b1 cf 58 1a 90 48 e1 30 e9 12 34 e2 b8 1c e4 7a 9d 2c
         7f fc

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  6d 19 9a eb e4 49 c8 37 46 d9 db 15 67 c0 74 9f
         59 f9 88 1c 30 74 ea a3 30 a8 d7 f0 c7 24 ea a3

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  ed 73 ec 07 ad 55 a2 2e d8 f2 de 21 ec 28
         6a c9

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  52 fd 83 8b 8d 31 b5 fb 89 32 04 15

   {client}  derive secret "tls13 res master":





Thomson                   Expires June 8, 2018                 [Page 12]

Internet-Draft               TLS 1.3 Traces                December 2017


      PRK (32 octets):  ae 75 d6 4b f8 58 03 fb 05 be e8 50 25 ad f4 94
         e7 af b6 68 33 0c 5b 79 4a 89 91 00 49 d6 07 a2

      hash (32 octets):  a8 19 00 51 c9 e9 59 c6 d7 87 74 15 96 e7 8c 49
         52 2b d5 92 1f 44 96 e1 69 0c c0 07 a3 9f b3 bd

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 a8 19 00 51 c9 e9 59 c6 d7 87 74 15 96 e7 8c 49 52
         2b d5 92 1f 44 96 e1 69 0c c0 07 a3 9f b3 bd

      output (32 octets):  5a 8f 15 b3 a6 59 a9 0f b5 6d d6 3a b1 d2 8d
         3c 56 b4 ea 12 97 a6 2a 37 58 ac 45 34 d1 81 38 79

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {server}  generate resumption secret "tls13 resumption":

      PRK (32 octets):  5a 8f 15 b3 a6 59 a9 0f b5 6d d6 3a b1 d2 8d 3c
         56 b4 ea 12 97 a6 2a 37 58 ac 45 34 d1 81 38 79

      hash (2 octets):  00 00

      info (22 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 75 6d 70 74
         69 6f 6e 02 00 00

      output (32 octets):  ed 64 f9 dd d1 6d 7c 1b 4e 9a 89 2f 36 8b c9
         23 d2 cd 18 cf 8e 12 79 01 a9 0e f5 a6 e7 4a 9e ce

   {server}  send a NewSessionTicket handshake message

   {server}  send handshake record:

      payload (205 octets):  04 00 00 c9 00 00 00 1e ee 21 aa 31 02 00
         00 00 b2 2b 0d ef f5 d2 49 c0 12 3c e9 76 4e 00 00 00 00 3d 36
         87 f8 81 8d 8f bd c9 45 6d ea 3e 46 48 77 00 70 e8 86 0e 3f 48
         47 c6 c2 b6 a4 87 c8 50 7f 43 73 fd 98 d0 ac 94 35 e0 d6 c7 ae
         04 2a a4 86 fa b2 05 9c 17 b7 b1 6c e6 97 16 bf d4 df df 7c 0c
         35 7d c3 95 bc f8 2e 2f 11 13 78 fa f7 bc 92 a9 96 4e 82 f4 52
         99 8a 2b c1 f2 e9 44 c0 df 55 9f 0c eb c8 d1 d4 1f 15 a8 ab 5a
         15 66 b3 51 bf 25 21 9d b2 46 53 60 11 2e 52 fb 8b 02 4f 11 6b
         e3 91 48 46 c9 b4 53 8d fa 8e 0d 29 2c 60 d0 d0 31 fd 55 54 cf
         55 41 90 86 03 c7 c8 2d 46 87 75 9c e5 00 08 00 2a 00 04 00 00
         04 00



Thomson                   Expires June 8, 2018                 [Page 13]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (227 octets):  17 03 03 00 de 5a b8 1c e5 56 e2 d6 50
         78 ed 62 31 bc 3f 20 a6 ba 9c 74 fd b3 da e7 4f b3 f7 5d 6c 20
         aa 50 14 47 8d bd 38 ec d7 27 75 54 b2 24 ca 4a b5 6a c9 45 56
         48 21 48 c0 fb 4e 64 d2 f4 5b 7a dc 08 53 6e d0 7d 13 ed 5e f2
         f3 a2 0e e1 e0 78 bd 3e e4 df e2 da e7 60 8e 5b c4 5a 9d 1b 18
         cd f2 63 86 2d b3 ab 7a be 2d eb 54 62 65 25 85 94 b3 f4 bf 43
         d7 b2 e8 92 d4 cf 58 0b c1 1f cf 5f 62 fe 8b 87 93 a9 c3 5d ac
         cf c1 e2 7d 12 2e 52 17 c9 27 2f 15 f0 cf 6d bc 62 81 0b b9 ce
         76 81 aa 8e 88 b0 4c b5 80 51 e6 19 cb 90 7b ee 23 8f 3a 62 d6
         b1 25 44 54 1c ee 67 b5 84 31 5e 26 9d fa 9c 5a cc c8 ec 24 e8
         c3 c3 40 28 47 60 ca cb 5b 89 a1 99 84 53 72 b5 cd ed 45 13 76
         60 08 2a 6e

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 93 04 d9 ad ab a5 6a ee a0
         27 b1 7c 98 46 55 e3 8f 06 89 c5 16 e5 f3 6b b9 b3 1a 4c 96 7b
         20 ba 22 cc da a7 6c 8f 56 69 13 ad ac 87 d1 28 b2 3e e9 e3 22
         7c 7f 8c 90 6e a3 64 0a a7 d5 93 2a 24 f8 26 23

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 4f 30 fd 68 e4 b7 64 ae bf
         00 64 a0 09 9d e6 d4 eb 60 7f e0 dd 4b 76 ee 7f 1d 56 df f5 a4
         f4 c4 8e c8 d6 cb 26 06 e1 aa ef 1f 81 bc d0 70 a2 2a 9c 18 bf
         72 9b 6f 92 f4 fe 1a 5b 56 6b 54 54 d5 e7 a8 49

   {client}  generate resumption secret "tls13 resumption" (same as
      server)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 9f 2b a9 84 17 f8 5b 68 d6
         ac 06 a9 84 3c d6 d1 47 37 65

   {server}  send alert record:

      payload (2 octets):  01 00



Thomson                   Expires June 8, 2018                 [Page 14]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (24 octets):  17 03 03 00 13 b6 b0 47 f0 98 ec 97 55 c5
         a2 49 b5 28 68 f2 1c ef 41 fe

4.  Resumed 0-RTT Handshake

   This handshake resumes from the handshake in Section 3.  Since the
   server provided a session ticket that permitted 0-RTT, and the client
   is configured for 0-RTT, the client is able to send 0-RTT data.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  74 cc 92 a6 eb 48 3a 19 86 d6 e1 78 54
         80 bb df 9a 21 ba b9 83 34 67 a6 4e 3d 19 e5 84 5c e8 93

      public key (32 octets):  a8 cf e9 f1 a9 50 4d 75 db 11 52 7f d0 19
         0a f7 3c f2 2b 7b 88 97 97 57 10 58 ec 58 2d 74 f4 21

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  ed 64 f9 dd d1 6d 7c 1b 4e 9a 89 2f 36 8b c9 23
         d2 cd 18 cf 8e 12 79 01 a9 0e f5 a6 e7 4a 9e ce

      secret (32 octets):  ff af c2 3b 1c 6a ad a5 3b 20 df e8 cf c1 38
         1d f7 7f 40 fc 98 30 a7 10 72 69 d7 54 49 c4 2f df

   {client}  send a ClientHello handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  ca 43 d4 e9 c8 62 2d 2d b7 3f 4c d5 92 04 4d cc
         0a 0b 73 5d 9d ef 90 7f 80 c3 f1 7c 7d f6 e6 56

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  35 e1 e2 25 73 aa f7 f0 d4 08 db 19 6a 8c eb
         79 66 58 c1 50 a5 6f d2 b0 b2 8b f6 85 eb 6c 90 6f

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 1f 60 1d 5c 43 7f 38 6c
         3c 50 8d 74 82 32 8d 9c 45 77 54 b8 4e 3c 4e 5e b7 07 35 2e 43
         29 43 ef 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12



Thomson                   Expires June 8, 2018                 [Page 15]

Internet-Draft               TLS 1.3 Traces                December 2017


         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 28 00
         26 00 24 00 1d 00 20 a8 cf e9 f1 a9 50 4d 75 db 11 52 7f d0 19
         0a f7 3c f2 2b 7b 88 97 97 57 10 58 ec 58 2d 74 f4 21 00 2a 00
         00 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 29 00 dd 00 b8 00 b2 2b 0d ef f5 d2 49 c0 12 3c e9 76 4e 00
         00 00 00 3d 36 87 f8 81 8d 8f bd c9 45 6d ea 3e 46 48 77 00 70
         e8 86 0e 3f 48 47 c6 c2 b6 a4 87 c8 50 7f 43 73 fd 98 d0 ac 94
         35 e0 d6 c7 ae 04 2a a4 86 fa b2 05 9c 17 b7 b1 6c e6 97 16 bf
         d4 df df 7c 0c 35 7d c3 95 bc f8 2e 2f 11 13 78 fa f7 bc 92 a9
         96 4e 82 f4 52 99 8a 2b c1 f2 e9 44 c0 df 55 9f 0c eb c8 d1 d4
         1f 15 a8 ab 5a 15 66 b3 51 bf 25 21 9d b2 46 53 60 11 2e 52 fb
         8b 02 4f 11 6b e3 91 48 46 c9 b4 53 8d fa 8e 0d 29 2c 60 d0 d0
         31 fd 55 54 cf 55 41 90 86 03 c7 c8 2d 46 87 75 9c e5 ee 21 aa
         36 00 21 20 2e 9f 25 1c 82 6a 3e 83 b6 94 f1 4f ac 63 3c c6 c3
         e7 8a 81 6a 3e 49 ff 44 78 8a 74 27 90 53 30

      ciphertext (517 octets):  16 03 01 02 00 01 00 01 fc 03 03 1f 60
         1d 5c 43 7f 38 6c 3c 50 8d 74 82 32 8d 9c 45 77 54 b8 4e 3c 4e
         5e b7 07 35 2e 43 29 43 ef 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 28 00 26 00 24 00 1d 00 20 a8 cf e9 f1 a9 50 4d 75
         db 11 52 7f d0 19 0a f7 3c f2 2b 7b 88 97 97 57 10 58 ec 58 2d
         74 f4 21 00 2a 00 00 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 15 00 5d 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 29 00 dd 00 b8 00 b2 2b 0d ef f5 d2 49 c0
         12 3c e9 76 4e 00 00 00 00 3d 36 87 f8 81 8d 8f bd c9 45 6d ea
         3e 46 48 77 00 70 e8 86 0e 3f 48 47 c6 c2 b6 a4 87 c8 50 7f 43
         73 fd 98 d0 ac 94 35 e0 d6 c7 ae 04 2a a4 86 fa b2 05 9c 17 b7
         b1 6c e6 97 16 bf d4 df df 7c 0c 35 7d c3 95 bc f8 2e 2f 11 13
         78 fa f7 bc 92 a9 96 4e 82 f4 52 99 8a 2b c1 f2 e9 44 c0 df 55
         9f 0c eb c8 d1 d4 1f 15 a8 ab 5a 15 66 b3 51 bf 25 21 9d b2 46
         53 60 11 2e 52 fb 8b 02 4f 11 6b e3 91 48 46 c9 b4 53 8d fa 8e
         0d 29 2c 60 d0 d0 31 fd 55 54 cf 55 41 90 86 03 c7 c8 2d 46 87
         75 9c e5 ee 21 aa 36 00 21 20 2e 9f 25 1c 82 6a 3e 83 b6 94 f1
         4f ac 63 3c c6 c3 e7 8a 81 6a 3e 49 ff 44 78 8a 74 27 90 53 30




Thomson                   Expires June 8, 2018                 [Page 16]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  derive secret "tls13 c e traffic":

      PRK (32 octets):  ff af c2 3b 1c 6a ad a5 3b 20 df e8 cf c1 38 1d
         f7 7f 40 fc 98 30 a7 10 72 69 d7 54 49 c4 2f df

      hash (32 octets):  a6 55 71 c3 5d ee 0d b1 d9 50 ba f4 f7 a9 c2 87
         41 7e 27 9f cb 4c f2 88 3c eb 9d 34 64 77 00 3e

      info (53 octets):  00 20 11 74 6c 73 31 33 20 63 20 65 20 74 72 61
         66 66 69 63 20 a6 55 71 c3 5d ee 0d b1 d9 50 ba f4 f7 a9 c2 87
         41 7e 27 9f cb 4c f2 88 3c eb 9d 34 64 77 00 3e

      output (32 octets):  21 3d 62 f4 b8 cc 8a 34 08 6e 38 50 3c aa 28
         f2 f1 6d 7e 08 68 59 94 76 12 46 16 ad 95 f7 d5 a4

   {client}  derive write traffic keys for early application data:

      PRK (32 octets):  21 3d 62 f4 b8 cc 8a 34 08 6e 38 50 3c aa 28 f2
         f1 6d 7e 08 68 59 94 76 12 46 16 ad 95 f7 d5 a4

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b4 63 ff 96 9e 6f 07 22 4f 1e ed 40 c0 d6
         93 49

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  25 55 49 f1 1e 70 3f b6 45 4c 79 0f

   {client}  send application_data record:

      payload (6 octets):  41 42 43 44 45 46

      ciphertext (28 octets):  17 03 03 00 17 5d fb 14 46 c7 36 e1 5b 69
         7a 96 d9 d6 ab 3d ec e5 70 1d a6 03 fe 45

   {server}  extract secret "early" (same as client)

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  b3 79 c4 b9 88 83 ed 5d 66 79 38 ce fe
         3d 1e be 16 48 59 0b fb f4 0f 1c c0 25 5e 64 f5 73 65 d8

      public key (32 octets):  97 0d 07 3f 5d a9 af 35 85 8e 3c 1f c1 55
         b9 29 f9 52 03 51 ee 8f 87 91 db ae a3 33 84 dc 13 0b




Thomson                   Expires June 8, 2018                 [Page 17]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  derive secret "tls13 c e traffic" (same as client)

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  ff af c2 3b 1c 6a ad a5 3b 20 df e8 cf c1 38 1d
         f7 7f 40 fc 98 30 a7 10 72 69 d7 54 49 c4 2f df

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  9c b0 77 04 dc 55 9d a4 d6 04 7d 55 4f 8b 4d
         5e 30 80 bb cf c6 85 31 8d 72 f8 99 45 cf 38 cc e0

   {server}  extract secret "handshake":

      salt (32 octets):  9c b0 77 04 dc 55 9d a4 d6 04 7d 55 4f 8b 4d 5e
         30 80 bb cf c6 85 31 8d 72 f8 99 45 cf 38 cc e0

      ikm (32 octets):  3f 9a c0 6a 0a 29 1a cd 72 23 fe 9c 88 f8 ea 8d
         6a ff c4 71 00 45 3f 96 21 8a 08 11 50 07 09 45

      secret (32 octets):  59 57 85 f0 45 d7 71 33 30 84 5b 68 8a 94 85
         2e fe d8 a5 45 b1 60 b9 1e 8c 55 37 8d 66 f6 a9 20

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  59 57 85 f0 45 d7 71 33 30 84 5b 68 8a 94 85 2e
         fe d8 a5 45 b1 60 b9 1e 8c 55 37 8d 66 f6 a9 20

      hash (32 octets):  02 34 5f 16 64 59 f8 93 a5 7e 95 06 77 64 25 5b
         d8 5e da cb 48 97 43 d1 55 56 50 db 3d 8d 21 c2

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 02 34 5f 16 64 59 f8 93 a5 7e 95 06 77 64 25
         5b d8 5e da cb 48 97 43 d1 55 56 50 db 3d 8d 21 c2

      output (32 octets):  cf dc e9 5d 1a 91 8e 33 00 ab 4e 44 b5 14 bc
         aa 5d 20 25 55 79 0d 3d ab 9a bd 36 85 ba a3 4d 75

   {server}  derive secret "tls13 s hs traffic":





Thomson                   Expires June 8, 2018                 [Page 18]

Internet-Draft               TLS 1.3 Traces                December 2017


      PRK (32 octets):  59 57 85 f0 45 d7 71 33 30 84 5b 68 8a 94 85 2e
         fe d8 a5 45 b1 60 b9 1e 8c 55 37 8d 66 f6 a9 20

      hash (32 octets):  02 34 5f 16 64 59 f8 93 a5 7e 95 06 77 64 25 5b
         d8 5e da cb 48 97 43 d1 55 56 50 db 3d 8d 21 c2

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 02 34 5f 16 64 59 f8 93 a5 7e 95 06 77 64 25
         5b d8 5e da cb 48 97 43 d1 55 56 50 db 3d 8d 21 c2

      output (32 octets):  ab 82 ee b7 a1 6e 6c 38 e2 b0 67 21 4f 50 92
         49 27 c6 d6 f7 8f 57 c3 03 00 f9 90 b5 42 7a 08 ca

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  59 57 85 f0 45 d7 71 33 30 84 5b 68 8a 94 85 2e
         fe d8 a5 45 b1 60 b9 1e 8c 55 37 8d 66 f6 a9 20

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  47 3d ee 32 fe cc 43 28 95 26 af 36 98 f5 6c
         b7 3b ce 63 91 22 d5 e9 f6 87 0e da bc 3f e1 d6 ed

   {server}  extract secret "master":

      salt (32 octets):  47 3d ee 32 fe cc 43 28 95 26 af 36 98 f5 6c b7
         3b ce 63 91 22 d5 e9 f6 87 0e da bc 3f e1 d6 ed

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  32 70 9d 48 3d cc 61 4f d5 79 a9 28 49 4f 04
         7b 4d 1f 6e 89 19 bb 6b 7f 4b 40 b2 e8 ad 1b 35 de

   {server}  send handshake record:

      payload (96 octets):  02 00 00 5c 03 03 2c 0c 3a d1 f4 92 a8 60 f4
         2c 30 46 28 60 44 1c 5c ba 1b 4d c6 9b 9a 43 2c b8 48 64 86 6f
         aa 14 00 13 01 00 00 34 00 29 00 02 00 00 00 28 00 24 00 1d 00
         20 97 0d 07 3f 5d a9 af 35 85 8e 3c 1f c1 55 b9 29 f9 52 03 51
         ee 8f 87 91 db ae a3 33 84 dc 13 0b 00 2b 00 02 7f 16





Thomson                   Expires June 8, 2018                 [Page 19]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (101 octets):  16 03 03 00 60 02 00 00 5c 03 03 2c 0c
         3a d1 f4 92 a8 60 f4 2c 30 46 28 60 44 1c 5c ba 1b 4d c6 9b 9a
         43 2c b8 48 64 86 6f aa 14 00 13 01 00 00 34 00 29 00 02 00 00
         00 28 00 24 00 1d 00 20 97 0d 07 3f 5d a9 af 35 85 8e 3c 1f c1
         55 b9 29 f9 52 03 51 ee 8f 87 91 db ae a3 33 84 dc 13 0b 00 2b
         00 02 7f 16

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  ab 82 ee b7 a1 6e 6c 38 e2 b0 67 21 4f 50 92 49
         27 c6 d6 f7 8f 57 c3 03 00 f9 90 b5 42 7a 08 ca

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  7a 4a ea 2a e1 03 a2 db c4 a5 cf 7a 68 01
         8a 0c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  dc 18 f4 45 d2 d8 80 73 95 f1 77 28

   {server}  send a EncryptedExtensions handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  ab 82 ee b7 a1 6e 6c 38 e2 b0 67 21 4f 50 92 49
         27 c6 d6 f7 8f 57 c3 03 00 f9 90 b5 42 7a 08 ca

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  79 ef ed 9c 74 52 f7 4a fd 8f 5f 3f 27 5e af
         60 27 fe 79 8c 86 fe 63 91 ef 31 09 c8 73 d1 77 e3

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (74 octets):  08 00 00 22 00 20 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 00 2a
         00 00 14 00 00 20 65 96 bc eb c5 ec 3a b5 9b 35 37 af 96 52 78
         4a 11 ae 21 c2 51 07 35 17 19 77 9f c4 e2 d0 0c b9

      ciphertext (96 octets):  17 03 03 00 5b c1 a9 c4 34 6d 82 f5 13 43
         91 2e 21 f0 87 ec b7 92 8e 14 f6 6e 8f 84 be d0 fa 3f 52 85 27
         dd 13 49 75 04 51 f3 72 fc 72 4f 76 a8 7d a4 5d b0 b3 ce a6 c2



Thomson                   Expires June 8, 2018                 [Page 20]

Internet-Draft               TLS 1.3 Traces                December 2017


         1e d5 c2 56 14 3b 10 9e 8e 90 1e 69 80 f8 18 0e 68 33 21 f6 a0
         14 ac ff cd 2a b9 1d b6 ae db 02 86 dd 83 9c bd 09 9a b6

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  32 70 9d 48 3d cc 61 4f d5 79 a9 28 49 4f 04 7b
         4d 1f 6e 89 19 bb 6b 7f 4b 40 b2 e8 ad 1b 35 de

      hash (32 octets):  d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc 8a
         ea 78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc
         8a ea 78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      output (32 octets):  83 93 80 ed b4 7b aa 9f 52 50 98 d1 db 56 ef
         bc b5 51 8c 97 62 c9 cf a8 97 62 a1 37 3a 98 b8 29

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  32 70 9d 48 3d cc 61 4f d5 79 a9 28 49 4f 04 7b
         4d 1f 6e 89 19 bb 6b 7f 4b 40 b2 e8 ad 1b 35 de

      hash (32 octets):  d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc 8a
         ea 78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc
         8a ea 78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      output (32 octets):  8d 81 6b 05 12 e1 72 52 6c 73 35 8a 6e 6e 8b
         7b d6 10 37 0a 81 22 4e f5 5a 60 d4 05 e1 17 34 1e

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  32 70 9d 48 3d cc 61 4f d5 79 a9 28 49 4f 04 7b
         4d 1f 6e 89 19 bb 6b 7f 4b 40 b2 e8 ad 1b 35 de

      hash (32 octets):  d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc 8a
         ea 78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 d4 73 2d 05 15 f9 e0 92 3f a2 64 31 62 c9 dc 8a ea
         78 3a 21 e1 ad b3 09 e7 7a d8 7b 42 b0 29 c7

      output (32 octets):  b1 c1 de d8 f6 f9 50 d5 d9 17 32 0a b5 bb 90
         0a e9 fa 5a a3 da 19 e8 de 2f c1 9b 36 ef 3a 1f fb




Thomson                   Expires June 8, 2018                 [Page 21]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  derive write traffic keys for application data:

      PRK (32 octets):  8d 81 6b 05 12 e1 72 52 6c 73 35 8a 6e 6e 8b 7b
         d6 10 37 0a 81 22 4e f5 5a 60 d4 05 e1 17 34 1e

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  ca 1d 4a 5f 35 82 bc b8 69 6f 18 2a a6 f3
         5f 51

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c9 85 63 30 31 31 48 e2 de 17 bc 69

   {server}  derive read traffic keys for early application data (same
      as client write traffic keys)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  ff af c2 3b 1c 6a ad a5 3b 20 df e8 cf c1 38 1d
         f7 7f 40 fc 98 30 a7 10 72 69 d7 54 49 c4 2f df

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  9c b0 77 04 dc 55 9d a4 d6 04 7d 55 4f 8b 4d
         5e 30 80 bb cf c6 85 31 8d 72 f8 99 45 cf 38 cc e0

   {client}  extract secret "handshake":

      salt (32 octets):  9c b0 77 04 dc 55 9d a4 d6 04 7d 55 4f 8b 4d 5e
         30 80 bb cf c6 85 31 8d 72 f8 99 45 cf 38 cc e0

      ikm (32 octets):  3f 9a c0 6a 0a 29 1a cd 72 23 fe 9c 88 f8 ea 8d
         6a ff c4 71 00 45 3f 96 21 8a 08 11 50 07 09 45

      secret (32 octets):  59 57 85 f0 45 d7 71 33 30 84 5b 68 8a 94 85
         2e fe d8 a5 45 b1 60 b9 1e 8c 55 37 8d 66 f6 a9 20

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)



Thomson                   Expires June 8, 2018                 [Page 22]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  ab 82 ee b7 a1 6e 6c 38 e2 b0 67 21 4f 50 92 49
         27 c6 d6 f7 8f 57 c3 03 00 f9 90 b5 42 7a 08 ca

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  7a 4a ea 2a e1 03 a2 db c4 a5 cf 7a 68 01
         8a 0c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  dc 18 f4 45 d2 d8 80 73 95 f1 77 28

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send a EndOfEarlyData handshake message

   {client}  send handshake record:

      payload (4 octets):  05 00 00 00

      ciphertext (26 octets):  17 03 03 00 15 85 27 3b 66 7d 86 b6 14 da
         a1 83 de 2e f9 90 ff d4 be 20 93 9a

   {client}  derive write traffic keys for handshake data:

      PRK (32 octets):  cf dc e9 5d 1a 91 8e 33 00 ab 4e 44 b5 14 bc aa
         5d 20 25 55 79 0d 3d ab 9a bd 36 85 ba a3 4d 75

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  40 59 27 cb 90 e4 d6 6b 06 87 af 38 e3 7f
         05 e8

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f5 1a b5 75 52 80 b5 a3 cf a0 4d c1





Thomson                   Expires June 8, 2018                 [Page 23]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  cf dc e9 5d 1a 91 8e 33 00 ab 4e 44 b5 14 bc aa
         5d 20 25 55 79 0d 3d ab 9a bd 36 85 ba a3 4d 75

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  30 8a fd e2 53 bb 36 97 96 47 a8 25 1d 4f 17
         56 19 a0 e3 34 1f ee b2 75 35 85 c1 c9 11 51 80 5f

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 62 e2 39 f2 e3 cc 82 cc 7e e4 97
         fc fe 88 96 b7 95 41 ba 7a f7 f4 66 11 d0 e1 ab 84 1b d4 06 55

      ciphertext (58 octets):  17 03 03 00 35 19 95 f6 ff 31 fb 07 70 66
         36 7c 2b cf 85 a5 5f f0 4a 96 39 fb 3d 80 67 93 4a dd 81 7a 1c
         40 46 4d 80 67 c1 9f 7c 92 35 f9 2e 32 81 48 ad 65 ff 40 74 e9
         d5 fd

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  83 93 80 ed b4 7b aa 9f 52 50 98 d1 db 56 ef bc
         b5 51 8c 97 62 c9 cf a8 97 62 a1 37 3a 98 b8 29

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  64 ec 17 ac 4c f5 05 72 f7 71 8f 6d 76 99
         51 35

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  e4 d7 63 26 09 39 4d 1f ae dc 98 c0

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  32 70 9d 48 3d cc 61 4f d5 79 a9 28 49 4f 04 7b
         4d 1f 6e 89 19 bb 6b 7f 4b 40 b2 e8 ad 1b 35 de





Thomson                   Expires June 8, 2018                 [Page 24]

Internet-Draft               TLS 1.3 Traces                December 2017


      hash (32 octets):  25 dd 40 0e 46 ff 89 d2 a2 4e c4 38 75 a5 a4 f4
         bd 71 f9 63 06 60 73 ea 74 ad f4 08 0d 9f 99 a0

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 25 dd 40 0e 46 ff 89 d2 a2 4e c4 38 75 a5 a4 f4 bd
         71 f9 63 06 60 73 ea 74 ad f4 08 0d 9f 99 a0

      output (32 octets):  0d 44 59 8f 33 0b 65 5e 7b 94 f8 40 da 66 8a
         10 75 8f e1 52 54 0a 43 04 be 89 43 1b dd 77 1e 7a

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  cf dc e9 5d 1a 91 8e 33 00 ab 4e 44 b5 14 bc aa
         5d 20 25 55 79 0d 3d ab 9a bd 36 85 ba a3 4d 75

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  40 59 27 cb 90 e4 d6 6b 06 87 af 38 e3 7f
         05 e8

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f5 1a b5 75 52 80 b5 a3 cf a0 4d c1

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 e5 bd d7 69 b9 d7 50 60 84
         63 c3 a2 fa 06 ed 97 7e 77 98 4b 6a bd 85 08 6d cd e0 e1 13 72
         62 5e 10 43 30 c0 f3 90 9f 61 9d 23 01 07 bf 46 d1 5b f9 ff 25
         4e 3a ee 1c fb e4 48 ac 8c 81 b6 f2 39 4b 0a c2

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31




Thomson                   Expires June 8, 2018                 [Page 25]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (72 octets):  17 03 03 00 43 5f 53 67 cf 55 ab fa 1b 94
         8f 0e 9f ab e6 1a 3d 5e 8d 10 50 f9 ef 32 a4 f0 2b 46 25 74 68
         8c 01 ee 25 50 92 c6 40 e2 14 95 f4 b5 08 06 ff 6a 5b 46 b7 35
         41 56 ca be 0b c6 62 6a d3 e2 5b 85 a4 ad cc fa

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 0e 1e 55 b1 44 f4 a9 12 78
         5e 51 ac b6 7b 61 e1 fe ee db

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 1e 2a d6 f2 ae 1c 24 a7 6c
         88 e9 e8 5e f1 1f e6 5f 0e fe

5.  HelloRetryRequest

   In this example, the client initiates a handshake with an X25519
   [RFC7748] share.  The server however prefers P-256 [FIPS186] and
   sends a HelloRetryRequest that requires the client to generate a key
   share on the P-256 curve.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  7d 7c a4 0e cc 99 cb 31 8f 5d 00 62 96
         7a 8f 87 d3 91 d7 f5 38 54 09 a6 f5 cd f0 64 0d ef 32 87

      public key (32 octets):  de c4 8a 45 24 09 98 6c 0b d3 34 20 eb 1d
         18 e2 da 85 8c 6c 0b 37 bf 0e 21 94 ef b0 18 93 1d 0d

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (174 octets):  01 00 00 aa 03 03 77 fb 1f 2e ec ec ab 1a
         a6 9e 76 a7 f9 53 29 2a 21 73 76 b1 a1 41 d7 fc 5a dc df 07 83
         03 10 1e 00 00 06 13 01 13 03 13 02 01 00 00 7b 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 28 00 26 00 24 00 1d 00 20 de c4 8a 45 24
         09 98 6c 0b d3 34 20 eb 1d 18 e2 da 85 8c 6c 0b 37 bf 0e 21 94
         ef b0 18 93 1d 0d 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04 03
         05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04
         02 05 02 06 02 02 02 00 2d 00 02 01 01




Thomson                   Expires June 8, 2018                 [Page 26]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (179 octets):  16 03 01 00 ae 01 00 00 aa 03 03 77 fb
         1f 2e ec ec ab 1a a6 9e 76 a7 f9 53 29 2a 21 73 76 b1 a1 41 d7
         fc 5a dc df 07 83 03 10 1e 00 00 06 13 01 13 03 13 02 01 00 00
         7b 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 28 00 26 00 24 00 1d 00
         20 de c4 8a 45 24 09 98 6c 0b d3 34 20 eb 1d 18 e2 da 85 8c 6c
         0b 37 bf 0e 21 94 ef b0 18 93 1d 0d 00 2b 00 03 02 7f 16 00 0d
         00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05
         01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61 11
         be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2 c8
         a8 33 9c 00 13 01 00 00 84 00 28 00 02 00 17 00 2c 00 74 00 72
         ad be a5 59 3e 25 74 45 9d 18 10 97 00 00 00 00 85 c1 6f c0 81
         fc 2f 07 71 e1 26 3c a9 9d ff b5 00 30 5c f5 ed d5 c6 6c 67 d6
         aa 24 5b 69 1d 6a a1 7e 44 dd 50 5b 62 b7 a4 f0 50 3b 4f d8 7a
         04 20 cd ee 08 d7 b8 7f 1f 1f df b8 21 e4 d6 de fd 11 7f 26 88
         37 2e 05 37 39 97 0e bd a2 1a e0 42 04 62 e1 1f e5 74 50 03 33
         2b 8f 43 81 23 6b 76 19 bb 00 2b 00 02 7f 16

      ciphertext (181 octets):  16 03 03 00 b0 02 00 00 ac 03 03 cf 21
         ad 74 e5 9a 61 11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c
         5e 07 9e 09 e2 c8 a8 33 9c 00 13 01 00 00 84 00 28 00 02 00 17
         00 2c 00 74 00 72 ad be a5 59 3e 25 74 45 9d 18 10 97 00 00 00
         00 85 c1 6f c0 81 fc 2f 07 71 e1 26 3c a9 9d ff b5 00 30 5c f5
         ed d5 c6 6c 67 d6 aa 24 5b 69 1d 6a a1 7e 44 dd 50 5b 62 b7 a4
         f0 50 3b 4f d8 7a 04 20 cd ee 08 d7 b8 7f 1f 1f df b8 21 e4 d6
         de fd 11 7f 26 88 37 2e 05 37 39 97 0e bd a2 1a e0 42 04 62 e1
         1f e5 74 50 03 33 2b 8f 43 81 23 6b 76 19 bb 00 2b 00 02 7f 16

   {client}  create an ephemeral P-256 key pair:

      private key (32 octets):  37 65 ed ce ec b2 5e 78 6e 3c 1e 28 cf
         be 93 19 65 86 17 fe 95 40 88 4b 0d 96 42 3a 08 f4 4d 25

      public key (65 octets):  04 7e 90 ae 90 d5 41 80 be a7 28 61 22 aa
         34 d7 59 ed d5 e6 22 a7 2f 46 5e 53 75 00 a6 89 53 37 4b e3 8c
         ad d3 7f 36 30 5d 39 35 90 62 8c be 6e 5e ff 20 ec 38 4a ba 1d
         18 04 89 93 b2 08 b5 f1 35

   {client}  send a ClientHello handshake message

   {client}  send handshake record:




Thomson                   Expires June 8, 2018                 [Page 27]

Internet-Draft               TLS 1.3 Traces                December 2017


      payload (512 octets):  01 00 01 fc 03 03 77 fb 1f 2e ec ec ab 1a
         a6 9e 76 a7 f9 53 29 2a 21 73 76 b1 a1 41 d7 fc 5a dc df 07 83
         03 10 1e 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 28 00 47 00 45 00 17 00 41 04 7e 90 ae 90
         d5 41 80 be a7 28 61 22 aa 34 d7 59 ed d5 e6 22 a7 2f 46 5e 53
         75 00 a6 89 53 37 4b e3 8c ad d3 7f 36 30 5d 39 35 90 62 8c be
         6e 5e ff 20 ec 38 4a ba 1d 18 04 89 93 b2 08 b5 f1 35 00 2b 00
         03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2c
         00 74 00 72 ad be a5 59 3e 25 74 45 9d 18 10 97 00 00 00 00 85
         c1 6f c0 81 fc 2f 07 71 e1 26 3c a9 9d ff b5 00 30 5c f5 ed d5
         c6 6c 67 d6 aa 24 5b 69 1d 6a a1 7e 44 dd 50 5b 62 b7 a4 f0 50
         3b 4f d8 7a 04 20 cd ee 08 d7 b8 7f 1f 1f df b8 21 e4 d6 de fd
         11 7f 26 88 37 2e 05 37 39 97 0e bd a2 1a e0 42 04 62 e1 1f e5
         74 50 03 33 2b 8f 43 81 23 6b 76 19 bb 00 2d 00 02 01 01 00 15
         00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      ciphertext (517 octets):  16 03 03 02 00 01 00 01 fc 03 03 77 fb
         1f 2e ec ec ab 1a a6 9e 76 a7 f9 53 29 2a 21 73 76 b1 a1 41 d7
         fc 5a dc df 07 83 03 10 1e 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 28 00 47 00 45 00 17 00
         41 04 7e 90 ae 90 d5 41 80 be a7 28 61 22 aa 34 d7 59 ed d5 e6
         22 a7 2f 46 5e 53 75 00 a6 89 53 37 4b e3 8c ad d3 7f 36 30 5d
         39 35 90 62 8c be 6e 5e ff 20 ec 38 4a ba 1d 18 04 89 93 b2 08
         b5 f1 35 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2c 00 74 00 72 ad be a5 59 3e 25 74 45 9d 18 10
         97 00 00 00 00 85 c1 6f c0 81 fc 2f 07 71 e1 26 3c a9 9d ff b5
         00 30 5c f5 ed d5 c6 6c 67 d6 aa 24 5b 69 1d 6a a1 7e 44 dd 50
         5b 62 b7 a4 f0 50 3b 4f d8 7a 04 20 cd ee 08 d7 b8 7f 1f 1f df
         b8 21 e4 d6 de fd 11 7f 26 88 37 2e 05 37 39 97 0e bd a2 1a e0
         42 04 62 e1 1f e5 74 50 03 33 2b 8f 43 81 23 6b 76 19 bb 00 2d
         00 02 01 01 00 15 00 b5 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00



Thomson                   Expires June 8, 2018                 [Page 28]

Internet-Draft               TLS 1.3 Traces                December 2017


         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral P-256 key pair:

      private key (32 octets):  56 94 ad 62 61 39 27 be a5 32 78 48 0d
         03 ae 63 32 14 e4 0b 68 d8 58 c9 e2 b7 8d 0c e1 ae 52 bd

      public key (65 octets):  04 67 b3 aa 41 ea 82 3a 08 8e 46 2a 9b 45
         0e b8 6a 02 dd 1a 10 04 87 3f 5e 59 5b aa 74 69 7d 72 46 94 f8
         21 42 7b aa ff 42 82 9d 1e 3b ad 47 0d d2 1c f2 50 7e ae 61 c5
         80 26 54 9f 51 3d 5c f4 c5

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  3c 72 ba a2 07 e4 d6 f2 ff 2e e8 21 40 b1 70 0e
         9c 06 ff d8 a2 f8 11 8e 8f e3 87 2b 1c b8 18 80



Thomson                   Expires June 8, 2018                 [Page 29]

Internet-Draft               TLS 1.3 Traces                December 2017


      secret (32 octets):  71 12 49 6d 6e 45 7d 6d c3 7f c8 eb ff 9c 1a
         40 b4 23 8f 20 13 2a cf 29 ad 4f 1b d0 7d a4 a3 8b

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  71 12 49 6d 6e 45 7d 6d c3 7f c8 eb ff 9c 1a 40
         b4 23 8f 20 13 2a cf 29 ad 4f 1b d0 7d a4 a3 8b

      hash (32 octets):  d9 9c a0 0e 4b f9 5d 8b 46 d5 b6 00 50 03 23 0b
         6c ee 4f b6 3b ba ef ef 73 a4 ba aa 1a be ce ec

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 d9 9c a0 0e 4b f9 5d 8b 46 d5 b6 00 50 03 23
         0b 6c ee 4f b6 3b ba ef ef 73 a4 ba aa 1a be ce ec

      output (32 octets):  8f 9c 81 d2 f6 08 80 82 4f a9 22 e5 32 a1 7e
         65 ec 7a b9 ae d6 12 16 73 8e 69 00 bf 66 62 27 9e

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  71 12 49 6d 6e 45 7d 6d c3 7f c8 eb ff 9c 1a 40
         b4 23 8f 20 13 2a cf 29 ad 4f 1b d0 7d a4 a3 8b

      hash (32 octets):  d9 9c a0 0e 4b f9 5d 8b 46 d5 b6 00 50 03 23 0b
         6c ee 4f b6 3b ba ef ef 73 a4 ba aa 1a be ce ec

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 d9 9c a0 0e 4b f9 5d 8b 46 d5 b6 00 50 03 23
         0b 6c ee 4f b6 3b ba ef ef 73 a4 ba aa 1a be ce ec

      output (32 octets):  7c 61 8e 83 e9 95 2c b5 d8 7a f2 d5 62 ac 8b
         99 a1 22 b9 b2 1b 34 3d 7e 95 6b 08 fc bb 18 1a 40

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  71 12 49 6d 6e 45 7d 6d c3 7f c8 eb ff 9c 1a 40
         b4 23 8f 20 13 2a cf 29 ad 4f 1b d0 7d a4 a3 8b

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6b ae 53 e5 a7 ed 52 7d ed 34 5d 11 e2 bf 8f
         25 8f 0c bd df cf e9 22 ec 9d e0 47 94 8e 48 fc ea




Thomson                   Expires June 8, 2018                 [Page 30]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  extract secret "master":

      salt (32 octets):  6b ae 53 e5 a7 ed 52 7d ed 34 5d 11 e2 bf 8f 25
         8f 0c bd df cf e9 22 ec 9d e0 47 94 8e 48 fc ea

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  0d 60 17 c2 12 97 3a 74 62 85 28 87 19 c4 a4
         07 4a 77 b4 f4 a7 73 15 20 8c 54 ca 6b 2b 44 e0 a7

   {server}  send handshake record:

      payload (123 octets):  02 00 00 77 03 03 58 62 ab af 7c fe ca 85
         ed cc 09 04 95 df 59 03 b4 75 02 60 b5 d8 ce 7d ce d4 17 9f 1a
         09 61 cc 00 13 01 00 00 4f 00 28 00 45 00 17 00 41 04 67 b3 aa
         41 ea 82 3a 08 8e 46 2a 9b 45 0e b8 6a 02 dd 1a 10 04 87 3f 5e
         59 5b aa 74 69 7d 72 46 94 f8 21 42 7b aa ff 42 82 9d 1e 3b ad
         47 0d d2 1c f2 50 7e ae 61 c5 80 26 54 9f 51 3d 5c f4 c5 00 2b
         00 02 7f 16

      ciphertext (128 octets):  16 03 03 00 7b 02 00 00 77 03 03 58 62
         ab af 7c fe ca 85 ed cc 09 04 95 df 59 03 b4 75 02 60 b5 d8 ce
         7d ce d4 17 9f 1a 09 61 cc 00 13 01 00 00 4f 00 28 00 45 00 17
         00 41 04 67 b3 aa 41 ea 82 3a 08 8e 46 2a 9b 45 0e b8 6a 02 dd
         1a 10 04 87 3f 5e 59 5b aa 74 69 7d 72 46 94 f8 21 42 7b aa ff
         42 82 9d 1e 3b ad 47 0d d2 1c f2 50 7e ae 61 c5 80 26 54 9f 51
         3d 5c f4 c5 00 2b 00 02 7f 16

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  7c 61 8e 83 e9 95 2c b5 d8 7a f2 d5 62 ac 8b 99
         a1 22 b9 b2 1b 34 3d 7e 95 6b 08 fc bb 18 1a 40

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  98 f3 ba 02 97 42 e0 91 62 dd 08 b2 87 be
         e7 76

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9b 92 ba 9a 01 83 09 3c 75 b6 49 86

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message



Thomson                   Expires June 8, 2018                 [Page 31]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  7c 61 8e 83 e9 95 2c b5 d8 7a f2 d5 62 ac 8b 99
         a1 22 b9 b2 1b 34 3d 7e 95 6b 08 fc bb 18 1a 40

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  cd e2 f9 1f ef 74 7e 44 7d 12 6c 8d 91 ca 39
         a5 50 ac e5 c2 4a 7f 59 34 9f 24 e6 e2 ec 9d fa 54

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (639 octets):  08 00 00 12 00 10 00 0a 00 08 00 06 00 17
         00 18 00 1d 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93
         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b
         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 2e
         81 7c 04 be c0 5e 3e 9d 93 0d 75 cc a3 53 11 28 47 cd 6b 7d 47
         05 d2 3a 2c 97 93 83 c9 94 16 0b 82 95 0c 59 61 63 5e 98 26 00
         2a c9 a8 f9 1f 6a 3e ab 79 bc bd 59 15 0f 40 f0 51 fd d0 73 9b
         86 5a 73 08 cf 13 af 8e 0d e4 08 92 14 e5 46 0b 25 f5 02 bd 62
         77 e8 95 de 43 38 f2 71 5a ff 3c 26 a2 e0 fe 10 46 16 b5 91 95
         5a 14 b0 55 dc f1 b0 1c 7b a0 a8 36 26 92 14 5a 9f b0 ea 7f 95
         a0 14 00 00 20 fa 80 9c bb 0b 55 6f a4 fd 32 0d 43 e3 2d 18 83
         7a 08 3e f1 c0 b9 97 df 7b 0a 49 3a a5 cd 01 ec



Thomson                   Expires June 8, 2018                 [Page 32]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (661 octets):  17 03 03 02 90 3b 74 e5 79 fd ba 0a 7f
         19 3e 80 81 f3 49 14 63 db 58 1f d4 4d 14 36 ac ef ec c2 80 e7
         b9 1b c6 80 04 66 98 8a 7e 5f ce 81 c4 fd be ae fa 80 10 ab 6f
         d9 eb 7f fb 39 84 ae 67 36 01 02 05 fd 55 4d 72 86 6f 3f 2f ef
         19 ac 67 93 cf 96 e0 08 5c e7 5d 51 8f b0 a6 36 2d 57 58 a5 ab
         0d 39 ec 83 46 9b d3 9f 68 29 3d 59 c2 a0 32 12 25 2b 14 fc f1
         98 61 d1 a3 dc 85 d6 d8 09 61 7b 70 e1 55 a7 99 a5 06 f9 8a db
         94 6b 8f 59 bf 6f fd c2 36 bb 84 21 af 3a aa 98 98 b1 16 b0 74
         f2 3f 0e 67 14 2d c5 3b 64 28 6f d3 e4 9b 25 40 96 a2 7a cf 82
         42 bb 7c 3c 83 61 f6 0d 5c 34 e3 de 0f 61 86 d4 d7 e0 6c fe b8
         9a 8e e4 e7 c0 78 cb d2 6b 4c fa 05 d4 10 7e 0b ba b9 56 7e 09
         0d ca d1 50 79 52 f8 61 bb cd 5c 88 12 58 52 64 c5 87 5e 36 4c
         44 d7 af 49 fa 3a 74 74 40 1a a3 ba 78 f3 a5 d9 0d ab 4b ee c2
         21 f5 37 96 8a 0e f5 53 3f f6 ba cd fb e6 3c e8 f4 d0 63 ab 29
         7b 82 e8 62 68 c9 94 3b 8a b8 ad 8b a7 40 fc 53 ce 7c f8 ad 9c
         bc 0b 4c c3 95 06 fb 2e 47 95 f9 cd 45 cd 6e 67 d4 94 10 3b 0c
         d7 c5 1e a1 79 b4 f9 4a e7 74 98 1c 5f b6 68 75 06 52 6a 2f 1d
         11 17 87 a0 6e 5e 7b 35 b5 ca 7e e0 41 ef 12 b8 86 7b 91 4e 7e
         ed 2f 2d 4b 2a 74 37 37 65 96 bf fc 27 56 46 1d d0 4e 28 eb 1f
         e3 bd d4 da 2a 4f e5 37 81 11 66 9e 8e 59 78 cf d5 3f 14 93 58
         b2 b6 13 a6 11 75 e3 6a 90 92 7f 92 13 c4 6b 7f cc f1 cf ac 09
         b3 48 45 35 9f 5d 2e 50 a5 b3 bd 37 de 03 42 38 5b 2f 87 ee f8
         aa 0f 98 c8 27 37 be 8c fc 59 c9 9a b7 b8 02 2a ef d2 7f 7c 44
         8a 32 fd 54 63 ca 53 c2 07 27 98 72 42 2e 42 a8 50 f1 3e e5 99
         22 28 16 17 19 ec b2 a2 f1 08 f1 88 53 f2 99 12 ad 53 78 3d 31
         68 bb 7e 5c e1 16 21 0e a1 c6 1b 0e 6a b4 74 20 a0 d6 fb 8d d9
         b3 2f b4 cf 81 7b ad a8 e2 a0 84 c5 93 eb 0b 9c 6f 37 bc 36 89
         6e 69 2f 70 ce 0b 0d bb 1f 70 44 0d 26 1e 68 20 25 1c 74 9f 9c
         43 8c a3 d6 e8 38 51 39 22 d2 25 6f f8 df 76 1f 39 2d 09 8e 1b
         20 88 a8 c1 87 54 3a 00 4b d3 9b f7 9f 15 27 64 c9 2d 97 c5 3e
         ca 43 45 02 74 e2 29 b6 8a 3c dc 51 f0 40 68 a7 fa 8c dc 75 e5
         fe 8a 42 11 56 c8 19 df ce 27 39 07 fa 28 0f 04 38 4c

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  0d 60 17 c2 12 97 3a 74 62 85 28 87 19 c4 a4 07
         4a 77 b4 f4 a7 73 15 20 8c 54 ca 6b 2b 44 e0 a7

      hash (32 octets):  30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51 32
         37 ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51
         32 37 ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      output (32 octets):  16 14 d2 b3 23 c8 70 64 b8 b1 40 b9 76 31 a1
         06 36 c6 ff 0b e2 26 28 ed 69 43 07 74 d6 73 8d b5




Thomson                   Expires June 8, 2018                 [Page 33]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  0d 60 17 c2 12 97 3a 74 62 85 28 87 19 c4 a4 07
         4a 77 b4 f4 a7 73 15 20 8c 54 ca 6b 2b 44 e0 a7

      hash (32 octets):  30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51 32
         37 ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51
         32 37 ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      output (32 octets):  98 86 ce e7 2f 62 00 0f 9a 71 b2 86 10 00 80
         32 d2 8f d8 1e 92 20 27 6e 19 14 b3 58 fc 0b 2b 20

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  0d 60 17 c2 12 97 3a 74 62 85 28 87 19 c4 a4 07
         4a 77 b4 f4 a7 73 15 20 8c 54 ca 6b 2b 44 e0 a7

      hash (32 octets):  30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51 32
         37 ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 30 a7 16 49 12 4c b8 65 6c 10 7f 5d 27 98 51 32 37
         ce a3 dd b3 ae 4b e8 68 a4 88 98 42 eb 2f f1

      output (32 octets):  3f 1e 36 0a ec 8b ba 56 44 10 29 e6 51 4c 03
         05 5b 3a 64 ad 9d bf 67 7e c2 96 29 f4 e5 60 fe 34

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  98 86 ce e7 2f 62 00 0f 9a 71 b2 86 10 00 80 32
         d2 8f d8 1e 92 20 27 6e 19 14 b3 58 fc 0b 2b 20

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c3 3c 0b d9 52 4e 89 8a d1 3a 7a 55 bc 9a
         aa a8

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  95 2d 96 5b 74 3a 61 32 0a 63 cf c2

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  8f 9c 81 d2 f6 08 80 82 4f a9 22 e5 32 a1 7e 65
         ec 7a b9 ae d6 12 16 73 8e 69 00 bf 66 62 27 9e



Thomson                   Expires June 8, 2018                 [Page 34]

Internet-Draft               TLS 1.3 Traces                December 2017


      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  bd 31 7d 64 89 a8 01 a9 66 10 21 29 4f 34
         5c 5a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  3c 2c cd 28 d1 e0 31 74 32 b3 ef 7b

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  3c 72 ba a2 07 e4 d6 f2 ff 2e e8 21 40 b1 70 0e
         9c 06 ff d8 a2 f8 11 8e 8f e3 87 2b 1c b8 18 80

      secret (32 octets):  71 12 49 6d 6e 45 7d 6d c3 7f c8 eb ff 9c 1a
         40 b4 23 8f 20 13 2a cf 29 ad 4f 1b d0 7d a4 a3 8b

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)



Thomson                   Expires June 8, 2018                 [Page 35]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  7c 61 8e 83 e9 95 2c b5 d8 7a f2 d5 62 ac 8b 99
         a1 22 b9 b2 1b 34 3d 7e 95 6b 08 fc bb 18 1a 40

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  98 f3 ba 02 97 42 e0 91 62 dd 08 b2 87 be
         e7 76

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9b 92 ba 9a 01 83 09 3c 75 b6 49 86

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  8f 9c 81 d2 f6 08 80 82 4f a9 22 e5 32 a1 7e 65
         ec 7a b9 ae d6 12 16 73 8e 69 00 bf 66 62 27 9e

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  e4 a6 00 08 49 7e f2 e2 78 e4 af 06 a5 aa da
         a1 cb 7a db dc 14 f4 5e 68 a3 f0 39 ff 4c ed 41 64

   {client}  send a Finished handshake message

   {client}  send handshake record:



Thomson                   Expires June 8, 2018                 [Page 36]

Internet-Draft               TLS 1.3 Traces                December 2017


      payload (36 octets):  14 00 00 20 ab 13 15 f4 bf 59 2b c8 62 a7 b6
         38 5e 29 1b 9c c0 50 7f 55 ee a4 0f cf 2c 5f 0d cd cd 39 e2 48

      ciphertext (58 octets):  17 03 03 00 35 f8 f7 fc dd 79 75 ad 14 72
         88 b4 d2 d0 92 a4 9a fc ff c3 4f d8 8d c7 b4 de 4a 6a 92 cd 5d
         74 4f ac f5 b0 5b c9 3e 26 d8 89 18 f3 2d 57 bd e7 a4 dc c3 30
         86 3b

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  16 14 d2 b3 23 c8 70 64 b8 b1 40 b9 76 31 a1 06
         36 c6 ff 0b e2 26 28 ed 69 43 07 74 d6 73 8d b5

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  62 f1 1c aa a5 a9 76 cf 0f 98 c4 05 2a 70
         6e fe

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  09 8c a8 f6 b5 e4 2d 13 c6 69 bc ae

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  0d 60 17 c2 12 97 3a 74 62 85 28 87 19 c4 a4 07
         4a 77 b4 f4 a7 73 15 20 8c 54 ca 6b 2b 44 e0 a7

      hash (32 octets):  57 cb 6c 48 cb 65 ab 58 9c 92 22 7d 45 9b f2 be
         1d c5 45 c5 ff 95 54 fe 8c 27 bb f2 e5 0c 73 5a

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 57 cb 6c 48 cb 65 ab 58 9c 92 22 7d 45 9b f2 be 1d
         c5 45 c5 ff 95 54 fe 8c 27 bb f2 e5 0c 73 5a

      output (32 octets):  c6 6a b0 37 3a 84 81 84 87 38 67 50 56 9b 04
         60 81 48 24 b2 3f ea e8 2e bd c5 00 c1 f3 93 d2 fb

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00




Thomson                   Expires June 8, 2018                 [Page 37]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (24 octets):  17 03 03 00 13 11 7a 06 42 5a 7f 60 c2 6e
         36 dd 4d d3 34 b2 0c 58 08 fa

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 11 e9 bb d7 86 6e cf 3c 34
         6b f1 a4 68 ef 17 ce 26 dd 1f

6.  Client Authentication

   In this example, the server requests client authentication.  The
   client uses a certificate with an RSA key, the server uses an ECDSA
   certificate with a P-256 key.  Note that private keys for this
   example are not included in the draft.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  d3 a8 22 11 76 c4 90 90 ad 30 11 ad 3d
         b6 8f f5 34 00 29 7d cc 24 67 00 ce 91 05 64 92 c2 69 5d

      public key (32 octets):  e8 7e e5 34 ef 89 74 c0 88 8c 20 89 c4 8a
         2b c6 72 ef 41 47 da c6 c8 2f 0f ad e9 93 21 e9 54 25

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (186 octets):  01 00 00 b6 03 03 13 9d 85 1e af 6d e8 79
         1e e3 a3 dd 06 f8 f0 9d b4 20 6e 50 9b 43 68 e0 45 e6 4d a5 7a
         0b 5c 00 00 00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 28 00
         26 00 24 00 1d 00 20 e8 7e e5 34 ef 89 74 c0 88 8c 20 89 c4 8a
         2b c6 72 ef 41 47 da c6 c8 2f 0f ad e9 93 21 e9 54 25 00 2b 00
         03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d
         00 02 01 01

      ciphertext (191 octets):  16 03 01 00 ba 01 00 00 b6 03 03 13 9d
         85 1e af 6d e8 79 1e e3 a3 dd 06 f8 f0 9d b4 20 6e 50 9b 43 68
         e0 45 e6 4d a5 7a 0b 5c 00 00 00 06 13 01 13 03 13 02 01 00 00
         87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 28 00 26 00 24 00 1d 00 20 e8 7e e5 34 ef 89 74 c0
         88 8c 20 89 c4 8a 2b c6 72 ef 41 47 da c6 c8 2f 0f ad e9 93 21
         e9 54 25 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e 04 03 05 03 06



Thomson                   Expires June 8, 2018                 [Page 38]

Internet-Draft               TLS 1.3 Traces                December 2017


         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  a8 f6 2d 87 3f 2b 40 a3 ae 74 15 e2 41
         93 79 0d 8d d2 55 11 7b 07 f6 9a 24 b0 81 f1 a8 d0 67 06

      public key (32 octets):  0b f8 19 42 a8 ac 41 2a 18 d8 bc ec 1a 09
         42 bd d6 8e d8 f4 d9 00 78 1f 46 3b 00 73 b2 53 aa 28

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  7a 81 6c b9 0c 5e 4f 0a 7e b9 02 21 99 7a e8 75
         3d c9 cc 00 9f 8a 86 f5 d5 7e 72 dd 0a f9 b3 06

      secret (32 octets):  bc 50 91 a4 31 d6 fa ee 12 ce fd c7 be 4a 0a
         9d e7 bd 65 d4 9f c4 87 7c c4 5d 4f f9 2f 7d a6 99



Thomson                   Expires June 8, 2018                 [Page 39]

Internet-Draft               TLS 1.3 Traces                December 2017


   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  bc 50 91 a4 31 d6 fa ee 12 ce fd c7 be 4a 0a 9d
         e7 bd 65 d4 9f c4 87 7c c4 5d 4f f9 2f 7d a6 99

      hash (32 octets):  85 31 6f 0b 48 84 d5 fe bc ac 1c af b4 6f e0 dc
         d2 f5 24 f1 05 e0 cd de 75 3a 0c da 2f 7f 7b dd

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 85 31 6f 0b 48 84 d5 fe bc ac 1c af b4 6f e0
         dc d2 f5 24 f1 05 e0 cd de 75 3a 0c da 2f 7f 7b dd

      output (32 octets):  59 e6 8d 20 65 5f 53 e6 2c 7e 61 3c 39 4d a2
         9b 77 2b e4 91 78 9b 41 e2 d0 5a 5c 8c 4b a5 9f 48

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  bc 50 91 a4 31 d6 fa ee 12 ce fd c7 be 4a 0a 9d
         e7 bd 65 d4 9f c4 87 7c c4 5d 4f f9 2f 7d a6 99

      hash (32 octets):  85 31 6f 0b 48 84 d5 fe bc ac 1c af b4 6f e0 dc
         d2 f5 24 f1 05 e0 cd de 75 3a 0c da 2f 7f 7b dd

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 85 31 6f 0b 48 84 d5 fe bc ac 1c af b4 6f e0
         dc d2 f5 24 f1 05 e0 cd de 75 3a 0c da 2f 7f 7b dd

      output (32 octets):  7e 70 8e fc 98 f1 88 d5 4e 08 b0 2e 1a ef 98
         88 3e e6 00 f4 c8 d6 d0 53 c6 11 d5 09 57 bd 70 41

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  bc 50 91 a4 31 d6 fa ee 12 ce fd c7 be 4a 0a 9d
         e7 bd 65 d4 9f c4 87 7c c4 5d 4f f9 2f 7d a6 99

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  2f 67 cb ed f9 04 a5 61 06 d5 f3 9a f9 04 af
         50 ba 66 f2 1f 56 57 bc 8a 9c d7 35 ac a8 67 85 2c

   {server}  extract secret "master":





Thomson                   Expires June 8, 2018                 [Page 40]

Internet-Draft               TLS 1.3 Traces                December 2017


      salt (32 octets):  2f 67 cb ed f9 04 a5 61 06 d5 f3 9a f9 04 af 50
         ba 66 f2 1f 56 57 bc 8a 9c d7 35 ac a8 67 85 2c

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  89 7f a6 ff 89 41 f9 8c 3e 25 9c 6d d3 fe 8d
         e5 ff 7b ce 45 38 a8 10 02 bc 3e 8d ec 02 61 ce 7d

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 84 58 91 35 eb 20 74 54 9e
         4f 1d 64 44 58 72 0f 19 4b f3 71 f6 34 bc c1 ea 70 81 db 7e c0
         20 8a 00 13 01 00 00 2e 00 28 00 24 00 1d 00 20 0b f8 19 42 a8
         ac 41 2a 18 d8 bc ec 1a 09 42 bd d6 8e d8 f4 d9 00 78 1f 46 3b
         00 73 b2 53 aa 28 00 2b 00 02 7f 16

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 84 58 91
         35 eb 20 74 54 9e 4f 1d 64 44 58 72 0f 19 4b f3 71 f6 34 bc c1
         ea 70 81 db 7e c0 20 8a 00 13 01 00 00 2e 00 28 00 24 00 1d 00
         20 0b f8 19 42 a8 ac 41 2a 18 d8 bc ec 1a 09 42 bd d6 8e d8 f4
         d9 00 78 1f 46 3b 00 73 b2 53 aa 28 00 2b 00 02 7f 16

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  7e 70 8e fc 98 f1 88 d5 4e 08 b0 2e 1a ef 98 88
         3e e6 00 f4 c8 d6 d0 53 c6 11 d5 09 57 bd 70 41

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  01 54 12 6e d0 f9 e4 eb 3b ae 8d a4 b0 c2
         e9 1c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  bb 9f fc cc 2e ed 6f 1d 1d fd 6a 28

   {server}  send a EncryptedExtensions handshake message

   {server}  send a CertificateRequest handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":





Thomson                   Expires June 8, 2018                 [Page 41]

Internet-Draft               TLS 1.3 Traces                December 2017


      PRK (32 octets):  7e 70 8e fc 98 f1 88 d5 4e 08 b0 2e 1a ef 98 88
         3e e6 00 f4 c8 d6 d0 53 c6 11 d5 09 57 bd 70 41

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  18 c8 ee f9 22 a9 06 3f db dd 27 6f bd b2 30
         32 65 90 1e a2 38 a3 f2 f5 e2 13 03 b2 d6 97 dd 3a

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (512 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0d
         00 00 27 00 00 24 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08
         04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02
         0b 00 01 3b 00 00 01 37 00 01 32 30 82 01 2e 30 81 d5 a0 03 02
         01 02 02 01 07 30 0a 06 08 2a 86 48 ce 3d 04 03 02 30 13 31 11
         30 0f 06 03 55 04 03 13 08 65 63 64 73 61 32 35 36 30 1e 17 0d
         31 36 30 37 33 30 30 31 32 34 30 30 5a 17 0d 32 36 30 37 33 30
         30 31 32 34 30 30 5a 30 13 31 11 30 0f 06 03 55 04 03 13 08 65
         63 64 73 61 32 35 36 30 59 30 13 06 07 2a 86 48 ce 3d 02 01 06
         08 2a 86 48 ce 3d 03 01 07 03 42 00 04 08 d5 30 16 15 75 f4 cf
         e7 f1 54 ee 34 48 18 00 86 00 1e 88 43 1a 79 ee 62 ee 6e 2f 83
         ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4 d2 f5 b5 6d 1f 04 ec e4
         5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d d0 a3 1a 30 18 30 09 06
         03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80
         30 0a 06 08 2a 86 48 ce 3d 04 03 02 03 48 00 30 45 02 21 00 df
         30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4 79 ca 69 3f ee ca 3b 71
         b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62 e2 a4 72 50 d3 20 fe a8
         3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db d1 3f ee 94 6e 51 3e 01
         1d 11 00 00 0f 00 00 4c 04 03 00 48 30 46 02 21 00 98 52 e2 29
         40 0c 12 7f 01 58 3d a9 87 d2 30 3f e0 57 b6 d2 4b 13 23 be 23
         18 fd b4 eb 49 c9 cc 02 21 00 de 46 63 93 b9 b3 32 ae 9c a1 43
         ed 77 bd 46 5d af 01 fd 34 bb 1d 07 56 e3 6e 5c 17 63 af 18 93
         14 00 00 20 46 ba 36 14 ea ab c7 20 95 9c 1f 14 94 a8 05 87 0d
         5b 6d 57 9a f1 2b 59 d1 2b d7 be c2 08 0e d5

      ciphertext (534 octets):  17 03 03 02 11 d2 a0 7e b5 71 b4 10 44
         a2 f8 e2 8d 3a 36 16 61 e7 2f fc 6f 8d 2b f8 2e 48 8a c7 a2 bf
         06 92 3d c6 ae ad 40 b3 7c c4 46 b0 e0 4a 30 d3 ec 14 9f e7 c7
         6e 26 19 09 88 f3 ff 47 be 1e fb 6b 71 43 c2 5b f4 cb 6d 0d 94
         dd 3a f8 e1 c4 d5 ee d4 bc b6 27 ec 59 72 44 0d 11 38 06 85 7f
         38 e5 4a 4f 61 2f a3 d8 b4 84 b1 a1 a7 ce 22 86 01 7a 15 56 59
         69 a1 99 8a de 8a 12 c5 f2 44 00 f6 62 24 de 48 13 bd ad 7a b2



Thomson                   Expires June 8, 2018                 [Page 42]

Internet-Draft               TLS 1.3 Traces                December 2017


         0f 59 7d 6a de f9 82 9b 0c fb 52 d0 b2 86 d3 37 73 e5 84 83 e0
         f2 80 88 94 83 0d c1 3a d9 69 67 1f 08 d1 cf 35 17 88 5c db 57
         c7 7d 1f 78 a1 01 db c8 00 9e 75 5b c7 e2 e2 14 85 e8 df b6 89
         53 f9 4b d0 f0 32 17 d9 3d 42 0e 2b 75 f7 cc b2 a4 f1 fe 46 00
         94 3f 92 d3 ba 21 a5 35 f9 3c e3 e7 c4 e2 25 57 15 2d 8c c2 fe
         ba c0 b2 7d 64 c0 29 2c c3 85 a5 cc 6f 0d 86 ca 68 46 ce 29 f9
         d0 f7 f2 8d da 6a c7 90 ed 7f 59 01 97 b8 bc 37 3a 3e bb db ee
         e9 d7 3c 2f fb a8 b5 8b 12 47 61 7f 5b 7c 26 ef 53 b9 be e0 a0
         34 59 bf 23 44 d0 c1 6d de 3f 95 8c 06 03 18 4e a7 df e6 d2 3c
         df 97 48 43 5a b5 2e 1a 9c ea 7d 9e 1f 48 01 5d 02 da db 93 42
         a3 7d 55 67 c1 46 29 7d 2d 66 97 57 8f fa 6d 3d e2 97 e8 fd d3
         68 13 a6 3a 9f 4f 06 41 d3 10 84 ee d5 d6 d0 0d 3b d3 0b 5d 4a
         bb 99 bb 68 4c d3 94 d0 88 b9 78 94 b4 f5 8e 8b 4a 33 b6 92 8f
         8b 07 ae cc f6 32 fe 79 d9 e3 09 41 6f a9 22 77 98 f8 75 2b 33
         f2 a5 39 e2 de 38 62 a2 20 07 17 f2 97 56 23 33 57 41 13 d9 d0
         3f 1e 59 7b cb ba d7 d6 2d 99 6b df 55 e7 af 55 70 bb c0 ce b6
         eb 60 6e 29 c8 32 91 97 0f 12 66 90 df 23 ac 42 96 8b 15 a1 99
         4d a4 e6 3e c7 68 7e 8f f2 86 5b 2b 2d 37 37 91 ce 6b 75 69 bd
         04 66 3a 97 8b 04 d6 d0 09 62 2c 23 c5 06 69 7f 51

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  89 7f a6 ff 89 41 f9 8c 3e 25 9c 6d d3 fe 8d e5
         ff 7b ce 45 38 a8 10 02 bc 3e 8d ec 02 61 ce 7d

      hash (32 octets):  8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2 00
         7d 0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2
         00 7d 0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07

      output (32 octets):  86 e9 66 31 58 95 4d 5e a7 d5 50 93 68 50 38
         f1 16 12 8c 53 e2 1c e0 9e ab f0 84 ed c3 ab d3 73

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  89 7f a6 ff 89 41 f9 8c 3e 25 9c 6d d3 fe 8d e5
         ff 7b ce 45 38 a8 10 02 bc 3e 8d ec 02 61 ce 7d

      hash (32 octets):  8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2 00
         7d 0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2
         00 7d 0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07





Thomson                   Expires June 8, 2018                 [Page 43]

Internet-Draft               TLS 1.3 Traces                December 2017


      output (32 octets):  ae 30 06 e3 8f 11 bd b7 8c b8 1c 7b a1 8f 08
         28 29 0d 2f 52 fe 70 32 64 73 18 68 83 3f a3 8e ce

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  89 7f a6 ff 89 41 f9 8c 3e 25 9c 6d d3 fe 8d e5
         ff 7b ce 45 38 a8 10 02 bc 3e 8d ec 02 61 ce 7d

      hash (32 octets):  8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2 00
         7d 0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 8b 5f 39 8c ad b2 9f 93 5b 03 8a 6e 5f 14 a2 00 7d
         0c 23 2c 9c 4a ce 3d 4f 56 b8 16 51 49 41 07

      output (32 octets):  08 2e b5 5d 8a 9e 41 88 59 29 d3 50 d7 09 a8
         40 5e d3 dc 37 e9 27 8f 49 2a cc 02 6d 02 3b e8 7f

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  ae 30 06 e3 8f 11 bd b7 8c b8 1c 7b a1 8f 08 28
         29 0d 2f 52 fe 70 32 64 73 18 68 83 3f a3 8e ce

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  5c a7 1d d3 bd 63 9d ca 8c 47 7f 3a 45 33
         78 37

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  d0 20 a2 3b f2 09 50 a8 e8 61 a2 b2

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  59 e6 8d 20 65 5f 53 e6 2c 7e 61 3c 39 4d a2 9b
         77 2b e4 91 78 9b 41 e2 d0 5a 5c 8c 4b a5 9f 48

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  d8 d7 cf 15 f6 c7 37 89 2c 4a 83 80 b6 85
         50 8e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  2b d0 37 02 88 47 ef 2d f2 a2 22 6f

   {client}  extract secret "early":




Thomson                   Expires June 8, 2018                 [Page 44]

Internet-Draft               TLS 1.3 Traces                December 2017


      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  7a 81 6c b9 0c 5e 4f 0a 7e b9 02 21 99 7a e8 75
         3d c9 cc 00 9f 8a 86 f5 d5 7e 72 dd 0a f9 b3 06

      secret (32 octets):  bc 50 91 a4 31 d6 fa ee 12 ce fd c7 be 4a 0a
         9d e7 bd 65 d4 9f c4 87 7c c4 5d 4f f9 2f 7d a6 99

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  7e 70 8e fc 98 f1 88 d5 4e 08 b0 2e 1a ef 98 88
         3e e6 00 f4 c8 d6 d0 53 c6 11 d5 09 57 bd 70 41

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00



Thomson                   Expires June 8, 2018                 [Page 45]

Internet-Draft               TLS 1.3 Traces                December 2017


      key output (16 octets):  01 54 12 6e d0 f9 e4 eb 3b ae 8d a4 b0 c2
         e9 1c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  bb 9f fc cc 2e ed 6f 1d 1d fd 6a 28

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  send a Certificate handshake message

   {client}  send a CertificateVerify handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  59 e6 8d 20 65 5f 53 e6 2c 7e 61 3c 39 4d a2 9b
         77 2b e4 91 78 9b 41 e2 d0 5a 5c 8c 4b a5 9f 48

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  18 83 2b ef 5b 8f f6 96 50 11 92 17 a8 d5 72
         0f 43 08 8f c8 a4 e7 f4 f7 09 55 bf 17 3c 9d 8b 7d

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (623 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82 01
         b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86
         f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06 63
         6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39
         5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f 30
         0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06 09



Thomson                   Expires June 8, 2018                 [Page 46]

Internet-Draft               TLS 1.3 Traces                December 2017


         2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81
         00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7 a1
         c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81 e5
         22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f f1
         90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97 1c
         7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7 fe
         9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7 e0
         28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02
         30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a 86
         48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0 22
         af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91 6d
         c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80 be
         2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e f0
         c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2 17
         bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac 0f
         78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00 0f 00 00 84
         08 04 00 80 9e c7 3f 7d bb 61 c4 3b 92 5a 5e 74 a2 26 2b f1 40
         fd 67 a4 db b4 ab 15 e3 01 01 cd d1 af 24 fb 23 bc 84 58 92 a8
         55 a5 04 62 f3 20 a0 1d 41 82 06 25 f3 55 77 7d 45 47 b5 5e 5a
         9f 2b 67 b1 7d e9 ef 27 70 01 e7 ec 2c 47 10 5f cb b5 e2 84 8e
         98 9d 49 d2 e1 73 5e a0 41 35 f2 65 f9 ca 4f 1d 2c 61 6d 29 fd
         83 b7 c8 50 3c 23 fa c3 a9 c7 1b 5f 0d 5a 2f 26 0c a9 c4 53 3e
         41 67 7f 38 db 93 14 00 00 20 97 67 59 7d d4 26 0c 6f 51 37 6d
         62 87 bb ba 43 9a 36 b7 98 df a1 50 0b 8b d0 c8 79 5d ea dd da

      ciphertext (645 octets):  17 03 03 02 80 14 b6 33 b7 38 aa 39 97
         60 71 e1 15 4d 3d 8b 80 09 bb 4a 51 1c 6c a8 5a 5c 37 94 c6 f4
         e9 cd 74 60 0a 19 45 4c cb 1e 82 ad 2f 72 a1 e1 d0 39 98 f4 c5
         45 94 d9 43 83 29 71 78 f4 f9 ef 54 df ea 88 fa 9f 73 3c 19 59
         31 56 0b 50 5c 6b 8a a3 c0 c6 19 58 75 78 f9 de fa fa 42 2a 2a
         e7 e7 20 75 4e aa b4 7a 8d 5b 11 51 50 a0 3d 0f 73 5b 0d 66 83
         4b 7f 34 4e dc bb 55 30 b1 17 bd f9 86 2d 2b 95 3e 60 85 61 16
         da 84 09 5e 6e 58 17 84 23 38 fd 4b fe 35 84 ab 33 ea a9 6e 5c
         78 7d 35 99 21 71 a0 f1 6f f9 27 fd 87 32 fc 49 60 3a 22 20 11
         1f 11 a6 0a 70 51 2d 70 04 37 66 a3 89 7d 93 3d 08 bc 5f f1 70
         f1 e9 a9 08 24 ce 68 f3 c2 18 64 af 8b ab 8e a0 aa 9f a1 b6 59
         c4 b2 f1 7e 9e ce 99 6c b1 16 af 39 2a 5d 7e 7a 82 ca 64 8a 03
         e5 f7 42 af 21 9f 80 89 59 e7 48 62 0d 47 2e 3a e3 8f 5c 42 5f
         04 8a 52 1d 53 c3 f1 27 2e bd d5 ef 37 bc f4 7e 0c ae b8 8b b0
         13 e3 87 c0 df 55 e4 cf 42 0b 0a 86 03 ae 3a d8 c8 5c 55 ef a1
         f8 e0 d6 79 4d b9 a7 05 9e c3 8e fe b1 3a f3 f0 ea 77 95 65 7a
         e1 61 96 31 cf 36 99 1d a1 77 57 98 02 b7 db fa 7e 5d d0 e7 e0
         04 1a 0f 92 9e 71 1d 5f 58 16 a9 03 dd 39 67 8b 59 7e 84 98 64
         1a 87 81 44 a8 e0 e9 10 8c 57 07 61 15 5e 62 48 3a 00 51 05 c3
         06 a1 06 46 69 c4 53 91 f4 0a 9d 69 4a 3b cd e6 88 b9 05 3c f7
         da 65 17 2c 8b 2e b0 49 51 7d 05 ac 53 7e 99 77 b7 62 7c 24 a8
         e7 48 74 98 00 05 4f 99 16 e8 6e 2d d6 6b 29 87 f9 f1 32 dc e4
         15 5d 18 cb 69 de 1f 1d 44 c0 15 3e 19 e3 14 9a 7d f5 83 e7 6a



Thomson                   Expires June 8, 2018                 [Page 47]

Internet-Draft               TLS 1.3 Traces                December 2017


         f1 d9 99 72 6b f0 b1 82 cd ec 1b 71 58 65 20 0c 54 8c 93 05 50
         0e 35 2e 6c a0 39 fd 1a 7c 55 fa 16 84 6f 86 4a 14 05 30 61 ce
         a7 a0 a0 ba 02 c8 67 4c 7c 52 8c 70 42 1e e6 01 af d0 24 62 52
         3a d3 ab 70 ef 36 2c 59 b4 cd 42 f9 36 11 d0 23 9b e4 ba 10 1d
         70 d9 e5 f0 f7 da 73 a3 40 17 a5 73 e4 5a 1d e0 ac 95 81 f5 be
         ed 2b c7 50 db 36 40 a5 5f 99 59 2b 54 a3 ea aa af f7 65 8f 26
         42 0b d8 84 e3 8e 44 7e 56 04 53 32 a5 fa 74 94 2d e6 7f 04 7f
         5f 45 e7 c4 9d ec 08 b5 62 56 05 7b f2 b6 54 c3 28 a6 51 e3 c1
         78 dc

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  86 e9 66 31 58 95 4d 5e a7 d5 50 93 68 50 38 f1
         16 12 8c 53 e2 1c e0 9e ab f0 84 ed c3 ab d3 73

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c5 52 a5 ef 99 98 c1 7e 32 ef 9f 13 48 71
         70 7b

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ef 85 0c 83 7e c2 d2 46 dd 93 28 a9

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  89 7f a6 ff 89 41 f9 8c 3e 25 9c 6d d3 fe 8d e5
         ff 7b ce 45 38 a8 10 02 bc 3e 8d ec 02 61 ce 7d

      hash (32 octets):  67 90 d0 6f 3e 29 09 03 83 e3 cc 0b f6 31 47 24
         27 02 1d 1a e6 88 62 85 2f 11 7d 54 d2 cb dc 23

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 67 90 d0 6f 3e 29 09 03 83 e3 cc 0b f6 31 47 24 27
         02 1d 1a e6 88 62 85 2f 11 7d 54 d2 cb dc 23

      output (32 octets):  2a 44 6b 68 de 0b 64 8e d1 2d 05 b9 c5 15 13
         d6 23 86 5b bc ac 5e 5d 8a 51 d2 9b 83 0c 5b ab 6b

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:




Thomson                   Expires June 8, 2018                 [Page 48]

Internet-Draft               TLS 1.3 Traces                December 2017


      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 1b 79 8b 58 17 ee f7 46 8d
         31 65 91 c6 a5 03 fc 81 2b d2

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 90 d9 04 ba 86 1e db ff de
         94 25 be 22 a8 c2 9d 8c 51 92

7.  Compatibility Mode

   This example shows use of the handshake with the client requesting
   that the server use compatibility mode as defined in Appendix D.4 of
   [TLS13].

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  bc 43 b2 de 2f 1f b1 47 d4 4c 15 b2 43
         dc 82 b8 0f 4a a6 24 87 f4 0c a5 51 8b d1 9a 8c 3b dc f7

      public key (32 octets):  b2 fb 2d 3a c7 1d 10 11 8a 13 c0 19 04 86
         74 e3 44 7a 72 0b d0 80 b9 d4 57 89 e8 a1 f7 6b e7 6d

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (218 octets):  01 00 00 d6 03 03 92 fd b8 83 06 62 04 c4
         0f d1 fa f6 46 94 26 9d 10 72 fc 0a 9d 19 60 8e 57 a3 50 fa 20
         a0 77 1f 20 ec e9 a1 24 2a 8c 90 54 63 34 2e 24 6a fe 24 c1 d1
         43 3f 49 e6 ff 5f ed 44 e7 37 31 51 f1 68 87 00 06 13 01 13 03
         13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72
         ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00
         01 01 01 02 01 03 01 04 00 28 00 26 00 24 00 1d 00 20 b2 fb 2d
         3a c7 1d 10 11 8a 13 c0 19 04 86 74 e3 44 7a 72 0b d0 80 b9 d4
         57 89 e8 a1 f7 6b e7 6d 00 2b 00 03 02 7f 16 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

      ciphertext (223 octets):  16 03 01 00 da 01 00 00 d6 03 03 92 fd
         b8 83 06 62 04 c4 0f d1 fa f6 46 94 26 9d 10 72 fc 0a 9d 19 60
         8e 57 a3 50 fa 20 a0 77 1f 20 ec e9 a1 24 2a 8c 90 54 63 34 2e
         24 6a fe 24 c1 d1 43 3f 49 e6 ff 5f ed 44 e7 37 31 51 f1 68 87
         00 06 13 01 13 03 13 02 01 00 00 87 00 00 00 0b 00 09 00 00 06
         73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17



Thomson                   Expires June 8, 2018                 [Page 49]

Internet-Draft               TLS 1.3 Traces                December 2017


         00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 28 00 26 00 24 00
         1d 00 20 b2 fb 2d 3a c7 1d 10 11 8a 13 c0 19 04 86 74 e3 44 7a
         72 0b d0 80 b9 d4 57 89 e8 a1 f7 6b e7 6d 00 2b 00 03 02 7f 16
         00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04
         01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01

   {server}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  02 f9 5f e2 ac 58 8b 04 73 d5 ab 47 a2
         2c ca e9 39 3f 72 11 48 2b d2 31 54 b1 64 63 e4 c3 ed ff

      public key (32 octets):  c3 7d 36 4b 0d e7 a9 12 0f 18 3c 52 b4 f0
         b1 c2 94 7b a8 f8 c4 60 26 a8 8b f3 1f 39 6e 32 e3 1e

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (122 octets):  02 00 00 76 03 03 53 58 34 76 41 46 28 4d
         47 4b 1a b4 a4 32 f5 8a a8 f6 55 95 8c 0e aa 71 5c 8f 41 8f 2f
         d7 3f 20 20 ec e9 a1 24 2a 8c 90 54 63 34 2e 24 6a fe 24 c1 d1
         43 3f 49 e6 ff 5f ed 44 e7 37 31 51 f1 68 87 13 01 00 00 2e 00
         28 00 24 00 1d 00 20 c3 7d 36 4b 0d e7 a9 12 0f 18 3c 52 b4 f0
         b1 c2 94 7b a8 f8 c4 60 26 a8 8b f3 1f 39 6e 32 e3 1e 00 2b 00
         02 7f 16

      ciphertext (127 octets):  16 03 03 00 7a 02 00 00 76 03 03 53 58
         34 76 41 46 28 4d 47 4b 1a b4 a4 32 f5 8a a8 f6 55 95 8c 0e aa
         71 5c 8f 41 8f 2f d7 3f 20 20 ec e9 a1 24 2a 8c 90 54 63 34 2e
         24 6a fe 24 c1 d1 43 3f 49 e6 ff 5f ed 44 e7 37 31 51 f1 68 87
         13 01 00 00 2e 00 28 00 24 00 1d 00 20 c3 7d 36 4b 0d e7 a9 12
         0f 18 3c 52 b4 f0 b1 c2 94 7b a8 f8 c4 60 26 a8 8b f3 1f 39 6e
         32 e3 1e 00 2b 00 02 7f 16

   {server}  send change_cipher_spec record:

      payload (1 octets):  01




Thomson                   Expires June 8, 2018                 [Page 50]

Internet-Draft               TLS 1.3 Traces                December 2017


      ciphertext (6 octets):  14 03 03 00 01 01

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  78 e0 fa c2 c4 7d a5 a8 43 92 1f 00 cf ef eb ff
         0e 68 de ae 8b a1 51 d4 92 44 03 f8 ee 8b 30 3b

      secret (32 octets):  d3 ec 57 f1 88 c1 dd e7 ca 6c 57 66 8e 72 75
         58 95 16 68 b0 b3 01 b5 a8 97 e5 c9 33 b6 f0 5a ba

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  d3 ec 57 f1 88 c1 dd e7 ca 6c 57 66 8e 72 75 58
         95 16 68 b0 b3 01 b5 a8 97 e5 c9 33 b6 f0 5a ba

      hash (32 octets):  b2 c7 f4 ab 3c d8 98 51 74 32 7b 7e e9 af 3e 6d
         51 64 99 2b 29 eb e0 1d 4c f5 4b dc ac 9c 2a 66

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 b2 c7 f4 ab 3c d8 98 51 74 32 7b 7e e9 af 3e
         6d 51 64 99 2b 29 eb e0 1d 4c f5 4b dc ac 9c 2a 66

      output (32 octets):  96 73 8d 17 65 7a f4 14 1c cc fa c6 7c 1f 45
         df 28 a5 33 9b 47 1f fd ff e4 1d a2 a3 9f fc 3b fa

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  d3 ec 57 f1 88 c1 dd e7 ca 6c 57 66 8e 72 75 58
         95 16 68 b0 b3 01 b5 a8 97 e5 c9 33 b6 f0 5a ba




Thomson                   Expires June 8, 2018                 [Page 51]

Internet-Draft               TLS 1.3 Traces                December 2017


      hash (32 octets):  b2 c7 f4 ab 3c d8 98 51 74 32 7b 7e e9 af 3e 6d
         51 64 99 2b 29 eb e0 1d 4c f5 4b dc ac 9c 2a 66

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 b2 c7 f4 ab 3c d8 98 51 74 32 7b 7e e9 af 3e
         6d 51 64 99 2b 29 eb e0 1d 4c f5 4b dc ac 9c 2a 66

      output (32 octets):  18 e2 1c cd 83 a6 1b 67 f7 4c df 13 cd ba 9c
         58 49 0f 70 70 e1 55 ff 92 55 22 b7 d1 7d 04 79 0a

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  d3 ec 57 f1 88 c1 dd e7 ca 6c 57 66 8e 72 75 58
         95 16 68 b0 b3 01 b5 a8 97 e5 c9 33 b6 f0 5a ba

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  3c 13 21 c1 0a a4 47 3f 99 8a dd 29 83 7a 11
         59 05 5f 2e 73 e7 9c d1 c9 6d ce 9f aa 5d fd db e7

   {server}  extract secret "master":

      salt (32 octets):  3c 13 21 c1 0a a4 47 3f 99 8a dd 29 83 7a 11 59
         05 5f 2e 73 e7 9c d1 c9 6d ce 9f aa 5d fd db e7

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  7a 7d 0e 42 3f 40 e7 2f 46 1c 78 7b 4d 9c 93
         8b fe c7 cb 3c 53 03 86 f1 68 22 d1 bf 76 e3 54 d0

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  18 e2 1c cd 83 a6 1b 67 f7 4c df 13 cd ba 9c 58
         49 0f 70 70 e1 55 ff 92 55 22 b7 d1 7d 04 79 0a

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  a2 6e 8f 9c 20 d7 35 22 5e 85 3a 31 47 80
         2b d3

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00




Thomson                   Expires June 8, 2018                 [Page 52]

Internet-Draft               TLS 1.3 Traces                December 2017


      iv output (12 octets):  6d c5 54 6b 53 d4 28 20 ef 2e 75 9c

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  18 e2 1c cd 83 a6 1b 67 f7 4c df 13 cd ba 9c 58
         49 0f 70 70 e1 55 ff 92 55 22 b7 d1 7d 04 79 0a

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  3a da 09 18 d9 dc 61 62 0a a3 40 20 a7 b9 48
         1b d3 bd 38 6d 84 24 27 65 bd 6f 6a 03 8f d3 e7 20

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (651 octets):  08 00 00 1e 00 1c 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 00 00 00 0b
         00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02
         01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36
         30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31
         32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d
         00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b
         36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4
         9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed
         43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d
         44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9
         d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28
         a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09
         06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05
         a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85
         aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a
         7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31
         9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e
         67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e
         b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40
         9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d



Thomson                   Expires June 8, 2018                 [Page 53]

Internet-Draft               TLS 1.3 Traces                December 2017


         e1 00 00 0f 00 00 84 08 04 00 80 03 2b 30 eb 07 92 05 4a 9e 82
         a2 f8 5c 73 02 90 2f ac f8 7f 37 be 76 69 8d c7 fb 4f 57 59 b2
         37 fb c1 4c 7e 22 2a 3f a6 0f 11 62 c7 0e 3a 59 19 3c 42 45 51
         71 d2 02 6a d9 88 cd c4 f7 fd db de d6 4b 9b 1d f1 13 6e fa 89
         f1 3b de 77 4d 9c 48 23 86 b4 f4 67 ac e8 d9 47 85 5c ac 6c 2f
         d4 79 1e 28 1f 1a 63 a1 72 d3 8f 5c cc c6 3e 69 40 a7 17 2d 16
         f2 cf 8d d2 48 a8 fd 06 7b 51 a5 6b 44 14 00 00 20 d0 36 45 43
         fc 0e bb 53 c7 27 78 e5 d0 76 fd e8 7d fa e3 58 5f c9 85 07 6a
         79 c3 a2 89 ab fc b1

      ciphertext (673 octets):  17 03 03 02 9c 03 7f 78 08 63 e4 8c b1
         51 cf 9a 77 9e 20 57 c1 d5 bd 68 aa df 39 95 e8 e5 7a 96 cd a9
         c6 dc 85 bf be e7 4d 85 18 ff f7 64 41 87 0f c0 c2 9f 07 65 ed
         47 cb f9 f2 3c c1 43 c9 34 8e 2f 3f 8b 0d cc 1f 45 91 5a 0b 46
         89 d9 b1 cc 8e 72 9d 7e 3e 74 d2 34 b6 ad 0d 53 67 ba d9 21 e6
         31 34 b1 e8 e1 fb 68 c3 b6 85 9f 87 66 35 ad d1 af 58 ec 97 91
         80 ac 67 33 0b 54 21 b7 02 48 c6 36 3e 65 04 4d 9c ff a7 69 93
         39 05 5a 2f 5f 9c dd 13 a3 08 a1 77 46 4a 61 53 fd bd 1d 4b 83
         1a ba 11 22 6f 86 6e 2c f0 e9 b4 83 38 20 c3 5a f5 39 e0 0a 20
         fb d7 cb 98 1c 78 9d ef 88 02 f1 9c 7b ad 07 df a1 95 d0 2a 94
         e7 c0 48 41 a7 ac 46 18 77 b5 1c 7a 52 ad 0d 6c 90 96 74 12 a6
         1c 30 63 4a ab 6a 3b bc f4 95 f8 38 59 06 8a 24 05 99 3f 22 20
         63 d1 e5 b1 98 9d 2b ea ab 7d e1 55 1b 98 ed 64 a0 60 21 fd 0c
         06 d5 9c ec e9 83 24 39 8b 0b d0 db c4 4e 8f b2 db e9 5b b1 e8
         0f 85 c6 b5 22 77 14 9d 25 c0 13 62 a1 fc 0c b3 ce b5 2e 44 2a
         25 5b e2 10 3a ec ee 7a 53 4e 8a 60 35 f8 32 3f 73 f6 f8 97 15
         a4 ae 1d c6 e5 07 a2 36 b2 fa 91 13 52 47 e1 83 bd 17 d8 fb 16
         45 5d 7b 41 de c0 44 db 92 e3 b1 d9 a5 87 20 10 19 2d 4c c1 d2
         5d 44 d6 08 c4 b3 0c 29 5d 24 40 f2 2a 76 f7 49 35 c5 bd 2b ca
         75 e9 50 ae cc 49 ec d8 bd 16 5e eb ad 47 d3 79 8f 45 70 66 80
         88 1d 0f de 3b 27 ed a4 c1 17 91 6e d2 a6 24 19 19 f3 6b ac 27
         ff 6d ef ca 4e 71 24 cc 42 da 50 a4 76 5e 5b 69 a9 5e 15 e2 90
         16 55 b8 78 56 78 3b e5 64 19 c9 f5 ce a5 a7 5d fb 77 e4 e0 93
         73 48 49 92 34 af 92 23 c0 76 df 84 b4 4c 98 aa 89 1a 68 4d 4d
         44 c6 e7 48 d5 6d 9e 9b 5a c4 c2 85 65 d8 b3 a1 bc ce 77 6f 76
         10 1c 70 a5 c0 b3 b1 47 a3 c3 ae ad 60 a2 6e a6 dc 55 10 01 3f
         61 ba 3c fb f3 1e c7 4c fb d8 93 45 83 3e 2b 99 b9 fb 44 dc 7c
         f5 53 ee fe 40 3f e8 62 a3 c6 77 05 4d 52 1e 6a 66 d9 e6 74 f1
         30 1e 6f 70 a1 95 65 f7 26 2d 2a c5 f7 23 f3 35 97 e5 d8 5d 29
         c1 36 81 87 23 9e 5f 27 85 e5 2f 98 b9 87 c7 c7 58 f1 87 7e 82
         cf fc 90 8b e2 06 d3 ab 20 32 10 93 ea 99 ff 45 72 2c 9b 49 01
         24 75 12 b7 1a e2 98 43 2a d3 d2 b0 87 11 ae c8 1e 3b 67 53 a8
         47 b9 51 72 f9 1c 32 06 2d

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  7a 7d 0e 42 3f 40 e7 2f 46 1c 78 7b 4d 9c 93 8b
         fe c7 cb 3c 53 03 86 f1 68 22 d1 bf 76 e3 54 d0



Thomson                   Expires June 8, 2018                 [Page 54]

Internet-Draft               TLS 1.3 Traces                December 2017


      hash (32 octets):  8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a 61
         e5 74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a
         61 e5 74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      output (32 octets):  1f 0d ac 7f e3 31 7d c6 07 a4 ba 6c 21 04 72
         54 85 9a 2e 57 cc 8a 1a 23 50 b7 a9 e7 09 ce 45 65

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  7a 7d 0e 42 3f 40 e7 2f 46 1c 78 7b 4d 9c 93 8b
         fe c7 cb 3c 53 03 86 f1 68 22 d1 bf 76 e3 54 d0

      hash (32 octets):  8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a 61
         e5 74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a
         61 e5 74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      output (32 octets):  35 10 f1 a1 40 b6 7f 58 f6 bd 58 fb 35 b1 12
         3e 5a 40 70 a4 11 6a 6f c8 8b 22 24 56 02 85 a9 15

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  7a 7d 0e 42 3f 40 e7 2f 46 1c 78 7b 4d 9c 93 8b
         fe c7 cb 3c 53 03 86 f1 68 22 d1 bf 76 e3 54 d0

      hash (32 octets):  8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a 61
         e5 74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 8c c8 18 cd 8d 79 e5 b3 4d 73 8f 29 7a c7 1a 61 e5
         74 bf 2b 8a c4 71 3d 78 36 fd 4b cf b4 bb d0

      output (32 octets):  a1 db fc 7a 50 8a cf a1 d8 1d 1a a7 44 b0 49
         67 10 8e af 69 03 97 39 00 89 20 98 c2 e4 1e b8 62

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  35 10 f1 a1 40 b6 7f 58 f6 bd 58 fb 35 b1 12 3e
         5a 40 70 a4 11 6a 6f c8 8b 22 24 56 02 85 a9 15

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00





Thomson                   Expires June 8, 2018                 [Page 55]

Internet-Draft               TLS 1.3 Traces                December 2017


      key output (16 octets):  fa 10 b3 ac 68 f8 1a 4c 12 72 77 87 97 b4
         d0 0a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  19 ec e3 9b c4 15 d0 4c 6b e6 e0 8e

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  96 73 8d 17 65 7a f4 14 1c cc fa c6 7c 1f 45 df
         28 a5 33 9b 47 1f fd ff e4 1d a2 a3 9f fc 3b fa

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b2 99 ab d2 e1 72 d3 5a 14 e9 b8 03 6c 2a
         47 32

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  17 7a 0e ef 91 71 3c aa 68 39 27 20

   {client}  extract secret "early":

      salt:  (absent)

      ikm (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":




Thomson                   Expires June 8, 2018                 [Page 56]

Internet-Draft               TLS 1.3 Traces                December 2017


      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      ikm (32 octets):  78 e0 fa c2 c4 7d a5 a8 43 92 1f 00 cf ef eb ff
         0e 68 de ae 8b a1 51 d4 92 44 03 f8 ee 8b 30 3b

      secret (32 octets):  d3 ec 57 f1 88 c1 dd e7 ca 6c 57 66 8e 72 75
         58 95 16 68 b0 b3 01 b5 a8 97 e5 c9 33 b6 f0 5a ba

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  18 e2 1c cd 83 a6 1b 67 f7 4c df 13 cd ba 9c 58
         49 0f 70 70 e1 55 ff 92 55 22 b7 d1 7d 04 79 0a

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  a2 6e 8f 9c 20 d7 35 22 5e 85 3a 31 47 80
         2b d3

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  6d c5 54 6b 53 d4 28 20 ef 2e 75 9c

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)




Thomson                   Expires June 8, 2018                 [Page 57]

Internet-Draft               TLS 1.3 Traces                December 2017


   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  96 73 8d 17 65 7a f4 14 1c cc fa c6 7c 1f 45 df
         28 a5 33 9b 47 1f fd ff e4 1d a2 a3 9f fc 3b fa

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  5d a0 ea 7d 00 11 ce 98 9b 49 34 49 de a0 c7
         11 e6 6b 94 99 db fc fb 07 0c 6d c1 54 aa 4b cf b5

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 d2 45 d6 c1 0a 00 04 ed c1 b5 d1
         b9 22 4a f0 00 9f 0f 52 8b d6 f7 8d aa b1 98 c1 cb d8 cf 96 e8

      ciphertext (58 octets):  17 03 03 00 35 34 54 10 b5 6f 22 4c 8d 13
         63 d7 ad be fa 52 50 35 f1 a9 08 2c ce af 4b a6 1b 4d 8f 54 a4
         56 3b ad 6f d2 ab 1a 9a 1d e9 00 37 73 1a b8 04 5b 48 c3 14 0e
         fa 14

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  1f 0d ac 7f e3 31 7d c6 07 a4 ba 6c 21 04 72 54
         85 9a 2e 57 cc 8a 1a 23 50 b7 a9 e7 09 ce 45 65

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  3a f5 9f 45 77 90 91 c0 c0 52 aa f2 39 13
         67 05

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ab f6 26 85 5f 1f e3 dc d3 8b ef 03

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  7a 7d 0e 42 3f 40 e7 2f 46 1c 78 7b 4d 9c 93 8b
         fe c7 cb 3c 53 03 86 f1 68 22 d1 bf 76 e3 54 d0





Thomson                   Expires June 8, 2018                 [Page 58]

Internet-Draft               TLS 1.3 Traces                December 2017


      hash (32 octets):  53 da 56 25 3b d3 4b 5b 73 54 9e a7 73 5a a5 ad
         e0 2d 1e da 42 04 ae 91 13 64 92 6e d7 94 76 87

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 53 da 56 25 3b d3 4b 5b 73 54 9e a7 73 5a a5 ad e0
         2d 1e da 42 04 ae 91 13 64 92 6e d7 94 76 87

      output (32 octets):  cd e0 72 b1 a7 a2 e2 39 9f e6 a1 1d 8d 94 de
         f7 c2 3d 38 8f f2 7e 76 b5 7f d6 75 75 28 40 0c ab

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 cc 87 6b 91 83 24 20 10 4b
         4c e7 f0 00 66 8b 27 84 51 b3

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 69 ea 6a 48 d5 06 b6 32 03
         17 7b d1 08 15 1b 9b f9 f9 50

8.  Security Considerations

   It probably isn't a good idea to use the private key here.  If it
   weren't for the fact that it is too small to provide any meaningful
   security, it is now very well known.

9.  References

9.1.  Normative References

   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-21 (work in progress),
              July 2017.







Thomson                   Expires June 8, 2018                 [Page 59]

Internet-Draft               TLS 1.3 Traces                December 2017


9.2.  Informative References

   [FIPS186]  National Institute of Standards and Technology (NIST),
              "Digital Signature Standard (DSS)", NIST PUB 186-4 , July
              2013.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

9.3.  URIs

   [1] https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS

Appendix A.  Acknowledgements

   This draft is generated using tests that were written for NSS [1].
   None of this would have been possible without Franziskus Kiefer, Eric
   Rescorla and Tim Taubert, who did a lot of the work in NSS.

Author's Address

   Martin Thomson
   Mozilla

   Email: martin.thomson@gmail.com

























Thomson                   Expires June 8, 2018                 [Page 60]
